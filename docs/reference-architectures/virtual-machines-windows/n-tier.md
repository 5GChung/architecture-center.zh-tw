---
title: "執行適用於多層式架構的 Windows VM"
description: "如何在 Azure 上實作多層式架構，請特別注意可用性、安全性、延展性及管理功能安全性。"
author: MikeWasson
ms.date: 11/22/2016
pnp.series.title: Windows VM workloads
pnp.series.next: multi-region-application
pnp.series.prev: multi-vm
ms.openlocfilehash: f3c375f8fccc633d9525a8afbd11c13037265f4a
ms.sourcegitcommit: b0482d49aab0526be386837702e7724c61232c60
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 11/14/2017
---
# <a name="run-windows-vms-for-an-n-tier-application"></a><span data-ttu-id="dbead-103">執行適用於多層式架構應用程式的 Windows VM</span><span class="sxs-lookup"><span data-stu-id="dbead-103">Run Windows VMs for an N-tier application</span></span>

<span data-ttu-id="dbead-104">此參考架構顯示一組經過證實的作法，可用來執行適用於多層式架構應用程式的 Windows 虛擬機器 (VM)。</span><span class="sxs-lookup"><span data-stu-id="dbead-104">This reference architecture shows a set of proven practices for running Windows virtual machines (VMs) for an N-tier application.</span></span> [<span data-ttu-id="dbead-105">**部署這個解決方案**。</span><span class="sxs-lookup"><span data-stu-id="dbead-105">**Deploy this solution**.</span></span>](#deploy-the-solution) 

<span data-ttu-id="dbead-106">![[0]][0]</span><span class="sxs-lookup"><span data-stu-id="dbead-106">![[0]][0]</span></span>

<span data-ttu-id="dbead-107">下載這個架構的 [Visio 檔案][visio-download]。</span><span class="sxs-lookup"><span data-stu-id="dbead-107">*Download a [Visio file][visio-download] of this architecture.*</span></span>

## <a name="architecture"></a><span data-ttu-id="dbead-108">架構</span><span class="sxs-lookup"><span data-stu-id="dbead-108">Architecture</span></span> 

<span data-ttu-id="dbead-109">有許多方式可實作多層式架構。</span><span class="sxs-lookup"><span data-stu-id="dbead-109">There are many ways to implement an N-tier architecture.</span></span> <span data-ttu-id="dbead-110">下圖顯示典型的 3 層式架構 Web 應用程式。</span><span class="sxs-lookup"><span data-stu-id="dbead-110">The diagram shows a typical 3-tier web application.</span></span> <span data-ttu-id="dbead-111">此架構是根據[執行負載平衡的 VM 以獲得延展性和可用性][multi-vm]建置的。</span><span class="sxs-lookup"><span data-stu-id="dbead-111">This architecture builds on [Run load-balanced VMs for scalability and availability][multi-vm].</span></span> <span data-ttu-id="dbead-112">Web 及 Business 層會使用負載平衡的 VM。</span><span class="sxs-lookup"><span data-stu-id="dbead-112">The web and business tiers use load-balanced VMs.</span></span>

* <span data-ttu-id="dbead-113">**可用性設定組。**</span><span class="sxs-lookup"><span data-stu-id="dbead-113">**Availability sets.**</span></span> <span data-ttu-id="dbead-114">針對每一層建立[可用性設定組][azure-availability-sets]，並且在每一層中至少佈建兩個 VM。</span><span class="sxs-lookup"><span data-stu-id="dbead-114">Create an [availability set][azure-availability-sets] for each tier, and provision at least two VMs in each tier.</span></span> <span data-ttu-id="dbead-115">這讓 VM 能夠符合適用於 VM 之較高[服務等級協定 (SLA)][vm-sla] 的資格。</span><span class="sxs-lookup"><span data-stu-id="dbead-115">This makes the VMs eligible for a higher [service level agreement (SLA)][vm-sla] for VMs.</span></span>
* <span data-ttu-id="dbead-116">**子網路。**</span><span class="sxs-lookup"><span data-stu-id="dbead-116">**Subnets.**</span></span> <span data-ttu-id="dbead-117">針對每一層建立不同的子網路。</span><span class="sxs-lookup"><span data-stu-id="dbead-117">Create a separate subnet for each tier.</span></span> <span data-ttu-id="dbead-118">使用 [CIDR] 標記法來指定位址範圍和子網路遮罩。</span><span class="sxs-lookup"><span data-stu-id="dbead-118">Specify the address range and subnet mask using [CIDR] notation.</span></span> 
* <span data-ttu-id="dbead-119">**負載平衡器。**</span><span class="sxs-lookup"><span data-stu-id="dbead-119">**Load balancers.**</span></span> <span data-ttu-id="dbead-120">使用[網際網路面向的負載平衡器][load-balancer-external]，將連入的網際網路流量散發到 Web 層，並使用[內部負載平衡器][load-balancer-internal]，將來自 Web 層的網路流量散發到 Business 層。</span><span class="sxs-lookup"><span data-stu-id="dbead-120">Use an [Internet-facing load balancer][load-balancer-external] to distribute incoming Internet traffic to the web tier, and an [internal load balancer][load-balancer-internal] to distribute network traffic from the web tier to the business tier.</span></span>
* <span data-ttu-id="dbead-121">**Jumpbox。**</span><span class="sxs-lookup"><span data-stu-id="dbead-121">**Jumpbox.**</span></span> <span data-ttu-id="dbead-122">也稱為[防禦主機]。</span><span class="sxs-lookup"><span data-stu-id="dbead-122">Also called a [bastion host].</span></span> <span data-ttu-id="dbead-123">網路上系統管理員用來連線到其他 VM 的安全 VM。</span><span class="sxs-lookup"><span data-stu-id="dbead-123">A secure VM on the network that administrators use to connect to the other VMs.</span></span> <span data-ttu-id="dbead-124">Jumpbox 具有 NSG，只允許來自安全清單上公用 IP 位址的遠端流量。</span><span class="sxs-lookup"><span data-stu-id="dbead-124">The jumpbox has an NSG that allows remote traffic only from public IP addresses on a safe list.</span></span> <span data-ttu-id="dbead-125">NSG 應該允許遠端桌面 (RDP) 流量。</span><span class="sxs-lookup"><span data-stu-id="dbead-125">The NSG should permit remote desktop (RDP) traffic.</span></span>
* <span data-ttu-id="dbead-126">**監視。**</span><span class="sxs-lookup"><span data-stu-id="dbead-126">**Monitoring.**</span></span> <span data-ttu-id="dbead-127">監視軟體 (例如 [Nagios]、[Zabbix] 或 [Icinga]) 可讓您深入了解回應時間、VM 執行時間，以及系統的整體健康情況。</span><span class="sxs-lookup"><span data-stu-id="dbead-127">Monitoring software such as [Nagios], [Zabbix], or [Icinga] can give you insight into response time, VM uptime, and the overall health of your system.</span></span> <span data-ttu-id="dbead-128">在位於個別管理子網路中的 VM 上安裝監視軟體。</span><span class="sxs-lookup"><span data-stu-id="dbead-128">Install the monitoring software on a VM that's placed in a separate management subnet.</span></span>
* <span data-ttu-id="dbead-129">**NSG。**</span><span class="sxs-lookup"><span data-stu-id="dbead-129">**NSGs.**</span></span> <span data-ttu-id="dbead-130">使用[網路安全性群組][nsg] (NSG) 來限制 VNet 內的網路流量。</span><span class="sxs-lookup"><span data-stu-id="dbead-130">Use [network security groups][nsg] (NSGs) to restrict network traffic within the VNet.</span></span> <span data-ttu-id="dbead-131">例如，在如下所示的 3 層式架構中，資料庫層不接受來自 Web 前端的流量，只接受來自 Business 層和管理子網路的流量。</span><span class="sxs-lookup"><span data-stu-id="dbead-131">For example, in the 3-tier architecture shown here, the database tier does not accept traffic from the web front end, only from the business tier and the management subnet.</span></span>
* <span data-ttu-id="dbead-132">**SQL Server Always On 可用性群組。**</span><span class="sxs-lookup"><span data-stu-id="dbead-132">**SQL Server Always On Availability Group.**</span></span> <span data-ttu-id="dbead-133">藉由啟用複寫和容錯移轉，在資料層提供高可用性。</span><span class="sxs-lookup"><span data-stu-id="dbead-133">Provides high availability at the data tier, by enabling replication and failover.</span></span>
* <span data-ttu-id="dbead-134">**Active Directory Domain Services (AD DS) 伺服器**。</span><span class="sxs-lookup"><span data-stu-id="dbead-134">**Active Directory Domain Services (AD DS) Servers**.</span></span> <span data-ttu-id="dbead-135">在 Windows Server 2016 之前，必須將 SQL Server Always On 可用性群組加入網域。</span><span class="sxs-lookup"><span data-stu-id="dbead-135">Prior to Windows Server 2016, SQL Server Always On Availability Groups must be joined to a domain.</span></span> <span data-ttu-id="dbead-136">這是因為可用性群組相依於 Windows Server 容錯移轉叢集 (WSFC) 技術。</span><span class="sxs-lookup"><span data-stu-id="dbead-136">This is because Availability Groups depend on Windows Server Failover Cluster (WSFC) technology.</span></span> <span data-ttu-id="dbead-137">Windows Server 2016 引進了不需 Active Directory 就可建立容錯移轉叢集的能力，因此，對這個架構而言，AD DS 伺服器並非必要。</span><span class="sxs-lookup"><span data-stu-id="dbead-137">Windows Server 2016 introduces the ability to create a Failover Cluster without Active Directory, in which case the AD DS servers are not required for this architecture.</span></span> <span data-ttu-id="dbead-138">如需詳細資訊，請參閱 [Windows Server 2016 中容錯移轉叢集的新功能][wsfc-whats-new]。</span><span class="sxs-lookup"><span data-stu-id="dbead-138">For more information, see [What's new in Failover Clustering in Windows Server 2016][wsfc-whats-new].</span></span>

## <a name="recommendations"></a><span data-ttu-id="dbead-139">建議</span><span class="sxs-lookup"><span data-stu-id="dbead-139">Recommendations</span></span>

<span data-ttu-id="dbead-140">您的需求可能不同於這裡所述的架構。</span><span class="sxs-lookup"><span data-stu-id="dbead-140">Your requirements might differ from the architecture described here.</span></span> <span data-ttu-id="dbead-141">請使用以下建議作為起點。</span><span class="sxs-lookup"><span data-stu-id="dbead-141">Use these recommendations as a starting point.</span></span> 

### <a name="vnet--subnets"></a><span data-ttu-id="dbead-142">VNet / 子網路</span><span class="sxs-lookup"><span data-stu-id="dbead-142">VNet / Subnets</span></span>

<span data-ttu-id="dbead-143">當您建立 VNet 時，請判斷您在每個子網路中的資源需要多少個 IP 位址。</span><span class="sxs-lookup"><span data-stu-id="dbead-143">When you create the VNet, determine how many IP addresses your resources in each subnet require.</span></span> <span data-ttu-id="dbead-144">使用 [CIDR] 標記法，針對所需的 IP 位址指定子網路遮罩和夠大的 VNet 位址範圍。</span><span class="sxs-lookup"><span data-stu-id="dbead-144">Specify a subnet mask and a VNet address range large enough for the required IP addresses, using [CIDR] notation.</span></span> <span data-ttu-id="dbead-145">使用落在標準[私人 IP 位址區塊][private-ip-space]內的位址空間，其為 10.0.0.0/8、172.16.0.0/12 及 192.168.0.0/16。</span><span class="sxs-lookup"><span data-stu-id="dbead-145">Use an address space that falls within the standard [private IP address blocks][private-ip-space], which are 10.0.0.0/8, 172.16.0.0/12, and 192.168.0.0/16.</span></span>

<span data-ttu-id="dbead-146">選擇不會與您的內部部署網路重疊的位址範圍，以防您稍後需要在 VNet 和您的內部部署網路之間設定閘道。</span><span class="sxs-lookup"><span data-stu-id="dbead-146">Choose an address range that does not overlap with your on-premises network, in case you need to set up a gateway between the VNet and your on-premise network later.</span></span> <span data-ttu-id="dbead-147">一旦建立 VNet 之後，就無法變更位址範圍。</span><span class="sxs-lookup"><span data-stu-id="dbead-147">Once you create the VNet, you can't change the address range.</span></span>

<span data-ttu-id="dbead-148">請記得以功能和安全性需求來設計子網路。</span><span class="sxs-lookup"><span data-stu-id="dbead-148">Design subnets with functionality and security requirements in mind.</span></span> <span data-ttu-id="dbead-149">位於相同層或角色的所有 VM 都應移入相同的子網路，它可以是安全性界限。</span><span class="sxs-lookup"><span data-stu-id="dbead-149">All VMs within the same tier or role should go into the same subnet, which can be a security boundary.</span></span> <span data-ttu-id="dbead-150">如需設計 VNet 和子網路的詳細資訊，請參閱[規劃和設計 Azure 虛擬網路][plan-network]。</span><span class="sxs-lookup"><span data-stu-id="dbead-150">For more information about designing VNets and subnets, see [Plan and design Azure Virtual Networks][plan-network].</span></span>

<span data-ttu-id="dbead-151">針對每個子網路，以 CIDR 標記法來指定子網路的位址空間。</span><span class="sxs-lookup"><span data-stu-id="dbead-151">For each subnet, specify the address space for the subnet in CIDR notation.</span></span> <span data-ttu-id="dbead-152">例如，'10.0.0.0/24' 會建立 256 個 IP 位址範圍。</span><span class="sxs-lookup"><span data-stu-id="dbead-152">For example, '10.0.0.0/24' creates a range of 256 IP addresses.</span></span> <span data-ttu-id="dbead-153">VM 可以使用這其中的 251 個；保留五個。</span><span class="sxs-lookup"><span data-stu-id="dbead-153">VMs can use 251 of these; five are reserved.</span></span> <span data-ttu-id="dbead-154">確定位址範圍不會跨子網路重疊。</span><span class="sxs-lookup"><span data-stu-id="dbead-154">Make sure the address ranges don't overlap across subnets.</span></span> <span data-ttu-id="dbead-155">請參閱[虛擬網路常見問題集][vnet faq]。</span><span class="sxs-lookup"><span data-stu-id="dbead-155">See the [Virtual Network FAQ][vnet faq].</span></span>

### <a name="network-security-groups"></a><span data-ttu-id="dbead-156">網路安全性群組</span><span class="sxs-lookup"><span data-stu-id="dbead-156">Network security groups</span></span>

<span data-ttu-id="dbead-157">使用 NSG 規則來限制各層之間的流量。</span><span class="sxs-lookup"><span data-stu-id="dbead-157">Use NSG rules to restrict traffic between tiers.</span></span> <span data-ttu-id="dbead-158">例如，在如上所示的 3 層式架構中，Web 層不會直接與資料庫層通訊。</span><span class="sxs-lookup"><span data-stu-id="dbead-158">For example, in the 3-tier architecture shown above, the web tier does not communicate directly with the database tier.</span></span> <span data-ttu-id="dbead-159">若要強制執行此動作，資料庫層應該封鎖來自 Web 層子網路的連入流量。</span><span class="sxs-lookup"><span data-stu-id="dbead-159">To enforce this, the database tier should block incoming traffic from the web tier subnet.</span></span>  

1. <span data-ttu-id="dbead-160">建立 NSG，並將它關聯至資料庫層子網路。</span><span class="sxs-lookup"><span data-stu-id="dbead-160">Create an NSG and associate it to the database tier subnet.</span></span>
2. <span data-ttu-id="dbead-161">新增規則以拒絕來自 VNet 的所有輸入流量</span><span class="sxs-lookup"><span data-stu-id="dbead-161">Add a rule that denies all inbound traffic from the VNet.</span></span> <span data-ttu-id="dbead-162">(在規則中使用 `VIRTUAL_NETWORK` 標記)。</span><span class="sxs-lookup"><span data-stu-id="dbead-162">(Use the `VIRTUAL_NETWORK` tag in the rule.)</span></span> 
3. <span data-ttu-id="dbead-163">新增具有較高優先順序的規則，允許來自 Business 層子網路的輸入流量。</span><span class="sxs-lookup"><span data-stu-id="dbead-163">Add a rule with a higher priority that allows inbound traffic from the business tier subnet.</span></span> <span data-ttu-id="dbead-164">此規則會覆寫上一個規則，並讓 Business 層可與資料庫層對話。</span><span class="sxs-lookup"><span data-stu-id="dbead-164">This rule overrides the previous rule, and allows the business tier to talk to the database tier.</span></span>
4. <span data-ttu-id="dbead-165">新增規則，允許來自資料庫層子網路本身的輸入流量。</span><span class="sxs-lookup"><span data-stu-id="dbead-165">Add a rule that allows inbound traffic from within the database tier subnet itself.</span></span> <span data-ttu-id="dbead-166">此規則允許資料庫層中 VM 之間的通訊，是進行資料庫複寫和容錯移轉所需的。</span><span class="sxs-lookup"><span data-stu-id="dbead-166">This rule allows communication between VMs in the database tier, which is needed for database replication and failover.</span></span>
5. <span data-ttu-id="dbead-167">新增規則，允許來自 Jumpbox 子網路的 RDP 流量。</span><span class="sxs-lookup"><span data-stu-id="dbead-167">Add a rule that allows RDP traffic from the jumpbox subnet.</span></span> <span data-ttu-id="dbead-168">此規則讓系統管理員能夠從 Jumpbox 連線到資料庫層。</span><span class="sxs-lookup"><span data-stu-id="dbead-168">This rule lets administrators connect to the database tier from the jumpbox.</span></span>
   
   > [!NOTE]
   > <span data-ttu-id="dbead-169">NSG 的預設規則允許所有來自 VNet 的輸入流量。</span><span class="sxs-lookup"><span data-stu-id="dbead-169">An NSG has default rules that allow any inbound traffic from within the VNet.</span></span> <span data-ttu-id="dbead-170">這些規則無法刪除，但您可藉由建立較高優先順序的規則來覆寫它們。</span><span class="sxs-lookup"><span data-stu-id="dbead-170">These rules can't be deleted, but you can override them by creating higher priority rules.</span></span>
   > 
   > 

### <a name="load-balancers"></a><span data-ttu-id="dbead-171">負載平衡器</span><span class="sxs-lookup"><span data-stu-id="dbead-171">Load balancers</span></span>

<span data-ttu-id="dbead-172">外部負載平衡器會將網際網路流量散發到 Web 層。</span><span class="sxs-lookup"><span data-stu-id="dbead-172">The external load balancer distributes Internet traffic to the web tier.</span></span> <span data-ttu-id="dbead-173">建立此負載平衡器的公用 IP 位址。</span><span class="sxs-lookup"><span data-stu-id="dbead-173">Create a public IP address for this load balancer.</span></span> <span data-ttu-id="dbead-174">請參閱[建立網際網路面向的負載平衡器][lb-external-create]。</span><span class="sxs-lookup"><span data-stu-id="dbead-174">See [Creating an Internet-facing load balancer][lb-external-create].</span></span>

<span data-ttu-id="dbead-175">內部負載平衡器會將網路流量從 Web 層散發到 Business 層。</span><span class="sxs-lookup"><span data-stu-id="dbead-175">The internal load balancer distributes network traffic from the web tier to the business tier.</span></span> <span data-ttu-id="dbead-176">若要為此負載平衡器提供私人 IP 位址，請建立前端 IP 設定，並將它關聯至 Business 層的子網路。</span><span class="sxs-lookup"><span data-stu-id="dbead-176">To give this load balancer a private IP address, create a frontend IP configuration and associate it with the subnet for the business tier.</span></span> <span data-ttu-id="dbead-177">請參閱[開始建立內部負載平衡器][lb-internal-create]。</span><span class="sxs-lookup"><span data-stu-id="dbead-177">See [Get started creating an Internal load balancer][lb-internal-create].</span></span>

### <a name="sql-server-always-on-availability-groups"></a><span data-ttu-id="dbead-178">SQL Server Always On 可用性群組</span><span class="sxs-lookup"><span data-stu-id="dbead-178">SQL Server Always On Availability Groups</span></span>

<span data-ttu-id="dbead-179">我們建議使用 [Always On 可用性群組][sql-alwayson]來獲得 SQL Server 高可用性。</span><span class="sxs-lookup"><span data-stu-id="dbead-179">We recommend [Always On Availability Groups][sql-alwayson] for SQL Server high availability.</span></span> <span data-ttu-id="dbead-180">在 Windows Server 2016 之前，Always On 可用性群組需要一個網域控制站，而且可用性群組中的所有節點都必須位於相同的 AD 網域。</span><span class="sxs-lookup"><span data-stu-id="dbead-180">Prior to Windows Server 2016, Always On Availability Groups require a domain controller, and all nodes in the availability group must be in the same AD domain.</span></span>

<span data-ttu-id="dbead-181">其他各層會透過[可用性群組接聽程式][sql-alwayson-listeners]連線到資料庫。</span><span class="sxs-lookup"><span data-stu-id="dbead-181">Other tiers connect to the database through an [availability group listener][sql-alwayson-listeners].</span></span> <span data-ttu-id="dbead-182">此接聽程式讓 SQL 用戶端能夠在不知道 SQL Server 實體執行個體名稱的情況下連線。</span><span class="sxs-lookup"><span data-stu-id="dbead-182">The listener enables a SQL client to connect without knowing the name of the physical instance of SQL Server.</span></span> <span data-ttu-id="dbead-183">存取資料庫的 VM 必須加入該網域。</span><span class="sxs-lookup"><span data-stu-id="dbead-183">VMs that access the database must be joined to the domain.</span></span> <span data-ttu-id="dbead-184">用戶端 (在此案例中為另一層) 會使用 DNS，將接聽程式的虛擬網路名稱解析為 IP 位址。</span><span class="sxs-lookup"><span data-stu-id="dbead-184">The client (in this case, another tier) uses DNS to resolve the listener's virtual network name into IP addresses.</span></span>

<span data-ttu-id="dbead-185">設定 SQL Server Always On 可用性群組，如下：</span><span class="sxs-lookup"><span data-stu-id="dbead-185">Configure the SQL Server Always On Availability Group as follows:</span></span>

1. <span data-ttu-id="dbead-186">建立 Windows Server 容錯移轉叢集 (WSFC) 叢集、SQL Server Always On 可用性群組，以及主要複本。</span><span class="sxs-lookup"><span data-stu-id="dbead-186">Create a Windows Server Failover Clustering (WSFC) cluster, a SQL Server Always On Availability Group, and a primary replica.</span></span> <span data-ttu-id="dbead-187">如需詳細資訊，請參閱[開始使用 Always On 可用性群組][sql-alwayson-getting-started]。</span><span class="sxs-lookup"><span data-stu-id="dbead-187">For more information, see [Getting Started with Always On Availability Groups][sql-alwayson-getting-started].</span></span> 
2. <span data-ttu-id="dbead-188">建立具有靜態私人 IP 位址的內部負載平衡器。</span><span class="sxs-lookup"><span data-stu-id="dbead-188">Create an internal load balancer with a static private IP address.</span></span>
3. <span data-ttu-id="dbead-189">建立可用性群組接聽程式，並將接聽程式的 DNS 名稱對應到內部負載平衡器的 IP 位址。</span><span class="sxs-lookup"><span data-stu-id="dbead-189">Create an availability group listener, and map the listener's DNS name to the IP address of an internal load balancer.</span></span> 
4. <span data-ttu-id="dbead-190">建立 SQL Server 接聽連接埠的負載平衡器規則 (預設為 TCP 連接埠 1433)。</span><span class="sxs-lookup"><span data-stu-id="dbead-190">Create a load balancer rule for the SQL Server listening port (TCP port 1433 by default).</span></span> <span data-ttu-id="dbead-191">負載平衡器規則必須啟用「浮動 IP」，也稱為「伺服器直接回傳」。</span><span class="sxs-lookup"><span data-stu-id="dbead-191">The load balancer rule must enable *floating IP*, also called Direct Server Return.</span></span> <span data-ttu-id="dbead-192">這樣會導致 VM 直接回覆用戶端，以啟用與主要複本的直接連線。</span><span class="sxs-lookup"><span data-stu-id="dbead-192">This causes the VM to reply directly to the client, which enables a direct connection to the primary replica.</span></span>
  
  > [!NOTE]
  > <span data-ttu-id="dbead-193">啟用浮動 IP 時，前端連接埠號碼必須與負載平衡器規則中的後端連接埠號碼相同。</span><span class="sxs-lookup"><span data-stu-id="dbead-193">When floating IP is enabled, the front-end port number must be the same as the back-end port number in the load balancer rule.</span></span>
  > 
  > 

<span data-ttu-id="dbead-194">當 SQL 用戶端嘗試連線時，負載平衡器會將連線要求路由傳送到主要複本。</span><span class="sxs-lookup"><span data-stu-id="dbead-194">When a SQL client tries to connect, the load balancer routes the connection request to the primary replica.</span></span> <span data-ttu-id="dbead-195">如果已容錯移轉至另一個複本，負載平衡器會自動將後續要求路由傳送到新的主要複本。</span><span class="sxs-lookup"><span data-stu-id="dbead-195">If there is a failover to another replica, the load balancer automatically routes subsequent requests to a new primary replica.</span></span> <span data-ttu-id="dbead-196">如需詳細資訊，請參閱[設定 SQL Server Always On 可用性群組的 ILB 接聽程式][sql-alwayson-ilb]。</span><span class="sxs-lookup"><span data-stu-id="dbead-196">For more information, see [Configure an ILB listener for SQL Server Always On Availability Groups][sql-alwayson-ilb].</span></span>

<span data-ttu-id="dbead-197">在容錯移轉期間，會關閉現有的用戶端連線。</span><span class="sxs-lookup"><span data-stu-id="dbead-197">During a failover, existing client connections are closed.</span></span> <span data-ttu-id="dbead-198">當容錯移轉完成之後，會將新的連線路由傳送到新的主要複本。</span><span class="sxs-lookup"><span data-stu-id="dbead-198">After the failover completes, new connections will be routed to the new primary replica.</span></span>

<span data-ttu-id="dbead-199">如果您應用程式的讀取次數明顯比寫入多很多，您可以將某些唯讀查詢卸載至次要複本。</span><span class="sxs-lookup"><span data-stu-id="dbead-199">If your application makes significantly more reads than writes, you can offload some of the read-only queries to a secondary replica.</span></span> <span data-ttu-id="dbead-200">請參閱[使用接聽程式連接到唯讀次要複本 (唯讀路由)][sql-alwayson-read-only-routing]。</span><span class="sxs-lookup"><span data-stu-id="dbead-200">See [Using a Listener to Connect to a Read-Only Secondary Replica (Read-Only Routing)][sql-alwayson-read-only-routing].</span></span>

<span data-ttu-id="dbead-201">執行可用性群組的[強制手動容錯移轉][sql-alwayson-force-failover]來測試您的部署。</span><span class="sxs-lookup"><span data-stu-id="dbead-201">Test your deployment by [forcing a manual failover][sql-alwayson-force-failover] of the availability group.</span></span>

### <a name="jumpbox"></a><span data-ttu-id="dbead-202">Jumpbox</span><span class="sxs-lookup"><span data-stu-id="dbead-202">Jumpbox</span></span>

<span data-ttu-id="dbead-203">Jumpbox 將具備最低效能需求，因此，請針對 Jumpbox 選取較小的 VM 大小，例如標準 A1。</span><span class="sxs-lookup"><span data-stu-id="dbead-203">The jumpbox will have minimal performance requirements, so select a small VM size for the jumpbox such as Standard A1.</span></span> 

<span data-ttu-id="dbead-204">針對 Jumpbox 建立[公用 IP 位址]。</span><span class="sxs-lookup"><span data-stu-id="dbead-204">Create a [public IP address] for the jumpbox.</span></span> <span data-ttu-id="dbead-205">將 Jumpbox 放置於與其他 VM 相同的 VNet，但在個別的管理子網路中。</span><span class="sxs-lookup"><span data-stu-id="dbead-205">Place the jumpbox in the same VNet as the other VMs, but in a separate management subnet.</span></span>

<span data-ttu-id="dbead-206">不允許從公用網際網路對執行應用程式工作負載的 VM 進行 RDP 存取。</span><span class="sxs-lookup"><span data-stu-id="dbead-206">Do not allow RDP access from the public Internet to the VMs that run the application workload.</span></span> <span data-ttu-id="dbead-207">對這些 VM 所做的所有 RDP 存取都必須改為透過 Jumpbox 進行。</span><span class="sxs-lookup"><span data-stu-id="dbead-207">Instead, all RDP access to these VMs must come through the jumpbox.</span></span> <span data-ttu-id="dbead-208">系統管理員會登入 Jumpbox，然後從 Jumpbox 登入其他 VM。</span><span class="sxs-lookup"><span data-stu-id="dbead-208">An administrator logs into the jumpbox, and then logs into the other VM from the jumpbox.</span></span> <span data-ttu-id="dbead-209">Jumpbox 允許來自網際網路，但只來自已知且安全 IP 位址的 RDP 流量。</span><span class="sxs-lookup"><span data-stu-id="dbead-209">The jumpbox allows RDP traffic from the Internet, but only from known, safe IP addresses.</span></span>

<span data-ttu-id="dbead-210">若要保護 Jumpbox，請建立 NSG 並將它套用到 Jumpbox 子網路。</span><span class="sxs-lookup"><span data-stu-id="dbead-210">To secure the jumpbox, create an NSG and apply it to the jumpbox subnet.</span></span> <span data-ttu-id="dbead-211">新增 NSG 規則，只允許來自一組安全公用 IP 位址的 RDP 連線。</span><span class="sxs-lookup"><span data-stu-id="dbead-211">Add an NSG rule that allows RDP connections only from a safe set of public IP addresses.</span></span> <span data-ttu-id="dbead-212">NSG 可以連接到子網路或 Jumpbox NIC。</span><span class="sxs-lookup"><span data-stu-id="dbead-212">The NSG can be attached either to the subnet or to the jumpbox NIC.</span></span> <span data-ttu-id="dbead-213">在此情況下，我們建議將它連接到 NIC，如此一來，就只允許 RDP 流量到 Jumpbox，即使您將其他 VM 新增至相同的子網路也一樣。</span><span class="sxs-lookup"><span data-stu-id="dbead-213">In this case, we recommend attaching it to the NIC, so RDP traffic is permitted only to the jumpbox, even if you add other VMs to the same subnet.</span></span>

<span data-ttu-id="dbead-214">設定其他子網路的 NSG，允許來自管理子網路的 RDP 流量。</span><span class="sxs-lookup"><span data-stu-id="dbead-214">Configure the NSGs for the other subnets to allow RDP traffic from the management subnet.</span></span>

## <a name="availability-considerations"></a><span data-ttu-id="dbead-215">可用性考量</span><span class="sxs-lookup"><span data-stu-id="dbead-215">Availability considerations</span></span>

<span data-ttu-id="dbead-216">在資料庫層，具有多個 VM 不會自動會轉譯成高度可用的資料庫。</span><span class="sxs-lookup"><span data-stu-id="dbead-216">At the database tier, having multiple VMs does not automatically translate into a highly available database.</span></span> <span data-ttu-id="dbead-217">針對關聯式資料庫，您通常需要使用複寫和容錯移轉來實現高可用性。</span><span class="sxs-lookup"><span data-stu-id="dbead-217">For a relational database, you will typically need to use replication and failover to achieve high availability.</span></span> <span data-ttu-id="dbead-218">針對 SQL Server，我們建議使用 [Always On 可用性群組][sql-alwayson]。</span><span class="sxs-lookup"><span data-stu-id="dbead-218">For SQL Server, we recommend using [Always On Availability Groups][sql-alwayson].</span></span> 

<span data-ttu-id="dbead-219">如果您需要比[適用於 VM 的 Azure SLA][vm-sla] 所提供更高的可用性，請跨兩個區域複寫應用程式並使用 Azure 流量管理員進行容錯移轉。</span><span class="sxs-lookup"><span data-stu-id="dbead-219">If you need higher availability than the [Azure SLA for VMs][vm-sla] provides, replicate the application across two regions and use Azure Traffic Manager for failover.</span></span> <span data-ttu-id="dbead-220">如需詳細資訊，請參閱[在多個區域中執行 Windows VM 以獲得高可用性][multi-dc]。</span><span class="sxs-lookup"><span data-stu-id="dbead-220">For more information, see [Run Windows VMs in multiple regions for high availability][multi-dc].</span></span>   

## <a name="security-considerations"></a><span data-ttu-id="dbead-221">安全性考量</span><span class="sxs-lookup"><span data-stu-id="dbead-221">Security considerations</span></span>

<span data-ttu-id="dbead-222">將機密的待用資料加密，並使用 [Azure Key Vault][azure-key-vault] 來管理資料庫加密金鑰。</span><span class="sxs-lookup"><span data-stu-id="dbead-222">Encrypt sensitive data at rest and use [Azure Key Vault][azure-key-vault] to manage the database encryption keys.</span></span> <span data-ttu-id="dbead-223">Key Vault 可以在硬體安全模組 (HSM) 中儲存加密金鑰。</span><span class="sxs-lookup"><span data-stu-id="dbead-223">Key Vault can store encryption keys in hardware security modules (HSMs).</span></span> <span data-ttu-id="dbead-224">如需詳細資訊，請參閱[為 Azure VM 上的 SQL Server 設定 Azure Key Vault 整合][sql-keyvault]。同時也建議您將應用程式祕密 (例如資料庫連接字串) 儲存於 Key Vault 中。</span><span class="sxs-lookup"><span data-stu-id="dbead-224">For more information, see [Configure Azure Key Vault Integration for SQL Server on Azure VMs][sql-keyvault] It's also recommended to store application secrets, such as database connection strings, in Key Vault.</span></span>

<span data-ttu-id="dbead-225">請考慮新增網路虛擬設備 (NVA)，在網際網路和 Azure 虛擬網路之間建立 DMZ。</span><span class="sxs-lookup"><span data-stu-id="dbead-225">Consider adding a network virtual appliance (NVA) to create a DMZ between the Internet and the Azure virtual network.</span></span> <span data-ttu-id="dbead-226">NVA 是虛擬設備的通稱，可以執行網路相關的工作，例如防火牆、封包檢查、稽核和自訂路由傳送。</span><span class="sxs-lookup"><span data-stu-id="dbead-226">NVA is a generic term for a virtual appliance that can perform network-related tasks, such as firewall, packet inspection, auditing, and custom routing.</span></span> <span data-ttu-id="dbead-227">如需詳細資訊，請參閱[實作 Azure 和網際網路之間的 DMZ][dmz]。</span><span class="sxs-lookup"><span data-stu-id="dbead-227">For more information, see [Implementing a DMZ between Azure and the Internet][dmz].</span></span>

## <a name="scalability-considerations"></a><span data-ttu-id="dbead-228">延展性考量</span><span class="sxs-lookup"><span data-stu-id="dbead-228">Scalability considerations</span></span>

<span data-ttu-id="dbead-229">負載平衡器會將網路流量散發到 Web 和 Business 層。</span><span class="sxs-lookup"><span data-stu-id="dbead-229">The load balancers distribute network traffic to the web and business tiers.</span></span> <span data-ttu-id="dbead-230">藉由新增 VM 執行個體進行水平調整。</span><span class="sxs-lookup"><span data-stu-id="dbead-230">Scale horizontally by adding new VM instances.</span></span> <span data-ttu-id="dbead-231">請注意，您可以根據負載，分別調整 Web 和 Business 層。</span><span class="sxs-lookup"><span data-stu-id="dbead-231">Note that you can scale the web and business tiers independently, based on load.</span></span> <span data-ttu-id="dbead-232">為了降低因需要維護用戶端親和性而造成的可能複雜性，Web 層中的 VM 應該是無狀態的。</span><span class="sxs-lookup"><span data-stu-id="dbead-232">To reduce possible complications caused by the need to maintain client affinity, the VMs in the web tier should be stateless.</span></span> <span data-ttu-id="dbead-233">裝載商務邏輯的 VM 也應該是無狀態的。</span><span class="sxs-lookup"><span data-stu-id="dbead-233">The VMs hosting the business logic should also be stateless.</span></span>

## <a name="manageability-considerations"></a><span data-ttu-id="dbead-234">管理性考量</span><span class="sxs-lookup"><span data-stu-id="dbead-234">Manageability considerations</span></span>

<span data-ttu-id="dbead-235">使用集中式管理工具 (例如 [Azure 自動化][azure-administration]、[Microsoft Operations Management Suite][operations-management-suite]、[Chef][chef] 或 [Puppet][puppet]) 來簡化整個系統的管理。</span><span class="sxs-lookup"><span data-stu-id="dbead-235">Simplify management of the entire system by using centralized administration tools such as [Azure Automation][azure-administration], [Microsoft Operations Management Suite][operations-management-suite], [Chef][chef], or [Puppet][puppet].</span></span> <span data-ttu-id="dbead-236">這些工具可以合併擷取自多個 VM 的診斷和健康情況資訊，以提供系統的整體檢視。</span><span class="sxs-lookup"><span data-stu-id="dbead-236">These tools can consolidate diagnostic and health information captured from multiple VMs to provide an overall view of the system.</span></span>

## <a name="deploy-the-solution"></a><span data-ttu-id="dbead-237">部署解決方案</span><span class="sxs-lookup"><span data-stu-id="dbead-237">Deploy the solution</span></span>

<span data-ttu-id="dbead-238">適用於此架構的部署可在 [GitHub][github-folder] 上取得。</span><span class="sxs-lookup"><span data-stu-id="dbead-238">A deployment for this architecture is available on [GitHub][github-folder].</span></span> <span data-ttu-id="dbead-239">架構會以三個階段來部署。</span><span class="sxs-lookup"><span data-stu-id="dbead-239">The architecture is deployed in three stages.</span></span> <span data-ttu-id="dbead-240">若要部署架構，請依照下列步驟執行：</span><span class="sxs-lookup"><span data-stu-id="dbead-240">To deploy the architecture, follow these steps:</span></span> 

1. <span data-ttu-id="dbead-241">按一下以下的按鈕，開始部署的第一個階段：</span><span class="sxs-lookup"><span data-stu-id="dbead-241">Click the button below to begin the first stage of deployment:</span></span><br><a href="https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmspnp%2Freference-architectures%2Fmaster%2Fvirtual-machines%2Fn-tier-windows%2FvirtualNetwork.azuredeploy.json" target="_blank"><img src="http://azuredeploy.net/deploybutton.png"/></a>
2. <span data-ttu-id="dbead-242">在 Azure 入口網站中開啟連結之後，輸入下列值：</span><span class="sxs-lookup"><span data-stu-id="dbead-242">Once the link has opened in the Azure portal, enter the follow values:</span></span> 
   * <span data-ttu-id="dbead-243">**資源群組**名稱已在參數檔案中定義，因此請在文字方塊中選取 [新建] 並輸入 `ra-ntier-sql-network-rg`。</span><span class="sxs-lookup"><span data-stu-id="dbead-243">The **Resource group** name is already defined in the parameter file, so select **Create New** and enter `ra-ntier-sql-network-rg` in the text box.</span></span>
   * <span data-ttu-id="dbead-244">從 [位置] 下拉式方塊選取區域。</span><span class="sxs-lookup"><span data-stu-id="dbead-244">Select the region from the **Location** drop down box.</span></span>
   * <span data-ttu-id="dbead-245">請勿編輯 [範本的根 URI] 或 [參數根 URI] 文字方塊。</span><span class="sxs-lookup"><span data-stu-id="dbead-245">Do not edit the **Template Root Uri** or the **Parameter Root Uri** text boxes.</span></span>
   * <span data-ttu-id="dbead-246">檢閱條款和條件，然後按一下 [我同意上方所述的條款及條件] 核取方塊。</span><span class="sxs-lookup"><span data-stu-id="dbead-246">Review the terms and conditions, then click the **I agree to the terms and conditions stated above** checkbox.</span></span>
   * <span data-ttu-id="dbead-247">按一下 [購買] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="dbead-247">Click on the **Purchase** button.</span></span>
3. <span data-ttu-id="dbead-248">檢查 Azure 入口網站通知，以取得部署的第一個階段已完成的訊息。</span><span class="sxs-lookup"><span data-stu-id="dbead-248">Check Azure portal notification for a message that the first stage of the deployment is complete.</span></span>
4. <span data-ttu-id="dbead-249">按一下以下的按鈕，開始部署的第二個階段：</span><span class="sxs-lookup"><span data-stu-id="dbead-249">Click the button below to begin the second stage of the deployment:</span></span><br><a href="https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmspnp%2Freference-architectures%2Fmaster%2Fvirtual-machines%2Fn-tier-windows%2Fworkload.azuredeploy.json" target="_blank"><img src="http://azuredeploy.net/deploybutton.png"/></a>
5. <span data-ttu-id="dbead-250">在 Azure 入口網站中開啟連結之後，輸入下列值：</span><span class="sxs-lookup"><span data-stu-id="dbead-250">Once the link has opened in the Azure portal, enter the follow values:</span></span> 
   * <span data-ttu-id="dbead-251">**資源群組**名稱已在參數檔案中定義，因此請在文字方塊中選取 [新建] 並輸入 `ra-ntier-sql-workload-rg`。</span><span class="sxs-lookup"><span data-stu-id="dbead-251">The **Resource group** name is already defined in the parameter file, so select **Create New** and enter `ra-ntier-sql-workload-rg` in the text box.</span></span>
   * <span data-ttu-id="dbead-252">從 [位置] 下拉式方塊選取區域。</span><span class="sxs-lookup"><span data-stu-id="dbead-252">Select the region from the **Location** drop down box.</span></span>
   * <span data-ttu-id="dbead-253">請勿編輯 [範本的根 URI] 或 [參數根 URI] 文字方塊。</span><span class="sxs-lookup"><span data-stu-id="dbead-253">Do not edit the **Template Root Uri** or the **Parameter Root Uri** text boxes.</span></span>
   * <span data-ttu-id="dbead-254">檢閱條款和條件，然後按一下 [我同意上方所述的條款及條件] 核取方塊。</span><span class="sxs-lookup"><span data-stu-id="dbead-254">Review the terms and conditions, then click the **I agree to the terms and conditions stated above** checkbox.</span></span>
   * <span data-ttu-id="dbead-255">按一下 [購買] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="dbead-255">Click on the **Purchase** button.</span></span>
6. <span data-ttu-id="dbead-256">檢查 Azure 入口網站通知，以取得部署的第二個階段已完成的訊息。</span><span class="sxs-lookup"><span data-stu-id="dbead-256">Check Azure portal notification for a message that the second stage of deployment is complete.</span></span>
7. <span data-ttu-id="dbead-257">按一下以下的按鈕，開始部署的第三個階段：</span><span class="sxs-lookup"><span data-stu-id="dbead-257">Click the button below to begin the third stage of the deployment:</span></span><br><a href="https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmspnp%2Freference-architectures%2Fmaster%2Fvirtual-machines%2Fn-tier-windows%2Fsecurity.azuredeploy.json" target="_blank"><img src="http://azuredeploy.net/deploybutton.png"/></a>
8. <span data-ttu-id="dbead-258">在 Azure 入口網站中開啟連結之後，輸入下列值：</span><span class="sxs-lookup"><span data-stu-id="dbead-258">Once the link has opened in the Azure portal, enter the follow values:</span></span> 
   * <span data-ttu-id="dbead-259">**資源群組**名稱已經定義於參數檔中，因此，請選取 [使用現有的] 並在文字方塊中輸入 `ra-ntier-sql-network-rg`。</span><span class="sxs-lookup"><span data-stu-id="dbead-259">The **Resource group** name is already defined in the parameter file, so select **Use Existing** and enter `ra-ntier-sql-network-rg` in the text box.</span></span>
   * <span data-ttu-id="dbead-260">從 [位置] 下拉式方塊選取區域。</span><span class="sxs-lookup"><span data-stu-id="dbead-260">Select the region from the **Location** drop down box.</span></span>
   * <span data-ttu-id="dbead-261">請勿編輯 [範本的根 URI] 或 [參數根 URI] 文字方塊。</span><span class="sxs-lookup"><span data-stu-id="dbead-261">Do not edit the **Template Root Uri** or the **Parameter Root Uri** text boxes.</span></span>
   * <span data-ttu-id="dbead-262">檢閱條款和條件，然後按一下 [我同意上方所述的條款及條件] 核取方塊。</span><span class="sxs-lookup"><span data-stu-id="dbead-262">Review the terms and conditions, then click the **I agree to the terms and conditions stated above** checkbox.</span></span>
   * <span data-ttu-id="dbead-263">按一下 [購買] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="dbead-263">Click on the **Purchase** button.</span></span>
9. <span data-ttu-id="dbead-264">檢查 Azure 入口網站通知，以取得部署的第三個階段已完成的訊息。</span><span class="sxs-lookup"><span data-stu-id="dbead-264">Check Azure portal notification for a message that the third stage of the deployment is complete.</span></span>
10. <span data-ttu-id="dbead-265">參數檔包含硬式編碼的系統管理員使用者名稱和密碼，強烈建議您立即在所有 VM 上變更這兩者。</span><span class="sxs-lookup"><span data-stu-id="dbead-265">The parameter files include a hard-coded administrator user names and passwords, and it is strongly recommended that you immediately change both on all the VMs.</span></span> <span data-ttu-id="dbead-266">按一下 Azure 入口網站中的每個 VM，然後按一下 [支援與疑難排解] 刀鋒視窗中的 [重設密碼]。</span><span class="sxs-lookup"><span data-stu-id="dbead-266">Click on each VM in the Azure portal then click on **Reset password** in the **Support + troubleshooting** blade.</span></span> <span data-ttu-id="dbead-267">選取 [模式] 下拉式清單方塊中的 [重設密碼]，然後選取新的**使用者名稱**和**密碼**。</span><span class="sxs-lookup"><span data-stu-id="dbead-267">Select **Reset password** in the **Mode** dropdown box, then select a new **User name** and **Password**.</span></span> <span data-ttu-id="dbead-268">按一下 [更新] 按鈕，以儲存新的使用者名稱和密碼。</span><span class="sxs-lookup"><span data-stu-id="dbead-268">Click the **Update** button to save the new user name and password.</span></span> 


<!-- links -->
[dmz]: ../dmz/secure-vnet-dmz.md
[multi-dc]: multi-region-application.md
[multi-vm]: multi-vm.md
[n-tier]: n-tier.md

[azure-administration]: /azure/automation/automation-intro
[azure-availability-sets]: /azure/virtual-machines/virtual-machines-windows-manage-availability#configure-each-application-tier-into-separate-availability-sets
[azure-cli]: /azure/virtual-machines-command-line-tools
[azure-key-vault]: https://azure.microsoft.com/services/key-vault
[防禦主機]: https://en.wikipedia.org/wiki/Bastion_host
[cidr]: https://en.wikipedia.org/wiki/Classless_Inter-Domain_Routing
[chef]: https://www.chef.io/solutions/azure/
[github-folder]: https://github.com/mspnp/reference-architectures/tree/master/virtual-machines/n-tier-windows
[lb-external-create]: /azure/load-balancer/load-balancer-get-started-internet-portal
[lb-internal-create]: /azure/load-balancer/load-balancer-get-started-ilb-arm-portal
[load-balancer-external]: /azure/load-balancer/load-balancer-internet-overview
[load-balancer-internal]: /azure/load-balancer/load-balancer-internal-overview
[nsg]: /azure/virtual-network/virtual-networks-nsg
[operations-management-suite]: https://www.microsoft.com/server-cloud/operations-management-suite/overview.aspx
[plan-network]: /azure/virtual-network/virtual-network-vnet-plan-design-arm
[private-ip-space]: https://en.wikipedia.org/wiki/Private_network#Private_IPv4_address_spaces
[公用 IP 位址]: /azure/virtual-network/virtual-network-ip-addresses-overview-arm
[puppet]: https://puppetlabs.com/blog/managing-azure-virtual-machines-puppet
[sql-alwayson]: https://msdn.microsoft.com/library/hh510230.aspx
[sql-alwayson-force-failover]: https://msdn.microsoft.com/library/ff877957.aspx
[sql-alwayson-getting-started]: https://msdn.microsoft.com/library/gg509118.aspx
[sql-alwayson-ilb]: /azure/virtual-machines/windows/sql/virtual-machines-windows-portal-sql-alwayson-int-listener
[sql-alwayson-listeners]: https://msdn.microsoft.com/library/hh213417.aspx
[sql-alwayson-read-only-routing]: https://technet.microsoft.com/library/hh213417.aspx#ConnectToSecondary
[sql-keyvault]: /azure/virtual-machines/virtual-machines-windows-ps-sql-keyvault
[vm-sla]: https://azure.microsoft.com/support/legal/sla/virtual-machines
[vnet faq]: /azure/virtual-network/virtual-networks-faq
[wsfc-whats-new]: https://technet.microsoft.com/windows-server-docs/failover-clustering/whats-new-in-failover-clustering
[Nagios]: https://www.nagios.org/
[Zabbix]: http://www.zabbix.com/
[Icinga]: http://www.icinga.org/
[visio-download]: https://archcenter.azureedge.net/cdn/vm-reference-architectures.vsdx
[0]: ./images/n-tier-diagram.png "使用 Microsoft Azure 的多層式架構"
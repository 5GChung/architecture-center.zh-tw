---
title: "在 Azure 中執行高可用性的 SharePoint Server 2016 伺服器陣列"
description: "在 Azure 上設定高可用性 SharePoint Server 2016 伺服器陣列的作法已經過驗證。"
author: njray
ms.date: 08/01/2017
ms.openlocfilehash: 0c0e9a7b2ae12a2d12919548f91304e6cbd2d8a6
ms.sourcegitcommit: 8ab30776e0c4cdc16ca0dcc881960e3108ad3e94
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 12/08/2017
---
# <a name="run-a-high-availability-sharepoint-server-2016-farm-in-azure"></a><span data-ttu-id="7b2ae-103">在 Azure 中執行高可用性的 SharePoint Server 2016 伺服器陣列</span><span class="sxs-lookup"><span data-stu-id="7b2ae-103">Run a high availability SharePoint Server 2016 farm in Azure</span></span>

<span data-ttu-id="7b2ae-104">此參考架構會示範一組經過驗證的作法，也就是使用 MinRole 拓樸和 SQL Server Always On 可用性群組，在 Azure 上設定高可用性的 SharePoint Server 2016 的伺服器陣列。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-104">This reference architecture shows a set of proven practices for setting up a high availability SharePoint Server 2016 farm on Azure, using MinRole topology and SQL Server Always On availability groups.</span></span> <span data-ttu-id="7b2ae-105">SharePoint 伺服器陣列會部署在受保護且沒有網際網路對應端點或空間的虛擬網路。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-105">The SharePoint farm is deployed in a secured virtual network with no Internet-facing endpoint or presence.</span></span> [<span data-ttu-id="7b2ae-106">**部署這個解決方案**。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-106">**Deploy this solution**.</span></span>](#deploy-the-solution) 

![](./images/sharepoint-ha.png)

<span data-ttu-id="7b2ae-107">下載這個架構的 [Visio 檔案][visio-download]。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-107">*Download a [Visio file][visio-download] of this architecture.*</span></span>

## <a name="architecture"></a><span data-ttu-id="7b2ae-108">架構</span><span class="sxs-lookup"><span data-stu-id="7b2ae-108">Architecture</span></span>

<span data-ttu-id="7b2ae-109">此架構是根據[執行適用於多層式架構應用程式的 Windows 虛擬機器][windows-n-tier]建置的。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-109">This architecture builds on the one shown in [Run Windows VMs for an N-tier application][windows-n-tier].</span></span> <span data-ttu-id="7b2ae-110">它會將具有高可用性的 SharePoint Server 2016 伺服器陣列部署在 Azure 虛擬網路 (VNet) 中。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-110">It deploys a SharePoint Server 2016 farm with high availability inside an Azure virtual network (VNet).</span></span> <span data-ttu-id="7b2ae-111">此架構適用於測試或生產環境，以及搭配 Office 365 的 SharePoint 混合式基礎結構，或是當做災害復原案例的基礎。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-111">This architecture is suitable for a test or production environment, a SharePoint hybrid infrastructure with Office 365, or as the basis for a disaster recovery scenario.</span></span>

<span data-ttu-id="7b2ae-112">此架構由下列元件組成：</span><span class="sxs-lookup"><span data-stu-id="7b2ae-112">The architecture consists of the following components:</span></span>

- <span data-ttu-id="7b2ae-113">**資源群組**。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-113">**Resource groups**.</span></span> <span data-ttu-id="7b2ae-114">[資源群組][resource-group]是保存 Azure 相關資源的容器。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-114">A [resource group][resource-group] is a container that holds related Azure resources.</span></span> <span data-ttu-id="7b2ae-115">一個資源群組會用於 SharePoint 伺服器，而另一個資源群組會用於虛擬網路和負載平衡器等不依附虛擬機器的基礎結構元件。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-115">One resource group is used for the SharePoint servers, and another resource group is used for infrastructure components that are independent of VMs, such as the virtual network and load balancers.</span></span>

- <span data-ttu-id="7b2ae-116">**虛擬網路 (VNet)**。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-116">**Virtual network (VNet)**.</span></span> <span data-ttu-id="7b2ae-117">虛擬機器會部署在具有唯一內部網路位址空間的 VNet 中。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-117">The VMs are deployed in a VNet with a unique intranet address space.</span></span> <span data-ttu-id="7b2ae-118">VNet 會再細分為子網路。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-118">The VNet is further subdivided into subnets.</span></span> 

- <span data-ttu-id="7b2ae-119">**虛擬機器 (VM)**。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-119">**Virtual machines (VMs)**.</span></span> <span data-ttu-id="7b2ae-120">虛擬機器會部署至 VNet，而所有虛擬機器都會有指派的私人靜態 IP 位址。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-120">The VMs are deployed into the VNet, and private static IP addresses are assigned to all of the VMs.</span></span> <span data-ttu-id="7b2ae-121">靜態 IP 位址建議用於執行 SQL Server 和 SharePoint Server 2016 的虛擬機器，以避免在重新啟動後發生 IP 位址快取問題和位址變更的情形。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-121">Static IP addresses are recommended for the VMs running SQL Server and SharePoint Server 2016, to avoid issues with IP address caching and changes of addresses after a restart.</span></span>

- <span data-ttu-id="7b2ae-122">**可用性集合**。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-122">**Availability sets**.</span></span> <span data-ttu-id="7b2ae-123">將每個 SharePoint 角色的虛擬機器放在個別的[可用性集合][availability-set]中，然後為每個角色佈建至少兩部虛擬機器 (VM)。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-123">Place the VMs for each SharePoint role into separate [availability sets][availability-set], and provision at least two virtual machines (VMs) for each role.</span></span> <span data-ttu-id="7b2ae-124">這讓虛擬機器能夠符合較高服務等級協定 (SLA) 的資格。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-124">This makes the VMs eligible for a higher service level agreement (SLA).</span></span> 

- <span data-ttu-id="7b2ae-125">**內部負載平衡器**。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-125">**Internal load balancer**.</span></span> <span data-ttu-id="7b2ae-126">[負載平衡器][load-balancer]會將 SharePoint 要求流量從內部部署網路散發至 SharePoint 伺服器陣列的前端 Web 伺服器。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-126">The [load balancer][load-balancer] distributes SharePoint request traffic from the on-premises network to the front-end web servers of the SharePoint farm.</span></span> 

- <span data-ttu-id="7b2ae-127">**網路安全性群組 (NSG)**。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-127">**Network security groups (NSGs)**.</span></span> <span data-ttu-id="7b2ae-128">系統會為包含虛擬機器的每個子網路，建立[網路安全性群組][nsg]。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-128">For each subnet that contains virtual machines, a [network security group][nsg] is created.</span></span> <span data-ttu-id="7b2ae-129">使用 NSG 來限制 VNet 內的網路流量，以區隔子網路。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-129">Use NSGs to restrict network traffic within the VNet, in order to isolate subnets.</span></span> 

- <span data-ttu-id="7b2ae-130">**閘道**。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-130">**Gateway**.</span></span> <span data-ttu-id="7b2ae-131">閘道會提供內部部署網路與 Azure 虛擬網路之間的連線。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-131">The gateway provides a connection between your on-premises network and the Azure virtual network.</span></span> <span data-ttu-id="7b2ae-132">您的連線可以使用 ExpressRoute 或站對站 VPN。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-132">Your connection can use ExpressRoute or site-to-site VPN.</span></span> <span data-ttu-id="7b2ae-133">如需詳細資訊，請參閱[將內部部署網路連線至 Azure][hybrid-ra]。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-133">For more information, see [Connect an on-premises network to Azure][hybrid-ra].</span></span>

- <span data-ttu-id="7b2ae-134">**Windows Server Active Directory (AD) 網域控制站**。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-134">**Windows Server Active Directory (AD) domain controllers**.</span></span> <span data-ttu-id="7b2ae-135">由於 SharePoint Server 2016 不支援使用 Azure Active Directory Domain Services，因此您必須部署 Windows Server AD 網域控制站。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-135">Because SharePoint Server 2016 does not support using Azure Active Directory Domain Services, you must deploy Windows Server AD domain controllers.</span></span> <span data-ttu-id="7b2ae-136">這些網域控制站會在 Azure VNet 中執行，並與內部部署 Windows Server AD 樹系之間有信任關係。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-136">These domain controllers run in the Azure VNet and have a trust relationship with the on-premises Windows Server AD forest.</span></span> <span data-ttu-id="7b2ae-137">SharePoint 伺服器陣列資源的用戶端 Web 要求會在 VNet 中進行驗證 ，而不是透過內部部署網路的閘道連線傳送該驗證流量。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-137">Client web requests for SharePoint farm resources are authenticated in the VNet rather than sending that authentication traffic across the gateway connection to the on-premises network.</span></span> <span data-ttu-id="7b2ae-138">DNS 中會建立內部網路 A 或 CNAME 記錄，讓內部網路使用者可以將 SharePoint 伺服器陣列的名稱解析為內部負載平衡器的私用 IP 位址。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-138">In DNS, intranet A or CNAME records are created so that intranet users can resolve the name of the SharePoint farm to the private IP address of the internal load balancer.</span></span>

- <span data-ttu-id="7b2ae-139">**SQL Server Always On 可用性群組**。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-139">**SQL Server Always On Availability Group**.</span></span> <span data-ttu-id="7b2ae-140">若要取得 SQL Server 資料庫的高可用性使用，我們建議您使用 [可用性群組][sql-always-on]。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-140">For high availability of the SQL Server database, we recommend [SQL Server Always On Availability Groups][sql-always-on].</span></span> <span data-ttu-id="7b2ae-141">用於 SQL Server 的虛擬機器有兩個。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-141">Two virtual machines are used for SQL Server.</span></span> <span data-ttu-id="7b2ae-142">一個包含主要資料庫複本，另一個包含次要複本。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-142">One contains the primary database replica and the other contains the secondary replica.</span></span> 

- <span data-ttu-id="7b2ae-143">**多數節點 VM**。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-143">**Majority node VM**.</span></span> <span data-ttu-id="7b2ae-144">此虛擬機器可讓您為容錯移轉叢集建立仲裁。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-144">This VM allows the failover cluster to establish quorum.</span></span> <span data-ttu-id="7b2ae-145">如需詳細資訊，請參閱[了解容錯移轉叢集中的仲裁設定][sql-quorum]。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-145">For more information, see [Understanding Quorum Configurations in a Failover Cluster][sql-quorum].</span></span>

- <span data-ttu-id="7b2ae-146">**SharePoint 伺服器**。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-146">**SharePoint servers**.</span></span> <span data-ttu-id="7b2ae-147">SharePoint 伺服器會執行 Web 前端、快取、應用程式和搜尋角色。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-147">The SharePoint servers perform the web front-end, caching, application, and search roles.</span></span> 

- <span data-ttu-id="7b2ae-148">**Jumpbox**。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-148">**Jumpbox**.</span></span> <span data-ttu-id="7b2ae-149">也稱為[防禦主機][bastion-host]。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-149">Also called a [bastion host][bastion-host].</span></span> <span data-ttu-id="7b2ae-150">這是網路上系統管理員用來連線到其他 VM 的安全 VM。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-150">This is a secure VM on the network that administrators use to connect to the other VMs.</span></span> <span data-ttu-id="7b2ae-151">Jumpbox 具有 NSG，只允許來自安全清單上公用 IP 位址的遠端流量。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-151">The jumpbox has an NSG that allows remote traffic only from public IP addresses on a safe list.</span></span> <span data-ttu-id="7b2ae-152">NSG 應該允許遠端桌面 (RDP) 流量。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-152">The NSG should permit remote desktop (RDP) traffic.</span></span>

## <a name="recommendations"></a><span data-ttu-id="7b2ae-153">建議</span><span class="sxs-lookup"><span data-stu-id="7b2ae-153">Recommendations</span></span>

<span data-ttu-id="7b2ae-154">您的需求可能和此處所述的架構不同。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-154">Your requirements might differ from the architecture described here.</span></span> <span data-ttu-id="7b2ae-155">請使用以下建議作為起點。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-155">Use these recommendations as a starting point.</span></span>

### <a name="resource-group-recommendations"></a><span data-ttu-id="7b2ae-156">資源群組建議</span><span class="sxs-lookup"><span data-stu-id="7b2ae-156">Resource group recommendations</span></span>

<span data-ttu-id="7b2ae-157">我們建議您根據伺服器角色來區隔資源群組，並且具有屬於基礎結構元件 (全域資源) 的個別資源群組。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-157">We recommend separating resource groups according to the server role, and having a separate resource group for infrastructure components that are global resources.</span></span> <span data-ttu-id="7b2ae-158">在此架構中，SharePoint 資源會組成一個群組，而 SQL Server 和其他公用程式資產會組成另一個群組。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-158">In this architecture, the SharePoint resources form one group, while the SQL Server and other utility assets form another.</span></span>

### <a name="virtual-network-and-subnet-recommendations"></a><span data-ttu-id="7b2ae-159">虛擬網路和子網路建議</span><span class="sxs-lookup"><span data-stu-id="7b2ae-159">Virtual network and subnet recommendations</span></span>

<span data-ttu-id="7b2ae-160">針對每個 SharePoint 角色使用一個子網路，另有一個屬於閘道的子網路，和另一個用於 jumpbox 的子網路。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-160">Use one subnet for each SharePoint role, plus a subnet for the gateway and one for the jumpbox.</span></span> 

<span data-ttu-id="7b2ae-161">閘道子網路必須命名為 *GatewaySubnet*。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-161">The gateway subnet must be named *GatewaySubnet*.</span></span> <span data-ttu-id="7b2ae-162">從虛擬網路位址空間的最後一個部分，指定閘道子網路位址空間。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-162">Assign the gateway subnet address space from the last part of the virtual network address space.</span></span> <span data-ttu-id="7b2ae-163">如需詳細資訊，請參閱[使用 VPN 閘道將內部部署網路連線至 Azure][hybrid-vpn-ra]。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-163">For more information, see [Connect an on-premises network to Azure using a VPN gateway][hybrid-vpn-ra].</span></span>

### <a name="vm-recommendations"></a><span data-ttu-id="7b2ae-164">VM 建議</span><span class="sxs-lookup"><span data-stu-id="7b2ae-164">VM recommendations</span></span>

<span data-ttu-id="7b2ae-165">以標準 DSv2 虛擬機器大小為基礎，此架構需要最少 38 個核心：</span><span class="sxs-lookup"><span data-stu-id="7b2ae-165">Based on Standard DSv2 virtual machine sizes, this architecture requires a minimum of 38 cores:</span></span>

- <span data-ttu-id="7b2ae-166">Standard_DS3_v2 上 8 個 SharePoint 伺服器 (每部伺服器 4 個核心) = 32 個核心</span><span class="sxs-lookup"><span data-stu-id="7b2ae-166">8 SharePoint servers on Standard_DS3_v2 (4 cores each) = 32 cores</span></span>
- <span data-ttu-id="7b2ae-167">Standard_DS1_v2 上 2 個 Active Directory 網域控制站 (每個控制站 1 個核心) = 2 個核心</span><span class="sxs-lookup"><span data-stu-id="7b2ae-167">2 Active Directory domain controllers on Standard_DS1_v2 (1 core each) = 2 cores</span></span>
- <span data-ttu-id="7b2ae-168">Standard_DS1_v2 上 2 個 SQL Server 虛擬機器 = 2 個核心</span><span class="sxs-lookup"><span data-stu-id="7b2ae-168">2 SQL Server VMs on Standard_DS1_v2 = 2 cores</span></span>
- <span data-ttu-id="7b2ae-169">Standard_DS1_v2 上 1 個多數節點 = 1 個核心</span><span class="sxs-lookup"><span data-stu-id="7b2ae-169">1 majority node on Standard_DS1_v2 = 1 core</span></span>
- <span data-ttu-id="7b2ae-170">Standard_DS1_v2 上 1 個管理伺服器 = 1 個核心</span><span class="sxs-lookup"><span data-stu-id="7b2ae-170">1 management server on Standard_DS1_v2 = 1 core</span></span>

<span data-ttu-id="7b2ae-171">核心總數將取決於您選取的虛擬機器大小。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-171">The total number of cores will depend on the VM sizes that you select.</span></span> <span data-ttu-id="7b2ae-172">如需詳細資訊，請參閱下方的 [SharePoint Server 建議](#sharepoint-server-recommendations)。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-172">For more information, see [SharePoint Server recommendations](#sharepoint-server-recommendations) below.</span></span>

<span data-ttu-id="7b2ae-173">請確定您的 Azure 訂用帳戶具有足夠的虛擬機器核心配額可用於部署，否則部署將會失敗。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-173">Make sure your Azure subscription has enough VM core quota for the deployment, or the deployment will fail.</span></span> <span data-ttu-id="7b2ae-174">請參閱 [Azure 訂用帳戶和服務限制、配額與限制][quotas]。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-174">See [Azure subscription and service limits, quotas, and constraints][quotas].</span></span> 
 
### <a name="nsg-recommendations"></a><span data-ttu-id="7b2ae-175">NSG 建議</span><span class="sxs-lookup"><span data-stu-id="7b2ae-175">NSG recommendations</span></span>

<span data-ttu-id="7b2ae-176">我們建議每個包含虛擬機器的子網路都要有一個 NSG，以啟用子網路隔離。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-176">We recommend having one NSG for each subnet that contains VMs, to enable subnet isolation.</span></span> <span data-ttu-id="7b2ae-177">如果您想要設定子網路隔離，請新增 NSG 規則，此規則會定義每個子網路允許或拒絕的輸入或輸出流量。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-177">If you want to configure subnet isolation, add NSG rules that define the allowed or denied inbound or outbound traffic for each subnet.</span></span> <span data-ttu-id="7b2ae-178">如需詳細資訊，請參閱[使用網路安全性群組來篩選網路流量][virtual-networks-nsg]。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-178">For more information, see [Filter network traffic with network security groups][virtual-networks-nsg].</span></span> 

<span data-ttu-id="7b2ae-179">請勿將 NSG 指派至閘道子網路，否則閘道將會停止運作。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-179">Do not assign an NSG to the gateway subnet, or the gateway will stop functioning.</span></span> 

### <a name="storage-recommendations"></a><span data-ttu-id="7b2ae-180">儲存體建議</span><span class="sxs-lookup"><span data-stu-id="7b2ae-180">Storage recommendations</span></span>

<span data-ttu-id="7b2ae-181">伺服器陣列中的虛擬機器儲存體設定，應符合內部部署適用的最佳做法。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-181">The storage configuration of the VMs in the farm should match the appropriate best practices used for on-premises deployments.</span></span> <span data-ttu-id="7b2ae-182">SharePoint 伺服器應有用於記錄的個別磁碟。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-182">SharePoint servers should have a separate disk for logs.</span></span> <span data-ttu-id="7b2ae-183">裝載搜尋索引角色的 SharePoint 伺服器需要額外的磁碟空間來儲存搜尋索引。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-183">SharePoint servers hosting search index roles require additional disk space for the search index to be stored.</span></span> <span data-ttu-id="7b2ae-184">SQL Server 的標準作法是將資料和記錄分開。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-184">For SQL Server, the standard practice is to separate data and logs.</span></span> <span data-ttu-id="7b2ae-185">為資料庫備份儲存體新增更多磁碟，並針對 [tempdb][tempdb] 使用個別磁碟。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-185">Add more disks for database backup storage, and use a separate disk for [tempdb][tempdb].</span></span>

<span data-ttu-id="7b2ae-186">為擁有最佳可靠性，我們建議您使用 [Azure 受控磁碟][managed-disks]。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-186">For best reliability, we recommend using [Azure Managed Disks][managed-disks].</span></span> <span data-ttu-id="7b2ae-187">受控磁碟可確保可用性設定組內的虛擬機器磁碟是各自獨立的，以避免發生單一失敗點。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-187">Managed disks ensure that the disks for VMs within an availability set are isolated to avoid single points of failure.</span></span> 

> [!NOTE]
> <span data-ttu-id="7b2ae-188">目前，此參考架構的 Resource Manager 範本並未使用受控磁碟。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-188">Currently the Resource Manager template for this reference architecture does not use managed disks.</span></span> <span data-ttu-id="7b2ae-189">我們正計劃更新範本以使用受控磁碟。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-189">We are planning to update the template to use managed disks.</span></span>

<span data-ttu-id="7b2ae-190">針對所有 SharePoint 和 SQL Server 虛擬機器，請使用進階受控磁碟。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-190">Use Premium managed disks for all SharePoint and SQL Server VMs.</span></span> <span data-ttu-id="7b2ae-191">針對多數節點伺服器、網域控制站和管理伺服器，您可以使用標準受控磁碟。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-191">You can use Standard managed disks for the majority node server, the domain controllers, and the management server.</span></span> 

### <a name="sharepoint-server-recommendations"></a><span data-ttu-id="7b2ae-192">SharePoint Server 建議</span><span class="sxs-lookup"><span data-stu-id="7b2ae-192">SharePoint Server recommendations</span></span>

<span data-ttu-id="7b2ae-193">設定 SharePoint 伺服器陣列之前，請確定您的每個服務都有一個 Windows Server Active Directory 帳戶。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-193">Before configuring the SharePoint farm, make sure you have one Windows Server Active Directory service account per service.</span></span> <span data-ttu-id="7b2ae-194">針對此架構，您至少需要下列網域等級的帳戶來隔離每個角色的權限：</span><span class="sxs-lookup"><span data-stu-id="7b2ae-194">For this architecture, you need at a minimum the following domain-level accounts to isolate privilege per role:</span></span>

- <span data-ttu-id="7b2ae-195">SQL Server 服務帳戶</span><span class="sxs-lookup"><span data-stu-id="7b2ae-195">SQL Server Service account</span></span>
- <span data-ttu-id="7b2ae-196">設定使用者帳戶</span><span class="sxs-lookup"><span data-stu-id="7b2ae-196">Setup User account</span></span>
- <span data-ttu-id="7b2ae-197">伺服器陣列帳戶</span><span class="sxs-lookup"><span data-stu-id="7b2ae-197">Server Farm account</span></span>
- <span data-ttu-id="7b2ae-198">搜尋服務帳戶</span><span class="sxs-lookup"><span data-stu-id="7b2ae-198">Search Service account</span></span>
- <span data-ttu-id="7b2ae-199">內容存取帳戶</span><span class="sxs-lookup"><span data-stu-id="7b2ae-199">Content Access account</span></span>
- <span data-ttu-id="7b2ae-200">Web 應用程式集區帳戶</span><span class="sxs-lookup"><span data-stu-id="7b2ae-200">Web App Pool accounts</span></span>
- <span data-ttu-id="7b2ae-201">服務應用程式集區帳戶</span><span class="sxs-lookup"><span data-stu-id="7b2ae-201">Service App Pool accounts</span></span>
- <span data-ttu-id="7b2ae-202">快取進階使用者帳戶</span><span class="sxs-lookup"><span data-stu-id="7b2ae-202">Cache Super User account</span></span>
- <span data-ttu-id="7b2ae-203">快取進階讀者帳戶</span><span class="sxs-lookup"><span data-stu-id="7b2ae-203">Cache Super Reader account</span></span>

<span data-ttu-id="7b2ae-204">對於除了搜尋索引子以外的所有角色，我們建議使用 [Standard_DS3_v2][vm-sizes-general] 虛擬機器大小。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-204">For all roles except the Search Indexer, we recommended using the [Standard_DS3_v2][vm-sizes-general] VM size.</span></span> <span data-ttu-id="7b2ae-205">搜尋索引子應至少使用 [Standard_DS13_v2][vm-sizes-memory]大小。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-205">The Search Indexer should be at least the [Standard_DS13_v2][vm-sizes-memory] size.</span></span> 

> [!NOTE]
> <span data-ttu-id="7b2ae-206">針對搜尋索引子，此參考架構的 Resource Manager 範本會使用較小的 DS3 大小，以便用於測試和部署。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-206">The Resource Manager template for this reference architecture uses the smaller DS3 size for the Search Indexer, for purposes of testing the deployment.</span></span> <span data-ttu-id="7b2ae-207">對於生產部署，請使用 DS13 或更大的大小。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-207">For a production deployment, use the DS13 size or larger.</span></span> 

<span data-ttu-id="7b2ae-208">對於生產工作負載，請參閱[適用於 SharePoint Server 2016 的硬體和軟體需求][sharepoint-reqs]。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-208">For production workloads, see [Hardware and software requirements for SharePoint Server 2016][sharepoint-reqs].</span></span> 

<span data-ttu-id="7b2ae-209">若要符合磁碟輸送量最低每秒 200 MB 的支援需求，請務必規劃搜尋架構。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-209">To meet the support requirement for disk throughput of 200 MB per second minimum, make sure to plan the Search architecture.</span></span> <span data-ttu-id="7b2ae-210">請參閱[在 SharePoint Server 2013 中的規劃企業搜尋架構][sharepoint-search]。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-210">See [Plan enterprise search architecture in SharePoint Server 2013][sharepoint-search].</span></span> <span data-ttu-id="7b2ae-211">也請遵循[在 SharePoint Server 2016 中進行編目的最佳做法][sharepoint-crawling]。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-211">Also follow the guidelines in [Best practices for crawling in SharePoint Server 2016][sharepoint-crawling].</span></span>

<span data-ttu-id="7b2ae-212">此外，請將搜尋元件資料存放在高效能的個別儲存磁碟區或分割區。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-212">In addition, store the search component data on a separate storage volume or partition with high performance.</span></span> <span data-ttu-id="7b2ae-213">若要減少負載並提高輸送量，請設定此架構所需的物件快取使用者帳戶。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-213">To reduce load and improve throughput, configure the object cache user accounts, which are required in this architecture.</span></span> <span data-ttu-id="7b2ae-214">將 Windows Server 作業系統檔案、SharePoint Server 2016 程式檔和診斷記錄分散在三個一般效能的個別儲存磁碟區或分割區。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-214">Split the Windows Server operating system files, the SharePoint Server 2016 program files, and diagnostics logs across three separate storage volumes or partitions with normal performance.</span></span> 

<span data-ttu-id="7b2ae-215">如需有關這些建議的詳細資訊，請參閱[在 SharePoint Server 2016 中初始部署管理與服務帳戶][sharepoint-accounts]。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-215">For more information about these recommendations, see [Initial deployment administrative and service accounts in SharePoint Server 2016][sharepoint-accounts].</span></span>

### <a name="hybrid-workloads"></a><span data-ttu-id="7b2ae-216">混合式工作負載</span><span class="sxs-lookup"><span data-stu-id="7b2ae-216">Hybrid workloads</span></span>

<span data-ttu-id="7b2ae-217">此參考架構會部署可用來當作 [SharePoint 混合式環境][sharepoint-hybrid] &mdash; 的 SharePoint Server 2016 伺服器陣列，也就是將 SharePoint Server 2016 延伸為 Office 365 SharePoint Online。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-217">This reference architecture deploys a SharePoint Server 2016 farm that can be used as a [SharePoint hybrid environment][sharepoint-hybrid] &mdash; that is, extending SharePoint Server 2016 to Office 365 SharePoint Online.</span></span> <span data-ttu-id="7b2ae-218">如果您有 Office Online Server，請參閱 [Azure 中的 Office Web Apps 和 Office Online Server 支援][office-web-apps]。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-218">If you have Office Online Server, see [Office Web Apps and Office Online Server supportability in Azure][office-web-apps].</span></span>

<span data-ttu-id="7b2ae-219">此部署中的預設服務應用程式是專為支援混合式工作負載所設計。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-219">The default service applications in this deployment are designed to support hybrid workloads.</span></span> <span data-ttu-id="7b2ae-220">所有 SharePoint Server 2016 和 Office 365 混合式工作負載，皆可在不變更 SharePoint 基礎結構的狀況下部署到此伺服器陣列，但有一個例外：雲端混合式搜尋服務應用程式不可部署到裝載現有搜尋拓撲的伺服器。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-220">All SharePoint Server 2016 and Office 365 hybrid workloads can be deployed to this farm without changes to the SharePoint infrastructure, with one exception: The Cloud Hybrid Search Service Application must not be deployed onto servers hosting an existing search topology.</span></span> <span data-ttu-id="7b2ae-221">因此，必須將一個或多個以搜尋角色為基礎的虛擬機器新增至伺服器陣列，以支援此混合式案例。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-221">Therefore, one or more search-role-based VMs must be added to the farm to support this hybrid scenario.</span></span>

### <a name="sql-server-always-on-availability-groups"></a><span data-ttu-id="7b2ae-222">SQL Server Always On 可用性群組</span><span class="sxs-lookup"><span data-stu-id="7b2ae-222">SQL Server Always On Availability Groups</span></span>

<span data-ttu-id="7b2ae-223">此架構會使用 SQL Server 虛擬機器，因為 SharePoint Server 2016 無法使用 Azure SQL Database。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-223">This architecture uses SQL Server virtual machines because SharePoint Server 2016 cannot use Azure SQL Database.</span></span> <span data-ttu-id="7b2ae-224">若要在 SQL Server 中支援高可用性，我們建議您使用 Always On 可用性群組，此可用性群組會指定一組一起進行容錯移轉的資料庫，使其具有高可用性和復原能力。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-224">To support high availability in SQL Server, we recommend using Always On Availability Groups, which specify a set of databases that fail over together, making them highly-available and recoverable.</span></span> <span data-ttu-id="7b2ae-225">在此參考架構中，資料庫會在部署期間建立，但您必須手動啟用 Always On 可用性群組，並將 SharePoint 資料庫新增至可用性群組。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-225">In this reference architecture, the databases are created during deployment, but you must manually enable Always On Availability Groups and add the SharePoint databases to an availability group.</span></span> <span data-ttu-id="7b2ae-226">如需詳細資訊，請參閱[建立可用性群組並新增 SharePoint 資料庫][create-availability-group]。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-226">For more information, see [Create the availability group and add the SharePoint databases][create-availability-group].</span></span>

<span data-ttu-id="7b2ae-227">我們也建議您將接聽程式 IP 位址新增到叢集，這是 SQL Server 虛擬機器內部負載平衡器的私人 IP 位址。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-227">We also recommend adding a listener IP address to the cluster, which is the private IP address of the internal load balancer for the SQL Server virtual machines.</span></span>

<span data-ttu-id="7b2ae-228">如需深入了解建議的 VM 大小和其他在 Azure 中執行的 SQL Server 效能建議，請參閱[Azure 虛擬機器中的 SQL Server 效能最佳做法][sql-performance]。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-228">For recommended VM sizes and other performance recommendations for SQL Server running in Azure, see [Performance best practices for SQL Server in Azure Virtual Machines][sql-performance].</span></span> <span data-ttu-id="7b2ae-229">也請遵循 [SharePoint Server 2016 伺服器陣列中的 SQL Server 最佳作法][sql-sharepoint-best-practices]中的建議。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-229">Also follow the recommendations in [Best practices for SQL Server in a SharePoint Server 2016 farm][sql-sharepoint-best-practices].</span></span>

<span data-ttu-id="7b2ae-230">我們建議您將多數節點伺服器所在的電腦和複寫協力電腦分開。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-230">We recommend that the majority node server reside on a separate computer from the replication partners.</span></span> <span data-ttu-id="7b2ae-231">伺服器會在高安全性模式工作階段中啟用次要的複寫協力電腦伺服器，以辨別是否啟動自動容錯移轉。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-231">The server enables the secondary replication partner server in a high-safety mode session to recognize whether to initiate an automatic failover.</span></span> <span data-ttu-id="7b2ae-232">與兩個協力電腦不同的是，多數節點伺服器的服務目標不是資料庫，而是支援自動容錯移轉。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-232">Unlike the two partners, the majority node server doesn't serve the database but rather supports automatic failover.</span></span> 

## <a name="scalability-considerations"></a><span data-ttu-id="7b2ae-233">延展性考量</span><span class="sxs-lookup"><span data-stu-id="7b2ae-233">Scalability considerations</span></span>

<span data-ttu-id="7b2ae-234">若要相應增加現有伺服器，只需變更虛擬機器大小。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-234">To scale up the existing servers, simply change the VM size.</span></span> 

<span data-ttu-id="7b2ae-235">透過 SharePoint Server 2016 中的 [MinRoles][minroles] 功能，您可以根據伺服器的角色擴充伺服器，也可從角色中移除伺服器。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-235">With the [MinRoles][minroles] capability in SharePoint Server 2016, you can scale out servers based on the server's role and also remove servers from a role.</span></span> <span data-ttu-id="7b2ae-236">當您將伺服器新增至角色上時，您可以指定任何單一角色或合併角色的其中一個。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-236">When you add servers to a role, you can specify any of the single roles or one of the combined roles.</span></span> <span data-ttu-id="7b2ae-237">不過，如果您將伺服器新增至搜尋角色，您也必須使用 PowerShell 重新設定搜尋拓撲。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-237">If you add servers to the Search role, however, you must also reconfigure the search topology using PowerShell.</span></span> <span data-ttu-id="7b2ae-238">您也可以使用 MinRoles 來轉換角色。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-238">You can also convert roles using MinRoles.</span></span> <span data-ttu-id="7b2ae-239">如需詳細資訊，請參閱[在 SharePoint Server 2016 中管理 MinRole 伺服器陣列][sharepoint-minrole]。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-239">For more information, see [Managing a MinRole Server Farm in SharePoint Server 2016][sharepoint-minrole].</span></span>

<span data-ttu-id="7b2ae-240">請注意，SharePoint Server 2016 不支援使用虛擬機器擴展集來進行自動調整。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-240">Note that SharePoint Server 2016 doesn't support using virtual machine scale sets for auto-scaling.</span></span>

## <a name="availability-considerations"></a><span data-ttu-id="7b2ae-241">可用性考量</span><span class="sxs-lookup"><span data-stu-id="7b2ae-241">Availability considerations</span></span>

<span data-ttu-id="7b2ae-242">此參考架構支援 Azure 區域內的高可用性，因為每個角色至少有兩個虛擬機器部署在可用性設定組。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-242">This reference architecture supports high availability within an Azure region, because each role has at least two VMs deployed in an availability set.</span></span>

<span data-ttu-id="7b2ae-243">若要防止受到區域性失敗的影響，請在不同 Azure 區域中建立個別的災害復原伺服器陣列。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-243">To protect against a regional failure, create a separate disaster recovery farm in a different Azure region.</span></span> <span data-ttu-id="7b2ae-244">您的復原時間目標 (RTO) 和復原點目標 (RPO) 會決定安裝需求。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-244">Your recovery time objectives (RTOs) and recovery point objectives (RPOs) will determine the setup requirements.</span></span> <span data-ttu-id="7b2ae-245">如需詳細資訊，請參閱[選擇適用於 SharePoint 2016 的災害復原策略][sharepoint-dr]。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-245">For details, see [Choose a disaster recovery strategy for SharePoint 2016][sharepoint-dr].</span></span> <span data-ttu-id="7b2ae-246">次要區域應與主要區域是*配對的區域*。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-246">The secondary region should be a *paired region* with the primary region.</span></span> <span data-ttu-id="7b2ae-247">若發生廣泛中斷事件，會優先復原所有配對中的一個區域。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-247">In the event of a broad outage, recovery of one region is prioritized out of every pair.</span></span> <span data-ttu-id="7b2ae-248">如需詳細資訊，請參閱[商務持續性和災害復原 (BCDR)：Azure 配對的區域][paired-regions]。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-248">For more information, see [Business continuity and disaster recovery (BCDR): Azure Paired Regions][paired-regions].</span></span>

## <a name="manageability-considerations"></a><span data-ttu-id="7b2ae-249">管理性考量</span><span class="sxs-lookup"><span data-stu-id="7b2ae-249">Manageability considerations</span></span>

<span data-ttu-id="7b2ae-250">若要操作和維護伺服器、伺服器陣列和站台，請遵循 SharePoint 作業的建議作法。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-250">To operate and maintain servers, server farms, and sites, follow the recommended practices for SharePoint operations.</span></span> <span data-ttu-id="7b2ae-251">如需詳細資訊，請參閱 [SharePoint Server 2016 的作業][sharepoint-ops]。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-251">For more information, see [Operations for SharePoint Server 2016][sharepoint-ops].</span></span>

<span data-ttu-id="7b2ae-252">在 SharePoint 環境中管理 SQL Server 時要考量的工作，可能會與一般管理資料庫應用程式要考量的工作不同。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-252">The tasks to consider when managing SQL Server in a SharePoint environment may differ from the ones typically considered for a database application.</span></span> <span data-ttu-id="7b2ae-253">最佳作法是以每晚累計的備份，在每週完整備份所有 SQL 資料庫。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-253">A best practice is to fully back up all SQL databases weekly with incremental nightly backups.</span></span> <span data-ttu-id="7b2ae-254">每隔 15 分鐘備份一次交易記錄。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-254">Back up transaction logs every 15 minutes.</span></span> <span data-ttu-id="7b2ae-255">另一個做法是在資料庫上實作 SQL Server 維護工作，同時停用內建的 SharePoint 維護工作。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-255">Another practice is to implement SQL Server maintenance tasks on the databases while disabling the built-in SharePoint ones.</span></span> <span data-ttu-id="7b2ae-256">如需詳細資訊，請參閱[儲存體和 SQL Server 容量規劃和設定][sql-server-capacity-planning]。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-256">For more information, see [Storage and SQL Server capacity planning and configuration][sql-server-capacity-planning].</span></span> 

## <a name="security-considerations"></a><span data-ttu-id="7b2ae-257">安全性考量</span><span class="sxs-lookup"><span data-stu-id="7b2ae-257">Security considerations</span></span>

<span data-ttu-id="7b2ae-258">用來執行 SharePoint Server 2016 的網域層級服務帳戶，需要 Windows Server AD 網域控制站來進行網域加入及驗證處理程序。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-258">The domain-level service accounts used to run SharePoint Server 2016 require Windows Server AD domain controllers for domain-join and authentication processes.</span></span> <span data-ttu-id="7b2ae-259">Azure Active Directory Domain Services 無法用於此用途。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-259">Azure Active Directory Domain Services can't be used for this purpose.</span></span> <span data-ttu-id="7b2ae-260">若要擴充已經在內部網路中就緒的 Windows Server AD 身分識別基礎結構，此架構會使用現有內部部署 Windows Server AD 樹系的兩個 Windows Server AD 複本網域控制站。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-260">To extend the Windows Server AD identity infrastructure already in place in the intranet, this architecture uses two Windows Server AD replica domain controllers of an existing on-premises Windows Server AD forest.</span></span>

<span data-ttu-id="7b2ae-261">此外，規劃安全性強化絕對是個明智的選擇。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-261">In addition, it's always wise to plan for security hardening.</span></span> <span data-ttu-id="7b2ae-262">其他建議如下：</span><span class="sxs-lookup"><span data-stu-id="7b2ae-262">Other recommendations include:</span></span>

- <span data-ttu-id="7b2ae-263">將規則新增至 NSG 以隔離子網路和角色。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-263">Add rules to NSGs to isolate subnets and roles.</span></span>
- <span data-ttu-id="7b2ae-264">不要將公用 IP 位址指派給虛擬機器。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-264">Don't assign public IP addresses to VMs.</span></span>
- <span data-ttu-id="7b2ae-265">針對入侵偵測和乘載分析，請考慮在前端 Web 伺服器之前使用網路虛擬設備，而不是使用內部 Azure 負載平衡器。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-265">For intrusion detection and analysis of payloads, consider using a network virtual appliance in front of the front-end web servers instead of an internal Azure load balancer.</span></span>
- <span data-ttu-id="7b2ae-266">您可以選擇對伺服器之間的純文字傳輸加密使用 IPsec 原則。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-266">As an option, use IPsec policies for encryption of cleartext traffic between servers.</span></span> <span data-ttu-id="7b2ae-267">如果您也進行了子網路隔離，請將您的網路安全性群組規則更新為允許 IPsec 流量。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-267">If you are also doing subnet isolation, update your network security group rules to allow IPsec traffic.</span></span>
- <span data-ttu-id="7b2ae-268">安裝適用於虛擬機器的反惡意程式碼代理程式。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-268">Install anti-malware agents for the VMs.</span></span>

## <a name="deploy-the-solution"></a><span data-ttu-id="7b2ae-269">部署解決方案</span><span class="sxs-lookup"><span data-stu-id="7b2ae-269">Deploy the solution</span></span>

<span data-ttu-id="7b2ae-270">此參考架構的部署指令碼可在 [GitHub][github] 上取得。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-270">The deployment scripts for this reference architecture are available on [GitHub][github].</span></span> 

<span data-ttu-id="7b2ae-271">您可以以累加方式或一次全部部署此架構。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-271">You can deploy this architecture incrementally or all at once.</span></span> <span data-ttu-id="7b2ae-272">第一次，建議您使用累加式部署，以便您看到每個部署的執行方式。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-272">The first time, we recommend an incremental deployment, so that you can see what each deployment does.</span></span> <span data-ttu-id="7b2ae-273">使用下列其中一個 mode 參數來指定增量。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-273">Specify the increment using one of the following *mode* parameters.</span></span>

| <span data-ttu-id="7b2ae-274">Mode</span><span class="sxs-lookup"><span data-stu-id="7b2ae-274">Mode</span></span>           | <span data-ttu-id="7b2ae-275">作用</span><span class="sxs-lookup"><span data-stu-id="7b2ae-275">What it does</span></span>                                                                                                            |
|----------------|-------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="7b2ae-276">onprem</span><span class="sxs-lookup"><span data-stu-id="7b2ae-276">onprem</span></span>         | <span data-ttu-id="7b2ae-277">(選擇性) 部署模擬的內部部署網路環境以用於測試或評估。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-277">(Optional) Deploys a simulated on-premises network environment, for testing or evaluation.</span></span> <span data-ttu-id="7b2ae-278">這個步驟不會連線到實際的內部部署網路。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-278">This step does not connect to an actual on-premises network.</span></span> |
| <span data-ttu-id="7b2ae-279">infrastructure</span><span class="sxs-lookup"><span data-stu-id="7b2ae-279">infrastructure</span></span> | <span data-ttu-id="7b2ae-280">將 SharePoint 2016 網路基礎結構和 jumpbox 部署到 Azure。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-280">Deploys the SharePoint 2016 network infrastructure and jumpbox to Azure.</span></span>                                                |
| <span data-ttu-id="7b2ae-281">createvpn</span><span class="sxs-lookup"><span data-stu-id="7b2ae-281">createvpn</span></span>      | <span data-ttu-id="7b2ae-282">部署 SharePoint 和內部部署網路的虛擬網路閘道並使其連線。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-282">Deploys a virtual network gateway for both the SharePoint and on-premises networks and connects them.</span></span> <span data-ttu-id="7b2ae-283">只有當您執行 `onprem` 步驟時，才須執行此步驟。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-283">Run this step only if you ran the `onprem` step.</span></span>                |
| <span data-ttu-id="7b2ae-284">workload</span><span class="sxs-lookup"><span data-stu-id="7b2ae-284">workload</span></span>       | <span data-ttu-id="7b2ae-285">將 SharePoint 伺服器部署到 SharePoint 網路。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-285">Deploys the SharePoint servers to the SharePoint network.</span></span>                                                               |
| <span data-ttu-id="7b2ae-286">security</span><span class="sxs-lookup"><span data-stu-id="7b2ae-286">security</span></span>       | <span data-ttu-id="7b2ae-287">將網路安全性群組部署到 SharePoint 網路。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-287">Deploys the network security group to the SharePoint network.</span></span>                                                           |
| <span data-ttu-id="7b2ae-288">所有</span><span class="sxs-lookup"><span data-stu-id="7b2ae-288">all</span></span>            | <span data-ttu-id="7b2ae-289">部署所有先前的部署。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-289">Deploys all the preceding deployments.</span></span>                            


<span data-ttu-id="7b2ae-290">若要在模擬的內部部署網路環境上以累加方式部署架構，請依序執行下列步驟：</span><span class="sxs-lookup"><span data-stu-id="7b2ae-290">To deploy the architecture incrementally with a simulated on-premises network environment, run the following steps in order:</span></span>

1. <span data-ttu-id="7b2ae-291">onprem</span><span class="sxs-lookup"><span data-stu-id="7b2ae-291">onprem</span></span>
2. <span data-ttu-id="7b2ae-292">infrastructure</span><span class="sxs-lookup"><span data-stu-id="7b2ae-292">infrastructure</span></span>
3. <span data-ttu-id="7b2ae-293">createvpn</span><span class="sxs-lookup"><span data-stu-id="7b2ae-293">createvpn</span></span>
4. <span data-ttu-id="7b2ae-294">workload</span><span class="sxs-lookup"><span data-stu-id="7b2ae-294">workload</span></span>
5. <span data-ttu-id="7b2ae-295">security</span><span class="sxs-lookup"><span data-stu-id="7b2ae-295">security</span></span>

<span data-ttu-id="7b2ae-296">若不是在模擬的內部部署網路環境上以累加方式部署架構，請依序執行下列步驟：</span><span class="sxs-lookup"><span data-stu-id="7b2ae-296">To deploy the architecture incrementally without a simulated on-premises network environment, run the following steps in order:</span></span>

1. <span data-ttu-id="7b2ae-297">infrastructure</span><span class="sxs-lookup"><span data-stu-id="7b2ae-297">infrastructure</span></span>
2. <span data-ttu-id="7b2ae-298">workload</span><span class="sxs-lookup"><span data-stu-id="7b2ae-298">workload</span></span>
3. <span data-ttu-id="7b2ae-299">security</span><span class="sxs-lookup"><span data-stu-id="7b2ae-299">security</span></span>

<span data-ttu-id="7b2ae-300">若要在一個步驟中部署所有項目，請使用 `all`。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-300">To deploy everything in one step, use `all`.</span></span> <span data-ttu-id="7b2ae-301">請注意，整個程序可能需費時數小時。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-301">Note that the entire process may take several hours.</span></span>

### <a name="prerequisites"></a><span data-ttu-id="7b2ae-302">先決條件</span><span class="sxs-lookup"><span data-stu-id="7b2ae-302">Prerequisites</span></span>

* <span data-ttu-id="7b2ae-303">安裝最新版的 [Azure PowerShell][azure-ps]。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-303">Install the latest version of [Azure PowerShell][azure-ps].</span></span>

* <span data-ttu-id="7b2ae-304">在部署此參考架構之前，請確認您的訂用帳戶有足夠的配額 (至少 38 個核心)。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-304">Before deploying this reference architecture, verify that your subscription has sufficient quota—at least 38 cores.</span></span> <span data-ttu-id="7b2ae-305">如果沒有足夠的配額，請使用 Azure 入口網站來提交支援要求以取得更多配額。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-305">If you don't have enough, use the Azure portal to submit a support request for more quota.</span></span>

* <span data-ttu-id="7b2ae-306">若要預估此部署的成本，請參閱 [Azure 定價計算機][azure-pricing]。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-306">To estimate the cost of this deployment, see the [Azure Pricing Calculator][azure-pricing].</span></span>

### <a name="deploy-the-reference-architecture"></a><span data-ttu-id="7b2ae-307">部署參考架構</span><span class="sxs-lookup"><span data-stu-id="7b2ae-307">Deploy the reference architecture</span></span>

1.  <span data-ttu-id="7b2ae-308">將 [GitHub 存放庫][github]下載或複製到本機電腦。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-308">Download or clone the [GitHub repo][github] to your local computer.</span></span>

2.  <span data-ttu-id="7b2ae-309">開啟 PowerShell 視窗並瀏覽至 `/sharepoint/sharepoint-2016` 資料夾。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-309">Open a PowerShell window and navigate to the `/sharepoint/sharepoint-2016` folder.</span></span>

3.  <span data-ttu-id="7b2ae-310">執行下列 PowerShell 命令。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-310">Run the following PowerShell command.</span></span> <span data-ttu-id="7b2ae-311">針對\<subscription id\>，您的 Azure 訂用帳戶識別碼。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-311">For \<subscription id\>, use your Azure subscription ID.</span></span> <span data-ttu-id="7b2ae-312">針對\<location\>，請指定 Azure 區域，例如 `eastus` 或 `westus`。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-312">For \<location\>, specify an Azure region, such as `eastus` or `westus`.</span></span> <span data-ttu-id="7b2ae-313">針對\<mode\>，請指定 `onprem`、`infrastructure`、`createvpn`、`workload`、`security` 或 `all`。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-313">For \<mode\>, specify `onprem`, `infrastructure`, `createvpn`, `workload`, `security`, or `all`.</span></span>

    ```powershell
    .\Deploy-ReferenceArchitecture.ps1 <subscription id> <location> <mode>
    ```   
4. <span data-ttu-id="7b2ae-314">出現提示時，請登入您的 Azure 帳戶。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-314">When prompted, log on to your Azure account.</span></span> <span data-ttu-id="7b2ae-315">部署指令碼可能需要數小時才能完成，視您選取的模式而定。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-315">The deployment scripts can take up to several hours to complete, depending on the mode you selected.</span></span>

5. <span data-ttu-id="7b2ae-316">完成部署之後，請執行指令碼以設定 SQL Server Alwayson 可用性群組。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-316">When the deployment completes, run the scripts to configure SQL Server Always On Availability Groups.</span></span> <span data-ttu-id="7b2ae-317">請參閱[讀我檔案][readme]，以取得詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-317">See the [readme][readme] for details.</span></span>

> [!WARNING]
> <span data-ttu-id="7b2ae-318">參數檔案會在不同位置中包含硬式編碼的密碼 (`AweS0me@PW`)。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-318">The parameter files include a hard-coded password (`AweS0me@PW`) in various places.</span></span> <span data-ttu-id="7b2ae-319">在部署之前，請變更這些值。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-319">Change these values before you deploy.</span></span>


## <a name="validate-the-deployment"></a><span data-ttu-id="7b2ae-320">驗證部署</span><span class="sxs-lookup"><span data-stu-id="7b2ae-320">Validate the deployment</span></span>

<span data-ttu-id="7b2ae-321">部署此參考架構之後，下列資源群組會列在您所使用的訂用帳戶底下：</span><span class="sxs-lookup"><span data-stu-id="7b2ae-321">After you deploy this reference architecture, the following resource groups are listed under the Subscription that you used:</span></span>

| <span data-ttu-id="7b2ae-322">資源群組</span><span class="sxs-lookup"><span data-stu-id="7b2ae-322">Resource Group</span></span>        | <span data-ttu-id="7b2ae-323">目的</span><span class="sxs-lookup"><span data-stu-id="7b2ae-323">Purpose</span></span>                                                                                         |
|-----------------------|-------------------------------------------------------------------------------------------------|
| <span data-ttu-id="7b2ae-324">ra-onprem-sp2016-rg</span><span class="sxs-lookup"><span data-stu-id="7b2ae-324">ra-onprem-sp2016-rg</span></span>   | <span data-ttu-id="7b2ae-325">使用 Active Directory 的模擬內部部署網路，與 SharePoint 2016 網路是同盟關係</span><span class="sxs-lookup"><span data-stu-id="7b2ae-325">Simulated on-premises network with Active Directory, federated with the SharePoint 2016 network</span></span> |
| <span data-ttu-id="7b2ae-326">ra-sp2016-network-rg</span><span class="sxs-lookup"><span data-stu-id="7b2ae-326">ra-sp2016-network-rg</span></span>  | <span data-ttu-id="7b2ae-327">支援 SharePoint 部署的基礎結構</span><span class="sxs-lookup"><span data-stu-id="7b2ae-327">Infrastructure to support SharePoint deployment</span></span>                                                 |
| <span data-ttu-id="7b2ae-328">ra-sp2016-workload-rg</span><span class="sxs-lookup"><span data-stu-id="7b2ae-328">ra-sp2016-workload-rg</span></span> | <span data-ttu-id="7b2ae-329">SharePoint 和支援的資源</span><span class="sxs-lookup"><span data-stu-id="7b2ae-329">SharePoint and supporting resources</span></span>                                                             |

### <a name="validate-access-to-the-sharepoint-site-from-the-on-premises-network"></a><span data-ttu-id="7b2ae-330">從內部部署網路驗證 SharePoint 網站的存取權</span><span class="sxs-lookup"><span data-stu-id="7b2ae-330">Validate access to the SharePoint site from the on-premises network</span></span>

1. <span data-ttu-id="7b2ae-331">在 [Azure 入口網站][azure-portal]中的 [資源群組] 下，選取 `ra-onprem-sp2016-rg` 資源群組。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-331">In the [Azure portal][azure-portal], under **Resource groups**, select the `ra-onprem-sp2016-rg` resource group.</span></span>

2. <span data-ttu-id="7b2ae-332">在資源清單中，選取名為 `ra-adds-user-vm1` 的虛擬機器資源。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-332">In the list of resources, select the VM resource named `ra-adds-user-vm1`.</span></span> 

3. <span data-ttu-id="7b2ae-333">連線至虛擬機器，如[連線至虛擬機器][connect-to-vm]中所述。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-333">Connect to the VM, as described in [Connect to virtual machine][connect-to-vm].</span></span> <span data-ttu-id="7b2ae-334">使用者名稱為 `\onpremuser`。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-334">The user name is `\onpremuser`.</span></span>

5.  <span data-ttu-id="7b2ae-335">與虛擬機器建立遠端連線後，在虛擬機器中開啟瀏覽器並瀏覽至 `http://portal.contoso.local`。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-335">When the remote connection to the VM is established, open a browser in the VM and navigate to `http://portal.contoso.local`.</span></span>

6.  <span data-ttu-id="7b2ae-336">在 [Windows 安全性] 方塊中，使用 `contoso.local\testuser` 作為使用者名稱來登入 SharePoint 入口網站。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-336">In the **Windows Security** box, log on to the SharePoint portal using `contoso.local\testuser` for the user name.</span></span>

<span data-ttu-id="7b2ae-337">此登入可讓您從內部部署網路使用的 Fabrikam.com 網域通往 SharePoint 入口網站使用的 contoso.local 網域。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-337">This logon tunnels from the Fabrikam.com domain used by the on-premises network to the contoso.local domain used by the SharePoint portal.</span></span> <span data-ttu-id="7b2ae-338">當 SharePoint 網站開啟時，您會看到根示範網站。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-338">When the SharePoint site opens, you'll see the root demo site.</span></span>

### <a name="validate-jumpbox-access-to-vms-and-check-configuration-settings"></a><span data-ttu-id="7b2ae-339">驗證虛擬機器的 jumpbox 存取權及檢查組態設定</span><span class="sxs-lookup"><span data-stu-id="7b2ae-339">Validate jumpbox access to VMs and check configuration settings</span></span>

1.  <span data-ttu-id="7b2ae-340">在 [Azure 入口網站][azure-portal]中的 [資源群組] 下，選取 `ra-sp2016-network-rg` 資源群組。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-340">In [Azure portal][azure-portal], under **Resource groups**, select the `ra-sp2016-network-rg` resource group.</span></span>

2.  <span data-ttu-id="7b2ae-341">在資源清單中，選取名為 `ra-sp2016-jb-vm1` 的虛擬機器資源，這就是 jumpbox。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-341">In the list of resources, select the VM resource named `ra-sp2016-jb-vm1`, which is the jumpbox.</span></span>

3. <span data-ttu-id="7b2ae-342">連線至虛擬機器，如[連線至虛擬機器][connect-to-vm]中所述。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-342">Connect to the VM, as described in [Connect to virtual machine][connect-to-vm].</span></span> <span data-ttu-id="7b2ae-343">使用者名稱為 `testuser`。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-343">The user name is `testuser`.</span></span>

4.  <span data-ttu-id="7b2ae-344">登入 jumpbox 之後，請從 jumpbox 開啟 RDP 工作階段。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-344">After you log onto the jumpbox, open an RDP session from the jumpbox.</span></span> <span data-ttu-id="7b2ae-345">連線至 VNet 中的任何其他虛擬機器。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-345">Connect to any other VMs in the VNet.</span></span> <span data-ttu-id="7b2ae-346">使用者名稱是 `testuser`。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-346">The username is `testuser`.</span></span> <span data-ttu-id="7b2ae-347">您可以忽略有關遠端電腦安全性憑證的警告。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-347">You can ignore the warning about the remote computer's security certificate.</span></span>

5.  <span data-ttu-id="7b2ae-348">虛擬機器的遠端連線開啟時，請檢閱設定然後使用「伺服器管理員」等系統管理工具進行變更。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-348">When the remote connection to the VM opens, review the configuration and make changes using the administrative tools such as Server Manager.</span></span>

<span data-ttu-id="7b2ae-349">部署的虛擬機器如下表所示。</span><span class="sxs-lookup"><span data-stu-id="7b2ae-349">The following table shows the VMs that are deployed.</span></span> 

| <span data-ttu-id="7b2ae-350">資源名稱</span><span class="sxs-lookup"><span data-stu-id="7b2ae-350">Resource Name</span></span>      | <span data-ttu-id="7b2ae-351">目的</span><span class="sxs-lookup"><span data-stu-id="7b2ae-351">Purpose</span></span>                                   | <span data-ttu-id="7b2ae-352">資源群組</span><span class="sxs-lookup"><span data-stu-id="7b2ae-352">Resource Group</span></span>        | <span data-ttu-id="7b2ae-353">虛擬機器名稱</span><span class="sxs-lookup"><span data-stu-id="7b2ae-353">VM Name</span></span>                       |
|--------------------|-------------------------------------------|-----------------------|-------------------------------|
| <span data-ttu-id="7b2ae-354">Ra-sp2016-ad-vm1</span><span class="sxs-lookup"><span data-stu-id="7b2ae-354">Ra-sp2016-ad-vm1</span></span>   | <span data-ttu-id="7b2ae-355">Active Directory + DNS</span><span class="sxs-lookup"><span data-stu-id="7b2ae-355">Active Directory + DNS</span></span>                    | <span data-ttu-id="7b2ae-356">Ra-sp2016-network-rg</span><span class="sxs-lookup"><span data-stu-id="7b2ae-356">Ra-sp2016-network-rg</span></span>  | <span data-ttu-id="7b2ae-357">Ad1.contoso.local</span><span class="sxs-lookup"><span data-stu-id="7b2ae-357">Ad1.contoso.local</span></span>             |
| <span data-ttu-id="7b2ae-358">Ra-sp2016-ad-vm2</span><span class="sxs-lookup"><span data-stu-id="7b2ae-358">Ra-sp2016-ad-vm2</span></span>   | <span data-ttu-id="7b2ae-359">Active Directory + DNS</span><span class="sxs-lookup"><span data-stu-id="7b2ae-359">Active Directory + DNS</span></span>                    | <span data-ttu-id="7b2ae-360">Ra-sp2016-network-rg</span><span class="sxs-lookup"><span data-stu-id="7b2ae-360">Ra-sp2016-network-rg</span></span>  | <span data-ttu-id="7b2ae-361">Ad2.contoso.local</span><span class="sxs-lookup"><span data-stu-id="7b2ae-361">Ad2.contoso.local</span></span>             |
| <span data-ttu-id="7b2ae-362">Ra-sp2016-fsw-vm1</span><span class="sxs-lookup"><span data-stu-id="7b2ae-362">Ra-sp2016-fsw-vm1</span></span>  | <span data-ttu-id="7b2ae-363">SharePoint</span><span class="sxs-lookup"><span data-stu-id="7b2ae-363">SharePoint</span></span>                                | <span data-ttu-id="7b2ae-364">Ra-sp2016-network-rg</span><span class="sxs-lookup"><span data-stu-id="7b2ae-364">Ra-sp2016-network-rg</span></span>  | <span data-ttu-id="7b2ae-365">Fsw1.contoso.local</span><span class="sxs-lookup"><span data-stu-id="7b2ae-365">Fsw1.contoso.local</span></span>            |
| <span data-ttu-id="7b2ae-366">Ra-sp2016-jb-vm1</span><span class="sxs-lookup"><span data-stu-id="7b2ae-366">Ra-sp2016-jb-vm1</span></span>   | <span data-ttu-id="7b2ae-367">Jumpbox</span><span class="sxs-lookup"><span data-stu-id="7b2ae-367">Jumpbox</span></span>                                   | <span data-ttu-id="7b2ae-368">Ra-sp2016-network-rg</span><span class="sxs-lookup"><span data-stu-id="7b2ae-368">Ra-sp2016-network-rg</span></span>  | <span data-ttu-id="7b2ae-369">Jb (使用公用 IP登入)</span><span class="sxs-lookup"><span data-stu-id="7b2ae-369">Jb (use public IP to log on)</span></span> |
| <span data-ttu-id="7b2ae-370">Ra-sp2016-sql-vm1</span><span class="sxs-lookup"><span data-stu-id="7b2ae-370">Ra-sp2016-sql-vm1</span></span>  | <span data-ttu-id="7b2ae-371">SQL Always On - 容錯移轉</span><span class="sxs-lookup"><span data-stu-id="7b2ae-371">SQL Always On - Failover</span></span>                  | <span data-ttu-id="7b2ae-372">Ra-sp2016-network-rg</span><span class="sxs-lookup"><span data-stu-id="7b2ae-372">Ra-sp2016-network-rg</span></span>  | <span data-ttu-id="7b2ae-373">Sq1.contoso.local</span><span class="sxs-lookup"><span data-stu-id="7b2ae-373">Sq1.contoso.local</span></span>             |
| <span data-ttu-id="7b2ae-374">Ra-sp2016-sql-vm2</span><span class="sxs-lookup"><span data-stu-id="7b2ae-374">Ra-sp2016-sql-vm2</span></span>  | <span data-ttu-id="7b2ae-375">SQL Always On - 主要</span><span class="sxs-lookup"><span data-stu-id="7b2ae-375">SQL Always On - Primary</span></span>                   | <span data-ttu-id="7b2ae-376">Ra-sp2016-network-rg</span><span class="sxs-lookup"><span data-stu-id="7b2ae-376">Ra-sp2016-network-rg</span></span>  | <span data-ttu-id="7b2ae-377">Sq2.contoso.local</span><span class="sxs-lookup"><span data-stu-id="7b2ae-377">Sq2.contoso.local</span></span>             |
| <span data-ttu-id="7b2ae-378">Ra-sp2016-app-vm1</span><span class="sxs-lookup"><span data-stu-id="7b2ae-378">Ra-sp2016-app-vm1</span></span>  | <span data-ttu-id="7b2ae-379">SharePoint 2016 應用程式 MinRole</span><span class="sxs-lookup"><span data-stu-id="7b2ae-379">SharePoint 2016 Application MinRole</span></span>       | <span data-ttu-id="7b2ae-380">Ra-sp2016-workload-rg</span><span class="sxs-lookup"><span data-stu-id="7b2ae-380">Ra-sp2016-workload-rg</span></span> | <span data-ttu-id="7b2ae-381">App1.contoso.local</span><span class="sxs-lookup"><span data-stu-id="7b2ae-381">App1.contoso.local</span></span>            |
| <span data-ttu-id="7b2ae-382">Ra-sp2016-app-vm2</span><span class="sxs-lookup"><span data-stu-id="7b2ae-382">Ra-sp2016-app-vm2</span></span>  | <span data-ttu-id="7b2ae-383">SharePoint 2016 應用程式 MinRole</span><span class="sxs-lookup"><span data-stu-id="7b2ae-383">SharePoint 2016 Application MinRole</span></span>       | <span data-ttu-id="7b2ae-384">Ra-sp2016-workload-rg</span><span class="sxs-lookup"><span data-stu-id="7b2ae-384">Ra-sp2016-workload-rg</span></span> | <span data-ttu-id="7b2ae-385">App2.contoso.local</span><span class="sxs-lookup"><span data-stu-id="7b2ae-385">App2.contoso.local</span></span>            |
| <span data-ttu-id="7b2ae-386">Ra-sp2016-dch-vm1</span><span class="sxs-lookup"><span data-stu-id="7b2ae-386">Ra-sp2016-dch-vm1</span></span>  | <span data-ttu-id="7b2ae-387">SharePoint 2016 分散式快取 MinRole</span><span class="sxs-lookup"><span data-stu-id="7b2ae-387">SharePoint 2016 Distributed Cache MinRole</span></span> | <span data-ttu-id="7b2ae-388">Ra-sp2016-workload-rg</span><span class="sxs-lookup"><span data-stu-id="7b2ae-388">Ra-sp2016-workload-rg</span></span> | <span data-ttu-id="7b2ae-389">Dch1.contoso.local</span><span class="sxs-lookup"><span data-stu-id="7b2ae-389">Dch1.contoso.local</span></span>            |
| <span data-ttu-id="7b2ae-390">Ra-sp2016-dch-vm2</span><span class="sxs-lookup"><span data-stu-id="7b2ae-390">Ra-sp2016-dch-vm2</span></span>  | <span data-ttu-id="7b2ae-391">SharePoint 2016 分散式快取 MinRole</span><span class="sxs-lookup"><span data-stu-id="7b2ae-391">SharePoint 2016 Distributed Cache MinRole</span></span> | <span data-ttu-id="7b2ae-392">Ra-sp2016-workload-rg</span><span class="sxs-lookup"><span data-stu-id="7b2ae-392">Ra-sp2016-workload-rg</span></span> | <span data-ttu-id="7b2ae-393">Dch2.contoso.local</span><span class="sxs-lookup"><span data-stu-id="7b2ae-393">Dch2.contoso.local</span></span>            |
| <span data-ttu-id="7b2ae-394">Ra-sp2016-srch-vm1</span><span class="sxs-lookup"><span data-stu-id="7b2ae-394">Ra-sp2016-srch-vm1</span></span> | <span data-ttu-id="7b2ae-395">SharePoint 2016 搜尋 MinRole</span><span class="sxs-lookup"><span data-stu-id="7b2ae-395">SharePoint 2016 Search MinRole</span></span>            | <span data-ttu-id="7b2ae-396">Ra-sp2016-workload-rg</span><span class="sxs-lookup"><span data-stu-id="7b2ae-396">Ra-sp2016-workload-rg</span></span> | <span data-ttu-id="7b2ae-397">Srch1.contoso.local</span><span class="sxs-lookup"><span data-stu-id="7b2ae-397">Srch1.contoso.local</span></span>           |
| <span data-ttu-id="7b2ae-398">Ra-sp2016-srch-vm2</span><span class="sxs-lookup"><span data-stu-id="7b2ae-398">Ra-sp2016-srch-vm2</span></span> | <span data-ttu-id="7b2ae-399">SharePoint 2016 搜尋 MinRole</span><span class="sxs-lookup"><span data-stu-id="7b2ae-399">SharePoint 2016 Search MinRole</span></span>            | <span data-ttu-id="7b2ae-400">Ra-sp2016-workload-rg</span><span class="sxs-lookup"><span data-stu-id="7b2ae-400">Ra-sp2016-workload-rg</span></span> | <span data-ttu-id="7b2ae-401">Srch2.contoso.local</span><span class="sxs-lookup"><span data-stu-id="7b2ae-401">Srch2.contoso.local</span></span>           |
| <span data-ttu-id="7b2ae-402">Ra-sp2016-wfe-vm1</span><span class="sxs-lookup"><span data-stu-id="7b2ae-402">Ra-sp2016-wfe-vm1</span></span>  | <span data-ttu-id="7b2ae-403">SharePoint 2016 Web 前端 MinRole</span><span class="sxs-lookup"><span data-stu-id="7b2ae-403">SharePoint 2016 Web Front End MinRole</span></span>     | <span data-ttu-id="7b2ae-404">Ra-sp2016-workload-rg</span><span class="sxs-lookup"><span data-stu-id="7b2ae-404">Ra-sp2016-workload-rg</span></span> | <span data-ttu-id="7b2ae-405">Wfe1.contoso.local</span><span class="sxs-lookup"><span data-stu-id="7b2ae-405">Wfe1.contoso.local</span></span>            |
| <span data-ttu-id="7b2ae-406">Ra-sp2016-wfe-vm2</span><span class="sxs-lookup"><span data-stu-id="7b2ae-406">Ra-sp2016-wfe-vm2</span></span>  | <span data-ttu-id="7b2ae-407">SharePoint 2016 Web 前端 MinRole</span><span class="sxs-lookup"><span data-stu-id="7b2ae-407">SharePoint 2016 Web Front End MinRole</span></span>     | <span data-ttu-id="7b2ae-408">Ra-sp2016-workload-rg</span><span class="sxs-lookup"><span data-stu-id="7b2ae-408">Ra-sp2016-workload-rg</span></span> | <span data-ttu-id="7b2ae-409">Wfe2.contoso.local</span><span class="sxs-lookup"><span data-stu-id="7b2ae-409">Wfe2.contoso.local</span></span>            |


<span data-ttu-id="7b2ae-410">**_此參考架構的參與者_** &mdash;  Joe Davies、Bob Fox、Neil Hodgkinson、Paul Stork</span><span class="sxs-lookup"><span data-stu-id="7b2ae-410">**_Contributors to this reference architecture_** &mdash;  Joe Davies, Bob Fox, Neil Hodgkinson, Paul Stork</span></span>

<!-- links -->

[availability-set]: /azure/virtual-machines/windows/manage-availability
[azure-portal]: https://portal.azure.com
[azure-ps]: /powershell/azure/overview
[azure-pricing]: https://azure.microsoft.com/en-us/pricing/calculator/
[bastion-host]: https://en.wikipedia.org/wiki/Bastion_host
[create-availability-group]: https://technet.microsoft.com/library/mt793548(v=office.16).aspx
[connect-to-vm]: /azure/virtual-machines/windows/quick-create-portal#connect-to-virtual-machine
[github]: https://github.com/mspnp/reference-architectures
[hybrid-ra]: ../hybrid-networking/index.md
[hybrid-vpn-ra]: ../hybrid-networking/vpn.md
[load-balancer]: /azure/load-balancer/load-balancer-internal-overview
[managed-disks]: /azure/storage/storage-managed-disks-overview
[minroles]: https://technet.microsoft.com/library/mt346114(v=office.16).aspx
[nsg]: /azure/virtual-network/virtual-networks-nsg
[office-web-apps]: https://support.microsoft.com/help/3199955/office-web-apps-and-office-online-server-supportability-in-azure
[paired-regions]: /azure/best-practices-availability-paired-regions
[readme]: https://github.com/mspnp/reference-architectures/tree/master/sharepoint/sharepoint-2016
[resource-group]: /azure/azure-resource-manager/resource-group-overview
[quotas]: /azure/azure-subscription-service-limits
[sharepoint-accounts]: https://technet.microsoft.com/library/ee662513(v=office.16).aspx
[sharepoint-crawling]: https://technet.microsoft.com/library/dn535606(v=office.16).aspx
[sharepoint-dr]: https://technet.microsoft.com/library/ff628971(v=office.16).aspx
[sharepoint-hybrid]: https://aka.ms/sphybrid
[sharepoint-minrole]: https://technet.microsoft.com/library/mt743705(v=office.16).aspx
[sharepoint-ops]: https://technet.microsoft.com/library/cc262289(v=office.16).aspx
[sharepoint-reqs]: https://technet.microsoft.com/library/cc262485(v=office.16).aspx
[sharepoint-search]: https://technet.microsoft.com/library/dn342836.aspx
[sql-always-on]: /sql/database-engine/availability-groups/windows/always-on-availability-groups-sql-server
[sql-performance]: /virtual-machines/windows/sql/virtual-machines-windows-sql-performance
[sql-server-capacity-planning]: https://technet.microsoft.com/library/cc298801(v=office.16).aspx
[sql-quorum]: https://technet.microsoft.com/library/cc731739(v=ws.11).aspx
[sql-sharepoint-best-practices]: https://technet.microsoft.com/library/hh292622(v=office.16).aspx
[tempdb]: /sql/relational-databases/databases/tempdb-database
[virtual-networks-nsg]: /azure/virtual-network/virtual-networks-nsg
[visio-download]: https://archcenter.azureedge.net/cdn/Sharepoint-2016.vsdx
[vm-sizes-general]: /azure/virtual-machines/windows/sizes-general
[vm-sizes-memory]: /azure/virtual-machines/windows/sizes-memory
[windows-n-tier]: ../virtual-machines-windows/n-tier.md

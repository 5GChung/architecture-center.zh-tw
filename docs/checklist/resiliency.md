---
title: "復原檢查清單"
description: "提供設計期間復原考量指引的檢查清單。"
author: petertaylor9999
ms.date: 03/24/2017
ms.custom: resiliency, checklist
ms.openlocfilehash: d0ae48be603391a7be043130d6d77d3c82abad18
ms.sourcegitcommit: b0482d49aab0526be386837702e7724c61232c60
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 11/14/2017
---
# <a name="resiliency-checklist"></a><span data-ttu-id="fa7b3-103">復原檢查清單</span><span class="sxs-lookup"><span data-stu-id="fa7b3-103">Resiliency checklist</span></span>
[!INCLUDE [header](../_includes/header.md)]

<span data-ttu-id="fa7b3-104">針對復原能力設計應用程式時，您需要進行規劃並緩和可能發生的各種失敗模式。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-104">Designing your application for resiliency requires planning for and mitigating a variety of failure modes that could occur.</span></span> <span data-ttu-id="fa7b3-105">針對您的應用程式設計檢閱此檢查清單中的項目，以改善其復原能力。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-105">Review the items in this checklist against your application design to improve its resiliency.</span></span>

## <a name="requirements"></a><span data-ttu-id="fa7b3-106">需求</span><span class="sxs-lookup"><span data-stu-id="fa7b3-106">Requirements</span></span>
* <span data-ttu-id="fa7b3-107">**定義客戶的可用性需求。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-107">**Define your customer's availability requirements.**</span></span> <span data-ttu-id="fa7b3-108">您的客戶對於您應用程式的元件會有可用性需求，這會影響您的應用程式的設計。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-108">Your customer will have availability requirements for the components in your application and this will affect your application's design.</span></span> <span data-ttu-id="fa7b3-109">針對應用程式的各項可用性目標，取得客戶的同意，否則您的設計可能不符合客戶的期望。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-109">Get agreement from your customer for the availability targets of each piece of your application, otherwise your design may not meet the customer's expectations.</span></span> <span data-ttu-id="fa7b3-110">如需詳細資訊，請參閱[定義您的復原需求](../resiliency/index.md#defining-your-resiliency-requirements)。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-110">For more information, see [Defining your resiliency requirements](../resiliency/index.md#defining-your-resiliency-requirements).</span></span>

## <a name="application-design"></a><span data-ttu-id="fa7b3-111">應用程式設計</span><span class="sxs-lookup"><span data-stu-id="fa7b3-111">Application Design</span></span>
* <span data-ttu-id="fa7b3-112">**為您的應用程式執行失敗模式分析 (FMA)。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-112">**Perform a failure mode analysis (FMA) for your application.**</span></span> <span data-ttu-id="fa7b3-113">FMA 是在設計階段早期將復原能力內建到應用程式的程序。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-113">FMA is a process for building resiliency into an application early in the design stage.</span></span> <span data-ttu-id="fa7b3-114">如需詳細資訊，請參閱[失敗模式分析][fma]。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-114">For more information, see [Failure mode analysis][fma].</span></span> <span data-ttu-id="fa7b3-115">FMA 的目標包括：</span><span class="sxs-lookup"><span data-stu-id="fa7b3-115">The goals of an FMA include:</span></span>  

  * <span data-ttu-id="fa7b3-116">識別應用程式可能遭遇哪些失敗類型。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-116">Identify what types of failures an application might experience.</span></span>
  * <span data-ttu-id="fa7b3-117">擷取可能的影響，以及每種失敗類型對應用程式的影響。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-117">Capture the potential effects and impact of each type of failure on the application.</span></span>
  * <span data-ttu-id="fa7b3-118">找出復原策略。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-118">Identify recovery strategies.</span></span>
  
* <span data-ttu-id="fa7b3-119">**部署多個服務執行個體。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-119">**Deploy multiple instances of services.**</span></span> <span data-ttu-id="fa7b3-120">如果您的應用程式相依於服務的單一執行個體，它會建立單一失敗點。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-120">If your application depends on a single instance of a service, it creates a single point of failure.</span></span> <span data-ttu-id="fa7b3-121">佈建多個執行個體，可改善復原能力和延展性。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-121">Provisioning multiple instances improves both resiliency and scalability.</span></span> <span data-ttu-id="fa7b3-122">對於 [Azure App Service](/azure/app-service/app-service-value-prop-what-is/)，選取可提供多個執行個體的 [App Service 方案](/azure/app-service/azure-web-sites-web-hosting-plans-in-depth-overview/)。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-122">For [Azure App Service](/azure/app-service/app-service-value-prop-what-is/), select an [App Service Plan](/azure/app-service/azure-web-sites-web-hosting-plans-in-depth-overview/) that offers multiple instances.</span></span> <span data-ttu-id="fa7b3-123">對於 Azure 雲端服務，設定您的每個角色以使用[多個執行個體](/azure/cloud-services/cloud-services-choose-me/#scaling-and-management)。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-123">For Azure Cloud Services, configure each of your roles to use [multiple instances](/azure/cloud-services/cloud-services-choose-me/#scaling-and-management).</span></span> <span data-ttu-id="fa7b3-124">對於 [Azure 虛擬機器 (VM)](/azure/virtual-machines/virtual-machines-windows-about/?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json)，確保 VM 架構包含多個 VM，而且每個 VM 都包含在[可用性設定組][availability-sets]中。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-124">For [Azure Virtual Machines (VMs)](/azure/virtual-machines/virtual-machines-windows-about/?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json), ensure that your VM architecture includes more than one VM and that each VM is included in an [availability set][availability-sets].</span></span>   
* <span data-ttu-id="fa7b3-125">**使用自動調整來因應負載增加。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-125">**Use autoscaling to respond to increases in load.**</span></span> <span data-ttu-id="fa7b3-126">如果您的應用程式並未設定為隨著負載增加自動相應放大，而應用程式的服務若充斥著使用者要求，這些服務可能會失敗。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-126">If your application is not configured to scale out automatically as load increases, it's possible that your application's services will fail if they become saturated with user requests.</span></span> <span data-ttu-id="fa7b3-127">如需詳細資訊，請參閱下列各項：</span><span class="sxs-lookup"><span data-stu-id="fa7b3-127">For more details, see the following:</span></span>

  * <span data-ttu-id="fa7b3-128">一般：[延展性檢查清單](./scalability.md)</span><span class="sxs-lookup"><span data-stu-id="fa7b3-128">General: [Scalability checklist](./scalability.md)</span></span>
  * <span data-ttu-id="fa7b3-129">Azure App Service：[手動或自動調整執行個體計數][app-service-autoscale]</span><span class="sxs-lookup"><span data-stu-id="fa7b3-129">Azure App Service: [Scale instance count manually or automatically][app-service-autoscale]</span></span>
  * <span data-ttu-id="fa7b3-130">雲端服務：[如何自動調整雲端服務][cloud-service-autoscale]</span><span class="sxs-lookup"><span data-stu-id="fa7b3-130">Cloud Services: [How to auto scale a cloud service][cloud-service-autoscale]</span></span>
  * <span data-ttu-id="fa7b3-131">虛擬機器：[自動調整與虛擬機器擴展集][vmss-autoscale]</span><span class="sxs-lookup"><span data-stu-id="fa7b3-131">Virtual Machines: [Automatic scaling and virtual machine scale sets][vmss-autoscale]</span></span>
* <span data-ttu-id="fa7b3-132">**使用負載平衡功能來分配要求。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-132">**Use load balancing to distribute requests.**</span></span> <span data-ttu-id="fa7b3-133">負載平衡功能可藉由從循環中移除狀況不良的執行個體，將應用程式的要求分配至狀況良好的服務執行個體。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-133">Load balancing distributes your application's requests to healthy service instances by removing unhealthy instances from rotation.</span></span> <span data-ttu-id="fa7b3-134">如果您的服務使用 Azure App Service 或 Azure 雲端服務，它已經為您平衡負載。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-134">If your service uses Azure App Service or Azure Cloud Services, it is already load balanced for you.</span></span> <span data-ttu-id="fa7b3-135">不過，如果您的應用程式使用 Azure VM，您就需要佈建負載平衡器。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-135">However, if your application uses Azure VMs, you will need to provision a load balancer.</span></span> <span data-ttu-id="fa7b3-136">如需詳細資訊，請參閱 [Azure Load Balancer](/azure/load-balancer/load-balancer-overview/)概觀。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-136">See the [Azure Load Balancer](/azure/load-balancer/load-balancer-overview/) overview for more details.</span></span>
* <span data-ttu-id="fa7b3-137">**將 Azure 應用程式閘道設定為使用多個執行個體。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-137">**Configure Azure Application Gateways to use multiple instances.**</span></span> <span data-ttu-id="fa7b3-138">根據您應用程式的需求，[Azure 應用程式閘道](/azure/application-gateway/application-gateway-introduction/)可能更適合用於將要求分配至您應用程式的服務。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-138">Depending on your application's requirements, an [Azure Application Gateway](/azure/application-gateway/application-gateway-introduction/) may be better suited to distributing requests to your application's services.</span></span> <span data-ttu-id="fa7b3-139">不過，SLA 不保證應用程式閘道服務的單一執行個體，所以如果應用程式閘道執行個體失敗，您的應用程式也可能會失敗。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-139">However, single instances of the Application Gateway service are not guaranteed by an SLA so it's possible that your application could fail if the Application Gateway instance fails.</span></span> <span data-ttu-id="fa7b3-140">佈建一個以上中型或大型應用程式閘道執行個體，可根據 [SLA](https://azure.microsoft.com/support/legal/sla/application-gateway/v1_0/) 條款保證服務的可用性。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-140">Provision more than one medium or larger Application Gateway instance to guarantee availability of the service under the terms of the [SLA](https://azure.microsoft.com/support/legal/sla/application-gateway/v1_0/).</span></span>
* <span data-ttu-id="fa7b3-141">**使用每個應用程式層的可用性設定組。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-141">**Use Availability Sets for each application tier.**</span></span> <span data-ttu-id="fa7b3-142">將執行個體放入[可用性設定組][availability-sets]中，可提供較高的 [SLA](https://azure.microsoft.com/support/legal/sla/virtual-machines/)。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-142">Placing your instances in an [availability set][availability-sets] provides a higher [SLA](https://azure.microsoft.com/support/legal/sla/virtual-machines/).</span></span> 
* <span data-ttu-id="fa7b3-143">**請考慮在多個區域中部署您的應用程式。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-143">**Consider deploying your application across multiple regions.**</span></span> <span data-ttu-id="fa7b3-144">如果您的應用程式已部署到單一區域，在少數情況下，整個區域會變得無法使用，您的應用程式也將無法使用。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-144">If your application is deployed to a single region, in the rare event the entire region becomes unavailable, your application will also be unavailable.</span></span> <span data-ttu-id="fa7b3-145">您應用程式的 SLA 條款可能無法接受這種情況。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-145">This may be unacceptable under the terms of your application's SLA.</span></span> <span data-ttu-id="fa7b3-146">若是如此，請考慮在多個區域中部署您的應用程式及其服務。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-146">If so, consider deploying your application and its services across multiple regions.</span></span> <span data-ttu-id="fa7b3-147">多區域部署可以使用主動-主動模式 (將要求分散於多個作用中執行個體) 或主動-被動模式 (保留「暖的」執行個體，以防主要執行個體失敗)。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-147">A multi-region deployment can use an active-active pattern (distributing requests across multiple active instances) or an active-passive pattern (keeping a "warm" instance in reserve, in case the primary instance fails).</span></span> <span data-ttu-id="fa7b3-148">我們建議您跨越區域配對來部署應用程式服務的多個執行個體。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-148">We recommend that you deploy multiple instances of your application's services across regional pairs.</span></span> <span data-ttu-id="fa7b3-149">如需詳細資訊，請參閱[商務持續性和災害復原 (BCDR)：Azure 配對區域](/azure/best-practices-availability-paired-regions)。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-149">For more information, see [Business continuity and disaster recovery (BCDR): Azure Paired Regions](/azure/best-practices-availability-paired-regions).</span></span>
* <span data-ttu-id="fa7b3-150">**使用 Azure 流量管理員將應用程式的流量傳送到不同的區域。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-150">**Use Azure Traffic Manager to route your application's traffic to different regions.**</span></span>  <span data-ttu-id="fa7b3-151">[Azure 流量管理員][traffic-manager] 會在 DNS 層級執行負載平衡，並根據您指定的[流量傳送][traffic-manager-routing]方法和您的應用程式端點的健康情況，將流量傳送到不同的區域。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-151">[Azure Traffic Manager][traffic-manager] performs load balancing at the DNS level and will route traffic to different regions based on the [traffic routing][traffic-manager-routing] method you specify and the health of your application's endpoints.</span></span> <span data-ttu-id="fa7b3-152">若未使用流量管理員，您會受限於您部署的單一區域，這會限制規模，增加某些使用者的延遲時間，並且在整個區域服務中斷的情況下造成應用程式停機。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-152">Without Traffic Manager, you are limited to a single region for your deployment, which limits scale, increases latency for some users, and causes application downtime in the case of a region-wide service disruption.</span></span>
* <span data-ttu-id="fa7b3-153">**為您的負載平衡器和流量管理員設定和測試健康情況探查。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-153">**Configure and test health probes for your load balancers and traffic managers.**</span></span> <span data-ttu-id="fa7b3-154">確定您的健康情況邏輯會檢查系統的重要組件，並適當地回應健康情況探查。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-154">Ensure that your health logic checks the critical parts of the system and responds appropriately to health probes.</span></span>
  * <span data-ttu-id="fa7b3-155">[Azure 流量管理員][traffic-manager]和 [Azure Load Balancer][load-balancer] 的健康情況探查可提供特定功能。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-155">The health probes for [Azure Traffic Manager][traffic-manager] and [Azure Load Balancer][load-balancer] serve a specific function.</span></span> <span data-ttu-id="fa7b3-156">流量管理員的健康情況探查可決定是否要容錯移轉到另一個區域。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-156">For Traffic Manager, the health probe determines whether to fail over to another region.</span></span> <span data-ttu-id="fa7b3-157">負載平衡器的健康情況探查則可決定是否要從循環中移除 VM。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-157">For a load balancer, it determines whether to remove a VM from rotation.</span></span>      
  * <span data-ttu-id="fa7b3-158">對於流量管理員探查，您的健康情況端點應該檢查在相同區域中部署的任何重要相依性，而其失敗應會觸發容錯移轉至另一個區域。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-158">For a Traffic Manager probe, your health endpoint should check any critical dependencies that are deployed within the same region, and whose failure should trigger a failover to another region.</span></span>  
  * <span data-ttu-id="fa7b3-159">對於負載平衡器，健康情況端點應會報告 VM 的健康情況。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-159">For a load balancer, the health endpoint should report the health of the VM.</span></span> <span data-ttu-id="fa7b3-160">不包含其他層或外部服務。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-160">Don't include other tiers or external services.</span></span> <span data-ttu-id="fa7b3-161">否則，在 VM 外部發生的失敗，可能會導致負載平衡器從循環中移除 VM。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-161">Otherwise, a failure that occurs outside the VM will cause the load balancer to remove the VM from rotation.</span></span>
  * <span data-ttu-id="fa7b3-162">如需在應用程式中實作健康情況監視的指引，請參閱[健康情況端點監視模式](https://msdn.microsoft.com/library/dn589789.aspx)。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-162">For guidance on implementing health monitoring in your application, see [Health Endpoint Monitoring Pattern](https://msdn.microsoft.com/library/dn589789.aspx).</span></span>
* <span data-ttu-id="fa7b3-163">**監視第三方服務。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-163">**Monitor third-party services.**</span></span> <span data-ttu-id="fa7b3-164">如果您的應用程式具有第三方服務相依性，請找出這些第三方服務可能會失敗的位置和方式，以及這些失敗會對您的應用程式造成何種影響。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-164">If your application has dependencies on third-party services, identify where and how these third-party services can fail and what effect those failures will have on your application.</span></span> <span data-ttu-id="fa7b3-165">第三方服務可能不包含監視與診斷，因此務必記錄您引動它們的過程，並使用唯一識別碼使其與您應用程式的健康情況和診斷記錄相互關聯。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-165">A third-party service may not include monitoring and diagnostics, so it's important to log your invocations of them and correlate them with your application's health and diagnostic logging using a unique identifier.</span></span> <span data-ttu-id="fa7b3-166">如需監視和診斷的可行作法詳細資訊，請參閱[監視和診斷指引][monitoring-and-diagnostics-guidance]。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-166">For more information on proven practices for monitoring and diagnostics, see [Monitoring and Diagnostics guidance][monitoring-and-diagnostics-guidance].</span></span>
* <span data-ttu-id="fa7b3-167">**確定您使用的任何第三方服務均提供 SLA。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-167">**Ensure that any third-party service you consume provides an SLA.**</span></span> <span data-ttu-id="fa7b3-168">如果您的應用程式相依於第三方服務，但第三方並未提供 SLA 形式的可用性保證，則也無法保證應用程式的可用性。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-168">If your application depends on a third-party service, but the third party provides no guarantee of availability in the form of an SLA, your application's availability also cannot be guaranteed.</span></span> <span data-ttu-id="fa7b3-169">您的 SLA 無異於您的應用程式最不常使用的元件。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-169">Your SLA is only as good as the least available component of your application.</span></span>
* <span data-ttu-id="fa7b3-170">**在適當情況下對遠端作業實作復原模式。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-170">**Implement resiliency patterns for remote operations where appropriate.**</span></span> <span data-ttu-id="fa7b3-171">如果您的應用程式相依於遠端服務之間的通訊，請遵循設計模式來處理暫時性失敗，例如[重試模式][retry-pattern]和[斷路器模式][circuit-breaker]。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-171">If your application depends on communication between remote services, follow design patterns for dealing with transient failures, such as [Retry Pattern][retry-pattern], and [Circuit Breaker Pattern][circuit-breaker].</span></span> <span data-ttu-id="fa7b3-172">如需詳細資訊，請參閱[復原策略](../resiliency/index.md#resiliency-strategies)。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-172">For more information, see [Resiliency strategies](../resiliency/index.md#resiliency-strategies).</span></span>
* <span data-ttu-id="fa7b3-173">**可能的話，請實作非同步作業。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-173">**Implement asynchronous operations whenever possible.**</span></span> <span data-ttu-id="fa7b3-174">同步作業會獨佔資源，而且在呼叫端等候程序完成時，封鎖其他作業。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-174">Synchronous operations can monopolize resources and block other operations while the caller waits for the process to complete.</span></span> <span data-ttu-id="fa7b3-175">將您應用程式的每個組件設計成儘可能允許非同步作業。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-175">Design each part of your application to allow for asynchronous operations whenever possible.</span></span> <span data-ttu-id="fa7b3-176">如需有關如何以 C# 實作非同步程式設計的詳細資訊，請參閱[使用 async 和 await 進行非同步程式設計][asynchronous-c-sharp]。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-176">For more information on how to implement asynchronous programming in C#, see [Asynchronous Programming with async and await][asynchronous-c-sharp].</span></span>

## <a name="data-management"></a><span data-ttu-id="fa7b3-177">資料管理</span><span class="sxs-lookup"><span data-stu-id="fa7b3-177">Data management</span></span>
* <span data-ttu-id="fa7b3-178">**了解您的應用程式資料來源的複寫方法。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-178">**Understand the replication methods for your application's data sources.**</span></span> <span data-ttu-id="fa7b3-179">應用程式資料會儲存於不同的資料來源，而且有不同的可用性需求。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-179">Your application data will be stored in different data sources and have different availability requirements.</span></span> <span data-ttu-id="fa7b3-180">評估 Azure 中每種資料儲存體的複寫方法，包括 [Azure 儲存體複寫](/azure/storage/storage-redundancy/)和 [SQL Database 作用中異地複寫](/azure/sql-database/sql-database-geo-replication-overview/)，確保滿足您應用程式的資料需求。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-180">Evaluate the replication methods for each type of data storage in Azure, including [Azure Storage Replication](/azure/storage/storage-redundancy/) and [SQL Database Active Geo-Replication](/azure/sql-database/sql-database-geo-replication-overview/) to ensure that your application's data requirements are satisfied.</span></span>
* <span data-ttu-id="fa7b3-181">**確保所有單一使用者帳戶均無法同時存取生產和備份資料。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-181">**Ensure that no single user account has access to both production and backup data.**</span></span> <span data-ttu-id="fa7b3-182">如果有單一使用者帳戶同時具有寫入生產與備份來源的權限，您的資料備份就會受到危害。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-182">Your data backups are compromised if one single user account has permission to write to both production and backup sources.</span></span> <span data-ttu-id="fa7b3-183">惡意使用者可能會刻意刪除您所有的資料，而一般使用者可能會不小心刪除它。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-183">A malicious user could purposely delete all your data, while a regular user could accidentally delete it.</span></span> <span data-ttu-id="fa7b3-184">將您的應用程式設計成限制每個使用者帳戶的權限，只讓需要寫入權限的使用者具有寫入權限，而且只能寫入生產或備份來源 (但非兩者)。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-184">Design your application to limit the permissions of each user account so that only the users that require write access have write access and it's only to either production or backup, but not both.</span></span>
* <span data-ttu-id="fa7b3-185">**記載您的資料來源容錯移轉和容錯回復程序並加以測試。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-185">**Document your data source fail over and fail back process and test it.**</span></span> <span data-ttu-id="fa7b3-186">在您的資料來源發生災難性失敗的情況下，操作人員必須遵循一組書面指示來容錯移轉至新的資料來源。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-186">In the case where your data source fails catastrophically, a human operator will have to follow a set of documented instructions to fail over to a new data source.</span></span> <span data-ttu-id="fa7b3-187">如果書面步驟有誤，操作人員就無法成功按照步驟來容錯移轉資源。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-187">If the documented steps have errors, an operator will not be able to successfully follow them and fail over the resource.</span></span> <span data-ttu-id="fa7b3-188">定期測試指示步驟，確認遵循這些步驟的操作人員能夠成功地容錯移轉及容錯回復資料來源。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-188">Regularly test the instruction steps to verify that an operator following them is able to successfully fail over and fail back the data source.</span></span>
* <span data-ttu-id="fa7b3-189">**驗證您的資料備份。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-189">**Validate your data backups.**</span></span> <span data-ttu-id="fa7b3-190">執行指令碼來驗證資料完整性、結構描述和查詢，以定期確認您的備份資料如您所預期。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-190">Regularly verify that your backup data is what you expect by running a script to validate data integrity, schema, and queries.</span></span> <span data-ttu-id="fa7b3-191">如果備份不適合用來還原您的資料來源，則具有備份毫無意義。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-191">There's no point having a backup if it's not useful to restore your data sources.</span></span> <span data-ttu-id="fa7b3-192">記錄和報告不一致情形，以便修復備份服務。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-192">Log and report any inconsistencies so the backup service can be repaired.</span></span>
* <span data-ttu-id="fa7b3-193">**請考慮使用異地備援的儲存體帳戶類型。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-193">**Consider using a storage account type that is geo-redundant.**</span></span> <span data-ttu-id="fa7b3-194">儲存於 Azure 儲存體帳戶的資料一律會在本機複寫。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-194">Data stored in an Azure Storage account is always replicated locally.</span></span> <span data-ttu-id="fa7b3-195">不過，佈建儲存體帳戶時，有多個複寫策略可供選擇。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-195">However, there are multiple replication strategies to choose from when a Storage Account is provisioned.</span></span> <span data-ttu-id="fa7b3-196">選取 [Azure 讀取權限異地備援儲存體 (RA-GRS)](/azure/storage/storage-redundancy/#read-access-geo-redundant-storage)來保護您的應用程式資料，以免遭遇整個區域無法使用的罕見情況。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-196">Select [Azure Read-Access Geo Redundant Storage (RA-GRS)](/azure/storage/storage-redundancy/#read-access-geo-redundant-storage) to protect your application data against the rare case when an entire region becomes unavailable.</span></span>

  > [!NOTE]
  > <span data-ttu-id="fa7b3-197">若為 VM，請勿依賴 RA-GRS 複寫來還原 VM 磁碟 (VHD 檔案)。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-197">For VMs, do not rely on RA-GRS replication to restore the VM disks (VHD files).</span></span> <span data-ttu-id="fa7b3-198">請改用 [Azure 備份][azure-backup]。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-198">Instead, use [Azure Backup][azure-backup].</span></span>   
  >
  >

## <a name="security"></a><span data-ttu-id="fa7b3-199">安全性</span><span class="sxs-lookup"><span data-stu-id="fa7b3-199">Security</span></span>
* <span data-ttu-id="fa7b3-200">**實作應用程式層級的防護來抵禦分散式阻斷服務 (DDoS) 攻擊。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-200">**Implement application-level protection against distributed denial of service (DDoS) attacks.**</span></span> <span data-ttu-id="fa7b3-201">Azure 服務會受到保護以免遭受網路層 DDos 攻擊。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-201">Azure services are protected against DDos attacks at the network layer.</span></span> <span data-ttu-id="fa7b3-202">不過，Azure 無法抵禦應用程式層攻擊，因為很難區分真正的使用者要求與惡意使用者要求。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-202">However, Azure cannot protect against application-layer attacks, because it is difficult to distinguish between true user requests from malicious user requests.</span></span> <span data-ttu-id="fa7b3-203">如需有關如何抵禦應用程式層 DDoS 攻擊的詳細資訊，請參閱 [Microsoft Azure 網路安全性](http://download.microsoft.com/download/C/A/3/CA3FC5C0-ECE0-4F87-BF4B-D74064A00846/AzureNetworkSecurity_v3_Feb2015.pdf)的「抵禦 DDoS」一節 (PDF 下載)。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-203">For more information on how to protect against application-layer DDoS attacks, see the "Protecting against DDoS" section of [Microsoft Azure Network Security](http://download.microsoft.com/download/C/A/3/CA3FC5C0-ECE0-4F87-BF4B-D74064A00846/AzureNetworkSecurity_v3_Feb2015.pdf) (PDF download).</span></span>
* <span data-ttu-id="fa7b3-204">**對應用程式的資源存取實作最低權限原則。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-204">**Implement the principle of least privilege for access to the application's resources.**</span></span> <span data-ttu-id="fa7b3-205">應用程式資源的預設存取權應儘可能受限制。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-205">The default for access to the application's resources should be as restrictive as possible.</span></span> <span data-ttu-id="fa7b3-206">在核准時授與較高層級的權限。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-206">Grant higher level permissions on an approval basis.</span></span> <span data-ttu-id="fa7b3-207">依預設，授與過度寬鬆的應用程式資源權限可能會導致其他人刻意或意外地刪除資源。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-207">Granting overly permissive access to your application's resources by default can result in someone purposely or accidentally deleting resources.</span></span> <span data-ttu-id="fa7b3-208">Azure 提供[角色型存取控制](/azure/active-directory/role-based-access-built-in-roles/)來管理使用者權限，但務必針對擁有自備權限系統的其他資源 (例如 SQL Server ) 確認其最低權限。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-208">Azure provides [role-based access control](/azure/active-directory/role-based-access-built-in-roles/) to manage user privileges, but it's important to verify least privilege permissions for other resources that have their own permissions systems such as SQL Server.</span></span>

## <a name="testing"></a><span data-ttu-id="fa7b3-209">測試</span><span class="sxs-lookup"><span data-stu-id="fa7b3-209">Testing</span></span>
* <span data-ttu-id="fa7b3-210">**對您的應用程式執行容錯移轉和容錯回復測試。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-210">**Perform failover and failback testing for your application.**</span></span> <span data-ttu-id="fa7b3-211">如果您尚未完整測試容錯移轉和容錯回復，您就無法確定應用程式中的相依服務會在災害復原期間以同步處理方式進行備份。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-211">If you haven't fully tested failover and failback, you can't be certain that the dependent services in your application come back up in a synchronized manner during disaster recovery.</span></span> <span data-ttu-id="fa7b3-212">確保您應用程式的相依服務以正確的順序容錯移轉及容錯回復。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-212">Ensure that your application's dependent services failover and fail back in the correct order.</span></span>
* <span data-ttu-id="fa7b3-213">**對您的應用程式執行錯誤插入測試。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-213">**Perform fault-injection testing for your application.**</span></span> <span data-ttu-id="fa7b3-214">您的應用程式可能會因為許多不同原因而失敗，例如，憑證到期、VM 中的系統資源耗盡，或儲存體失敗。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-214">Your application can fail for many different reasons, such as certificate expiration, exhaustion of system resources in a VM, or storage failures.</span></span> <span data-ttu-id="fa7b3-215">藉由模擬或觸發真正的失敗，在儘可能接近生產的環境中測試您的應用程式。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-215">Test your application in an environment as close as possible to production, by simulating or triggering real failures.</span></span> <span data-ttu-id="fa7b3-216">例如，刪除憑證、以人為方式取用系統資源，或刪除儲存體來源。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-216">For example, delete certificates, artificially consume system resources, or delete a storage source.</span></span> <span data-ttu-id="fa7b3-217">確認您的應用程式能夠從各類型的錯誤 (獨立錯誤和錯誤組合) 中復原。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-217">Verify your application's ability to recover from all types of faults, alone and in combination.</span></span> <span data-ttu-id="fa7b3-218">檢查失敗並未在您的系統中傳播或串聯。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-218">Check that failures are not propagating or cascading through your system.</span></span>
* <span data-ttu-id="fa7b3-219">**同時使用綜合與真實的使用者資料在生產環境中執行測試。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-219">**Run tests in production using both synthetic and real user data.**</span></span> <span data-ttu-id="fa7b3-220">測試與生產環境很少完全相同，因此務必使用藍色/綠色或淡黃色部署，並在生產環境中測試您的應用程式。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-220">Test and production are rarely identical, so it's important to use blue/green or a canary deployment and test your application in production.</span></span> <span data-ttu-id="fa7b3-221">這可讓您在實際負載下的生產環境中測試您的應用程式，並確保它在完整部署的情況下如預期般運作。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-221">This allows you to test your application in production under real load and ensure it will function as expected when fully deployed.</span></span>

## <a name="deployment"></a><span data-ttu-id="fa7b3-222">部署</span><span class="sxs-lookup"><span data-stu-id="fa7b3-222">Deployment</span></span>
* <span data-ttu-id="fa7b3-223">**記載您的應用程式發行程序。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-223">**Document the release process for your application.**</span></span> <span data-ttu-id="fa7b3-224">若未記載詳細的發行程序，操作人員可能會部署不正確的更新，或不正確地設定您的應用程式設定。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-224">Without detailed release process documentation, an operator might deploy a bad update or improperly configure settings for your application.</span></span> <span data-ttu-id="fa7b3-225">明確定義和記載您的發行程序，並確保它可供整個營運小組使用。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-225">Clearly define and document your release process, and ensure that it's available to the entire operations team.</span></span> 
* <span data-ttu-id="fa7b3-226">**自動執行應用程式的部署程序。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-226">**Automate your application's deployment process.**</span></span> <span data-ttu-id="fa7b3-227">如果操作人員必須以手動方式部署您的應用程式，人為錯誤可能會導致部署失敗。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-227">If your operations staff is required to manually deploy your application, human error can cause the deployment to fail.</span></span> 
* <span data-ttu-id="fa7b3-228">**設計您的發行程序，以將應用程式的可用性最大化。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-228">**Design your release process to maximize application availability.**</span></span> <span data-ttu-id="fa7b3-229">如果您的發行程序要求服務在部署期間離線，您的應用程式將無法使用，直到它們重新上線為止。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-229">If your release process requires services to go offline during deployment, your application will be unavailable until they come back online.</span></span> <span data-ttu-id="fa7b3-230">使用[藍色/綠色](http://martinfowler.com/bliki/BlueGreenDeployment.html)或[淡黃色](http://martinfowler.com/bliki/CanaryRelease.html)部署技術，將應用程式部署到生產環境。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-230">Use the [blue/green](http://martinfowler.com/bliki/BlueGreenDeployment.html) or [canary release](http://martinfowler.com/bliki/CanaryRelease.html) deployment technique to deploy your application to production.</span></span> <span data-ttu-id="fa7b3-231">這兩種技術都牽涉到隨著生產程式碼部署您的發行程式碼，讓發行程式碼的使用者可以在失敗時重新導向至生產程式碼。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-231">Both of these techniques involve deploying your release code alongside production code so users of release code can be redirected to production code in the event of a failure.</span></span>
* <span data-ttu-id="fa7b3-232">**記錄和稽核應用程式的部署。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-232">**Log and audit your application's deployments.**</span></span> <span data-ttu-id="fa7b3-233">如果您使用分段部署技術 (例如藍色/綠色或淡黃色版本)，您的應用程式會有一個以上的版本在生產環境中執行。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-233">If you use staged deployment techniques such as blue/green or canary releases there will be more than one version of your application running in production.</span></span> <span data-ttu-id="fa7b3-234">如果發生問題，請務必判斷哪一個應用程式版本造成問題。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-234">If a problem should occur, it's critical to determine which version of your application is causing a problem.</span></span> <span data-ttu-id="fa7b3-235">實作強固的記錄策略，儘可能擷取較多的版本特有資訊。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-235">Implement a robust logging strategy to capture as much version-specific information as possible.</span></span>
* <span data-ttu-id="fa7b3-236">**具備部署回復計劃。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-236">**Have a rollback plan for deployment.**</span></span> <span data-ttu-id="fa7b3-237">您的應用程式部署可能會失敗，並導致您的應用程式無法使用。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-237">It's possible that your application deployment could fail and cause your application to become unavailable.</span></span> <span data-ttu-id="fa7b3-238">設計回復程序，以回到上一個已知良好的版本並將停機時間縮到最短。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-238">Design a rollback process to go back to a last known good version and minimize downtime.</span></span> 

## <a name="operations"></a><span data-ttu-id="fa7b3-239">作業</span><span class="sxs-lookup"><span data-stu-id="fa7b3-239">Operations</span></span>
* <span data-ttu-id="fa7b3-240">**在您的應用程式中實作監視和警示的最佳做法。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-240">**Implement best practices for monitoring and alerting in your application.**</span></span> <span data-ttu-id="fa7b3-241">若沒有適當的監視、診斷和警示，便無法在您的應用程式中偵測失敗並警示操作人員進行修正。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-241">Without proper monitoring, diagnostics, and alerting, there is no way to detect failures in your application and alert an operator to fix them.</span></span> <span data-ttu-id="fa7b3-242">如需詳細資訊，請參閱[監視和診斷指引][monitoring-and-diagnostics-guidance]。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-242">For more information, see [Monitoring and Diagnostics guidance][monitoring-and-diagnostics-guidance].</span></span>
* <span data-ttu-id="fa7b3-243">**測量遠端呼叫統計資料，並將資訊提供給應用程式小組使用。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-243">**Measure remote call statistics and make the information available to the application team.**</span></span>  <span data-ttu-id="fa7b3-244">如果您未即時追蹤及報告遠端呼叫統計資料，以及提供簡單的方法來檢閱此資訊，營運小組就無法即時檢視您應用程式的健康情況。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-244">If you don't track and report remote call statistics in real time and provide an easy way to review this information, the operations team will not have an instantaneous view into the health of your application.</span></span> <span data-ttu-id="fa7b3-245">而如果您只測量平均遠端呼叫時間，您就沒有足夠的資訊可揭露服務的問題。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-245">And if you only measure average remote call time, you will not have enough information to reveal issues in the services.</span></span> <span data-ttu-id="fa7b3-246">摘要說明遠端呼叫計量，例如延遲、輸送量，以及 99 和 95 百分位數的錯誤。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-246">Summarize remote call metrics such as latency, throughput, and errors in the 99 and 95 percentiles.</span></span> <span data-ttu-id="fa7b3-247">對計量執行統計分析，以發現在每個百分位數內發生的錯誤。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-247">Perform statistical analysis on the metrics to uncover errors that occur within each percentile.</span></span>
* <span data-ttu-id="fa7b3-248">**追蹤一段適當時間範圍內的暫時性例外狀況和重試數目。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-248">**Track the number of transient exceptions and retries over an appropriate timeframe.**</span></span> <span data-ttu-id="fa7b3-249">如果您未追蹤及監視一段時間的暫時性例外狀況和重試數目，則應用程式的重試邏輯可能會隱藏問題或失敗。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-249">If you don't track and monitor transient exceptions and retry attempts over time, it's possible that an issue or failure could be hidden by your application's retry logic.</span></span> <span data-ttu-id="fa7b3-250">也就是說，如果您的監視和記錄作業只顯示作業的成功或失敗，將會隱藏作業因為例外狀況而重試數次的這個事實。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-250">That is, if your monitoring and logging only shows success or failure of an operation, the fact that the operation had to be retried multiple times due to exceptions will be hidden.</span></span> <span data-ttu-id="fa7b3-251">例外狀況隨著時間遞增的趨勢，表示服務有問題而且可能失敗。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-251">A trend of increasing exceptions over time indicates that the service is having an issue and may fail.</span></span> <span data-ttu-id="fa7b3-252">如需詳細資訊，請參閱[重試服務的特定指引][retry-service-guidance]。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-252">For more information, see [Retry service specific guidance][retry-service-guidance].</span></span>
* <span data-ttu-id="fa7b3-253">**實作可警示操作人員的早期警告系統。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-253">**Implement an early warning system that alerts an operator.**</span></span> <span data-ttu-id="fa7b3-254">找出應用程式健康情況的關鍵效能指標 (例如暫時性例外狀況和遠端呼叫延遲)，並且為每個指標設定適當的臨界值。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-254">Identify the key performance indicators of your application's health, such as transient exceptions and remote call latency, and set appropriate threshold values for each of them.</span></span> <span data-ttu-id="fa7b3-255">達到臨界值時，傳送警示給營運小組。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-255">Send an alert to operations when the threshold value is reached.</span></span> <span data-ttu-id="fa7b3-256">在問題變嚴重並需要復原回應之前，在可識別問題的層級設定這些臨界值。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-256">Set these thresholds at levels that identify issues before they become critical and require a recovery response.</span></span>
* <span data-ttu-id="fa7b3-257">**確保小組中有一個以上的人員經過訓練，可監視應用程式並執行任何手動復原步驟。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-257">**Ensure that more than one person on the team is trained to monitor the application and perform any manual recovery steps.**</span></span> <span data-ttu-id="fa7b3-258">如果小組中只有一個操作人員可以監視應用程式和開始進行復原步驟，則該人員會成為單一失敗點。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-258">If you only have a single operator on the team who can monitor the application and kick off recovery steps, that person becomes a single point of failure.</span></span> <span data-ttu-id="fa7b3-259">訓練多個人進行偵測和復原，並確保隨時都有至少一個值勤的人員。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-259">Train multiple individuals on detection and recovery and make sure there is always at least one active at any time.</span></span>
* <span data-ttu-id="fa7b3-260">**確保您的應用程式不會遭遇 [Azure 訂用帳戶限制](/azure/azure-subscription-service-limits/)。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-260">**Ensure that your application does not run up against [Azure subscription limits](/azure/azure-subscription-service-limits/).**</span></span> <span data-ttu-id="fa7b3-261">Azure 訂用帳戶對某些資源類型有所限制，例如資源群組數目、核心數目，以及儲存體帳戶數目。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-261">Azure subscriptions have limits on certain resource types, such as number of resource groups, number of cores, and number of storage accounts.</span></span>  <span data-ttu-id="fa7b3-262">如果應用程式需求超過 Azure 訂用帳戶限制，請建立另一個 Azure 訂用帳戶並在其中佈建足夠的資源。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-262">If your application requirements exceed Azure subscription limits, create another Azure subscription and provision sufficient resources there.</span></span>
* <span data-ttu-id="fa7b3-263">**確保您的應用程式不會遭遇[各項服務限制](/azure/azure-subscription-service-limits/)。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-263">**Ensure that your application does not run up against [per-service limits](/azure/azure-subscription-service-limits/).**</span></span> <span data-ttu-id="fa7b3-264">個別的 Azure 服務都有取用量限制&mdash;，例如儲存體、輸送量、連線數目、每秒要求數和其他計量的限制。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-264">Individual Azure services have consumption limits &mdash; for example, limits on storage, throughput, number of connections, requests per second, and other metrics.</span></span> <span data-ttu-id="fa7b3-265">如果應用程式嘗試使用超出這些限制的資源，應用程式就會失敗。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-265">Your application will fail if it attempts to use resources beyond these limits.</span></span> <span data-ttu-id="fa7b3-266">這會導致受影響的使用者發生服務節流和可能停機。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-266">This will result in service throttling and possible downtime for affected users.</span></span> <span data-ttu-id="fa7b3-267">視特定服務和您的應用程式需求而定，您通常可藉由相應增加 (例如，選擇另一個定價層) 或相應放大 (新增執行個體) 來避開這些限制。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-267">Depending on the specific service and your application requirements, you can often avoid these limits by scaling up (for example, choosing another pricing tier) or scaling out (adding new instances).</span></span>  
* <span data-ttu-id="fa7b3-268">**設計您應用程式的儲存體需求，使其落在 Azure 儲存體延展性和效能目標內。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-268">**Design your application's storage requirements to fall within Azure storage scalability and performance targets.**</span></span> <span data-ttu-id="fa7b3-269">Azure 儲存體已設計成要在預先定義的延展性和效能目標內運作，所以將您的應用程式設計成利用這些目標內的儲存體。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-269">Azure storage is designed to function within predefined scalability and performance targets, so design your application to utilize storage within those targets.</span></span> <span data-ttu-id="fa7b3-270">如果您超過這些目標，應用程式將會遇到儲存體節流。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-270">If you exceed these targets your application will experience storage throttling.</span></span> <span data-ttu-id="fa7b3-271">若要修正此問題，請佈建額外的儲存體帳戶。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-271">To fix this, provision additional Storage Accounts.</span></span> <span data-ttu-id="fa7b3-272">如果您遭遇儲存體帳戶限制，請佈建額外的 Azure 訂用帳戶，然後在其中佈建額外的儲存體帳戶。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-272">If you run up against the Storage Account limit, provision additional Azure Subscriptions and then provision additional Storage Accounts there.</span></span> <span data-ttu-id="fa7b3-273">如需詳細資訊，請參閱 [Azure 儲存體延展性和效能目標](/azure/storage/storage-scalability-targets/)。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-273">For more information, see [Azure Storage Scalability and Performance Targets](/azure/storage/storage-scalability-targets/).</span></span>
* <span data-ttu-id="fa7b3-274">**為您的應用程式選取適當的 VM 大小。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-274">**Select the right VM size for your application.**</span></span> <span data-ttu-id="fa7b3-275">測量生產環境中的 VM 的實際 CPU、記憶體、磁碟和 I/O，並確認您所選取的 VM 大小夠大。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-275">Measure the actual CPU, memory, disk, and I/O of your VMs in production and verify that the VM size you've selected is sufficient.</span></span> <span data-ttu-id="fa7b3-276">如果未這麼做，您的應用程式可能會在 VM 接近其限制時遇到容量問題。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-276">If not, your application may experience capacity issues as the VMs approach their limits.</span></span> <span data-ttu-id="fa7b3-277">[Azure 中的虛擬機器大小](/azure/virtual-machines/virtual-machines-windows-sizes/?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json)會詳細說明 VM 大小。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-277">VM sizes are described in detail in [Sizes for virtual machines in Azure](/azure/virtual-machines/virtual-machines-windows-sizes/?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).</span></span>
* <span data-ttu-id="fa7b3-278">**判斷您的應用程式在一段時間內的工作負載是穩定還是波動。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-278">**Determine if your application's workload is stable or fluctuating over time.**</span></span> <span data-ttu-id="fa7b3-279">如果您的工作負載隨著波動，請使用 Azure VM 擴展集來自動調整 VM 執行個體的數目。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-279">If your workload fluctuates over time, use Azure VM scale sets to automatically scale the number of VM instances.</span></span> <span data-ttu-id="fa7b3-280">否則，您將必須以手動方式增加或減少 VM 數目。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-280">Otherwise, you will have to manually increase or decrease the number of VMs.</span></span> <span data-ttu-id="fa7b3-281">如需詳細資訊，請參閱[虛擬機器擴展集概觀](/azure/virtual-machine-scale-sets/virtual-machine-scale-sets-overview/)。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-281">For more information, see the [Virtual Machine Scale Sets Overview](/azure/virtual-machine-scale-sets/virtual-machine-scale-sets-overview/).</span></span>
* <span data-ttu-id="fa7b3-282">**選取 Azure SQL Database 適用的服務層。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-282">**Select the right service tier for Azure SQL Database.**</span></span> <span data-ttu-id="fa7b3-283">如果您的應用程式使用 Azure SQL Database，請確定您已選取適當的服務層。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-283">If your application uses Azure SQL Database, ensure that you have selected the appropriate service tier.</span></span> <span data-ttu-id="fa7b3-284">如果您選取的服務層無法處理您應用程式的資料庫交易單位 (DTU) 需求，您的資料使用將會進行節流。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-284">If you select a tier that is not able to handle your application's database transaction unit (DTU) requirements, your data use will be throttled.</span></span> <span data-ttu-id="fa7b3-285">如需選取正確服務方案的詳細資訊，請參閱 [SQL Database 選項和效能：了解每個服務層中可用的項目](/azure/sql-database/sql-database-service-tiers/)。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-285">For more information on selecting the correct service plan, see [SQL Database options and performance: Understand what's available in each service tier](/azure/sql-database/sql-database-service-tiers/).</span></span>
* <span data-ttu-id="fa7b3-286">**建立可與 Azure 支援服務互動的程序。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-286">**Create a process for interacting with Azure support.**</span></span> <span data-ttu-id="fa7b3-287">如果在連絡支援服務的需求產生之前，並未設定連絡 [Azure 支援服務](https://azure.microsoft.com/support/plans/)的程序，則停機時間將會因為第一次瀏覽支援程序而延長。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-287">If the process for contacting [Azure support](https://azure.microsoft.com/support/plans/) is not set before the need to contact support arises, downtime will be prolonged as the support process is navigated for the first time.</span></span> <span data-ttu-id="fa7b3-288">一開始就將連絡支援服務並向上呈報問題的程序納入應用程式的復原能力中。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-288">Include the process for contacting support and escalating issues as part of your application's resiliency from the outset.</span></span>
* <span data-ttu-id="fa7b3-289">**確保您的應用程式不會使用超過每一訂用帳戶的儲存體帳戶數目上限。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-289">**Ensure that your application doesn't use more than the maximum number of storage accounts per subscription.**</span></span> <span data-ttu-id="fa7b3-290">Azure 允許每一訂用帳戶最多可有 200 個儲存體帳戶。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-290">Azure allows a maximum of 200 storage accounts per subscription.</span></span> <span data-ttu-id="fa7b3-291">如果您的應用程式需要的儲存體帳戶超過您的訂用帳戶中目前可用的儲存體帳戶，您必須建立新的訂用帳戶並在其中建立額外的儲存體帳戶。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-291">If your application requires more storage accounts than are currently available in your subscription, you will have to create a new subscription and create additional storage accounts there.</span></span> <span data-ttu-id="fa7b3-292">如需詳細資訊，請參閱 [Azure 訂用帳戶和服務限制、配額與條件約束](/azure/azure-subscription-service-limits/#storage-limits)。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-292">For more information, see [Azure subscription and service limits, quotas, and constraints](/azure/azure-subscription-service-limits/#storage-limits).</span></span>
* <span data-ttu-id="fa7b3-293">**確保您的應用程式未超過虛擬機器磁碟的延展性目標。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-293">**Ensure that your application doesn't exceed the scalability targets for virtual machine disks.**</span></span> <span data-ttu-id="fa7b3-294">Azure IaaS VM 支援根據數個因子 (包括 VM 大小和儲存體帳戶類型) 來連結多個資料磁碟。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-294">An Azure IaaS VM supports attaching a number of data disks depending on several factors, including the VM size and type of storage account.</span></span> <span data-ttu-id="fa7b3-295">如果您的應用程式超過虛擬機器磁碟的延展性目標，請佈建額外的儲存體帳戶並在其中建立虛擬機器磁碟。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-295">If your application exceeds the scalability targets for virtual machine disks, provision additional storage accounts and create the virtual machine disks there.</span></span> <span data-ttu-id="fa7b3-296">如需詳細資訊，請參閱 [Azure 儲存體延展性和效能目標](/azure/storage/storage-scalability-targets/#scalability-targets-for-virtual-machine-disks)</span><span class="sxs-lookup"><span data-stu-id="fa7b3-296">For more information, see [Azure Storage Scalability and Performance Targets](/azure/storage/storage-scalability-targets/#scalability-targets-for-virtual-machine-disks)</span></span>

## <a name="telemetry"></a><span data-ttu-id="fa7b3-297">遙測</span><span class="sxs-lookup"><span data-stu-id="fa7b3-297">Telemetry</span></span>
* <span data-ttu-id="fa7b3-298">**當應用程式在生產環境中執行時，請記錄遙測資料。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-298">**Log telemetry data while the application is running in the production environment.**</span></span> <span data-ttu-id="fa7b3-299">當應用程式在生產環境中執行，或它正在服務使用者時，如果您沒有足夠的資訊可診斷問題的原因，請擷取強固的遙測資訊。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-299">Capture robust telemetry information while the application is running in the production environment or you will not have sufficient information to diagnose the cause of issues while it's actively serving users.</span></span> <span data-ttu-id="fa7b3-300">如需詳細資訊，請參閱[監視和診斷][monitoring-and-diagnostics-guidance]。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-300">For more information, see [Monitoring and Diagnostics][monitoring-and-diagnostics-guidance].</span></span>
* <span data-ttu-id="fa7b3-301">**使用非同步模式實作記錄作業。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-301">**Implement logging using an asynchronous pattern.**</span></span> <span data-ttu-id="fa7b3-302">如果記錄作業是同步的，它們可能會封鎖您的應用程式程式碼。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-302">If logging operations are synchronous, they might block your application code.</span></span> <span data-ttu-id="fa7b3-303">確保您的記錄作業是以非同步作業的形式實作。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-303">Ensure that your logging operations are implemented as asynchronous operations.</span></span>
* <span data-ttu-id="fa7b3-304">**讓不同服務界限的記錄資料相互關聯。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-304">**Correlate log data across service boundaries.**</span></span> <span data-ttu-id="fa7b3-305">在典型的多層式架構 (N-Tier) 應用程式中，使用者要求可能會跨越數個服務界限。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-305">In a typical n-tier application, a user request may traverse several service boundaries.</span></span> <span data-ttu-id="fa7b3-306">例如，使用者要求通常源自 Web 層，而後傳遞至商業層，最後保存在資料層中。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-306">For example, a user request typically originates in the web tier and is passed to the business tier and finally persisted in the data tier.</span></span> <span data-ttu-id="fa7b3-307">在更複雜的情況下，使用者要求可能會分散於許多不同的服務和資料存放區。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-307">In more complex scenarios, a user request may be distributed to many different services and data stores.</span></span> <span data-ttu-id="fa7b3-308">確保您的記錄系統可讓不同服務界限的呼叫相互關聯，以便您在整個應用程式中追蹤要求。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-308">Ensure that your logging system correlates calls across service boundaries so you can track the request throughout your application.</span></span>

## <a name="azure-resources"></a><span data-ttu-id="fa7b3-309">Azure 資源</span><span class="sxs-lookup"><span data-stu-id="fa7b3-309">Azure Resources</span></span>
* <span data-ttu-id="fa7b3-310">**使用 Azure Resource Manager 範本來佈建資源。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-310">**Use Azure Resource Manager templates to provision resources.**</span></span> <span data-ttu-id="fa7b3-311">Resource Manager 範本可讓您輕鬆地透過 PowerShell 或 Azure CLI 自動進行部署，因而產生更可靠的部署程序。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-311">Resource Manager templates make it easier to automate deployments via PowerShell or the Azure CLI, which leads to a more reliable deployment process.</span></span> <span data-ttu-id="fa7b3-312">如需詳細資訊，請參閱 [Azure Resource Manager概觀][resource-manager]。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-312">For more information, see [Azure Resource Manager overview][resource-manager].</span></span>
* <span data-ttu-id="fa7b3-313">**為資源提供有意義的名稱。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-313">**Give resources meaningful names.**</span></span> <span data-ttu-id="fa7b3-314">為資源提供有意義的名稱，能更容易找到特定資源及了解其角色。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-314">Giving resources meaningful names makes it easier to locate a specific resource and understand its role.</span></span> <span data-ttu-id="fa7b3-315">如需詳細資訊，請參閱 [Azure 資源的命名慣例](../best-practices/naming-conventions.md)</span><span class="sxs-lookup"><span data-stu-id="fa7b3-315">For more information, see [Naming conventions for Azure resources](../best-practices/naming-conventions.md)</span></span>
* <span data-ttu-id="fa7b3-316">**使用角色型存取控制 (RBAC)。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-316">**Use role-based access control (RBAC).**</span></span> <span data-ttu-id="fa7b3-317">使用 RBAC 來控制您所部署之 Azure 資源的存取權。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-317">Use RBAC to control access to the Azure resources that you deploy.</span></span> <span data-ttu-id="fa7b3-318">RBAC 可讓您指派授權角色給您 DevOps 小組的成員，以免不小心刪除或變更已部署的資源。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-318">RBAC lets you assign authorization roles to members of your DevOps team, to prevent accidental deletion or changes to deployed resources.</span></span> <span data-ttu-id="fa7b3-319">如需詳細資訊，請參閱[開始使用 Azure 入口網站中的存取管理](/azure/active-directory/role-based-access-control-what-is/)</span><span class="sxs-lookup"><span data-stu-id="fa7b3-319">For more information, see [Get started with access management in the Azure portal](/azure/active-directory/role-based-access-control-what-is/)</span></span>
* <span data-ttu-id="fa7b3-320">**使用重要資源 (例如 VM) 的資源鎖定。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-320">**Use resource locks for critical resources, such as VMs.**</span></span> <span data-ttu-id="fa7b3-321">資源鎖定可防止操作人員不小心刪除資源。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-321">Resource locks prevent an operator from accidentally deleting a resource.</span></span> <span data-ttu-id="fa7b3-322">如需詳細資訊，請參閱[使用 Azure Resource Manager 來鎖定資源](/azure/azure-resource-manager/resource-group-lock-resources/)</span><span class="sxs-lookup"><span data-stu-id="fa7b3-322">For more information, see [Lock resources with Azure Resource Manager](/azure/azure-resource-manager/resource-group-lock-resources/)</span></span>
* <span data-ttu-id="fa7b3-323">**選擇區域配對。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-323">**Choose regional pairs.**</span></span> <span data-ttu-id="fa7b3-324">部署至兩個區域時，請選擇相同區域配對中的區域。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-324">When deploying to two regions, choose regions from the same regional pair.</span></span> <span data-ttu-id="fa7b3-325">若發生廣泛中斷事件，會優先復原所有配對中的一個區域。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-325">In the event of a broad outage, recovery of one region is prioritized out of every pair.</span></span> <span data-ttu-id="fa7b3-326">有些服務 (異地備援儲存體) 會提供自動複寫到配對的區域。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-326">Some services such as Geo-Redundant Storage provide automatic replication to the paired region.</span></span> <span data-ttu-id="fa7b3-327">如需詳細資訊，請參閱[商務持續性和災害復原 (BCDR)：Azure 配對的區域](/azure/best-practices-availability-paired-regions)</span><span class="sxs-lookup"><span data-stu-id="fa7b3-327">For more information, see [Business continuity and disaster recovery (BCDR): Azure Paired Regions](/azure/best-practices-availability-paired-regions)</span></span>
* <span data-ttu-id="fa7b3-328">**依照功能和生命週期來組織資源群組。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-328">**Organize resource groups by function and lifecycle.**</span></span>  <span data-ttu-id="fa7b3-329">一般而言，資源群組應包含共用相同生命週期的資源。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-329">In general, a resource group should contain resources that share the same lifecycle.</span></span> <span data-ttu-id="fa7b3-330">這可讓您更輕鬆地管理部署、刪除測試部署，以及指派存取權限，進而降低不小心刪除或修改生產部署的可能性。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-330">This makes it easier to manage deployments, delete test deployments, and assign access rights, reducing the chance that a production deployment is accidentally deleted or modified.</span></span> <span data-ttu-id="fa7b3-331">針對生產、部署和測試環境，各別建立資源群組。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-331">Create separate resource groups for production, development, and test environments.</span></span> <span data-ttu-id="fa7b3-332">在多區域的部署中，將每個區域的資源放入不同的資源群組中。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-332">In a multi-region deployment, put resources for each region into separate resource groups.</span></span> <span data-ttu-id="fa7b3-333">這可讓您更輕鬆地重新部署一個區域，而不會影響其他區域。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-333">This makes it easier to redeploy one region without affecting the other region(s).</span></span>

## <a name="azure-services"></a><span data-ttu-id="fa7b3-334">Azure 服務</span><span class="sxs-lookup"><span data-stu-id="fa7b3-334">Azure Services</span></span>
<span data-ttu-id="fa7b3-335">下列檢查清單項目適用於 Azure 中的特定服務。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-335">The following checklist items apply to specific services in Azure.</span></span>

### <a name="app-service"></a><span data-ttu-id="fa7b3-336">App Service</span><span class="sxs-lookup"><span data-stu-id="fa7b3-336">App Service</span></span>
* <span data-ttu-id="fa7b3-337">**使用標準或進階層。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-337">**Use Standard or Premium tier.**</span></span> <span data-ttu-id="fa7b3-338">這些服務層可支援預備位置和自動化備份。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-338">These tiers support staging slots and automated backups.</span></span> <span data-ttu-id="fa7b3-339">如需詳細資訊，請參閱 [Azure App Service 方案深入概觀](/azure/app-service/azure-web-sites-web-hosting-plans-in-depth-overview/)</span><span class="sxs-lookup"><span data-stu-id="fa7b3-339">For more information, see [Azure App Service plans in-depth overview](/azure/app-service/azure-web-sites-web-hosting-plans-in-depth-overview/)</span></span>
* <span data-ttu-id="fa7b3-340">**避免相應增加或相應減少。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-340">**Avoid scaling up or down.**</span></span> <span data-ttu-id="fa7b3-341">請改為選取在一般負載下符合您效能需求的服務層和執行個體大小，然後[相應放大](/azure/app-service-web/web-sites-scale/)執行個體來處理流量的變更。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-341">Instead, select a tier and instance size that meet your performance requirements under typical load, and then [scale out](/azure/app-service-web/web-sites-scale/) the instances to handle changes in traffic volume.</span></span> <span data-ttu-id="fa7b3-342">相應增加和減少可能會觸發應用程式重新啟動。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-342">Scaling up and down may trigger an application restart.</span></span>  
* <span data-ttu-id="fa7b3-343">**將組態儲存為應用程式設定。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-343">**Store configuration as app settings.**</span></span> <span data-ttu-id="fa7b3-344">使用應用程式設定，將組態設定保留為應用程式設定。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-344">Use app settings to hold configuration settings as app settings.</span></span> <span data-ttu-id="fa7b3-345">在您的 Resource Manager 範本 中或使用 PowerShell 來定義設定，以便您在更可靠的自動化部署 / 更新程序中套用它們。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-345">Define the settings in your Resource Manager templates, or using PowerShell, so that you can apply them as part of an automated deployment / update process, which is more reliable.</span></span> <span data-ttu-id="fa7b3-346">如需詳細資訊，請參閱[在 Azure App Service 中設定 Web 應用程式](/azure/app-service-web/web-sites-configure/)。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-346">For more information, see [Configure web apps in Azure App Service](/azure/app-service-web/web-sites-configure/).</span></span>
* <span data-ttu-id="fa7b3-347">**為生產和測試環境建立不同的 App Service 方案。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-347">**Create separate App Service plans for production and test.**</span></span> <span data-ttu-id="fa7b3-348">請勿使用生產部署上的位置進行測試。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-348">Don't use slots on your production deployment for testing.</span></span>  <span data-ttu-id="fa7b3-349">相同 App Service 方案中的所有應用程式會共用相同的 VM 執行個體。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-349">All apps within the same App Service plan share the same VM instances.</span></span> <span data-ttu-id="fa7b3-350">如果您將生產和測試部署放在相同的方案中，可能會對生產部署造成負面影響。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-350">If you put production and test deployments in the same plan, it can negatively affect the production deployment.</span></span> <span data-ttu-id="fa7b3-351">例如，負載測試可能會使實際作用的生產網站降級。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-351">For example, load tests might degrade the live production site.</span></span> <span data-ttu-id="fa7b3-352">透過將測試部署放在不同方案內，您可以使其與生產版本隔離。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-352">By putting test deployments into a separate plan, you isolate them from the production version.</span></span>  
* <span data-ttu-id="fa7b3-353">**分隔 Web 應用程式與 Web API。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-353">**Separate web apps from web APIs.**</span></span> <span data-ttu-id="fa7b3-354">如果您的解決方案具有 Web 前端與 Web API，請考慮將它們分解成個別的 App Service 應用程式。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-354">If your solution has both a web front-end and a web API, consider decomposing them into separate App Service apps.</span></span> <span data-ttu-id="fa7b3-355">此設計可讓您更輕鬆地依照工作負載來分解解決方案。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-355">This design makes it easier to decompose the solution by workload.</span></span> <span data-ttu-id="fa7b3-356">您可以在個別的 App Service 方案中執行 Web 應用程式與 API，以便獨立調整其規模。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-356">You can run the web app and the API in separate App Service plans, so they can be scaled independently.</span></span> <span data-ttu-id="fa7b3-357">如果您一開始不需要這種程度的延展性，可以將應用程式部署到相同的方案中，之後有需要時再將它們移到別的方案。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-357">If you don't need that level of scalability at first, you can deploy the apps into the same plan, and move them into separate plans later, if needed.</span></span>
* <span data-ttu-id="fa7b3-358">**避免使用 App Service 備份功能來備份 Azure SQL 資料庫。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-358">**Avoid using the App Service backup feature to back up Azure SQL databases.**</span></span> <span data-ttu-id="fa7b3-359">請改用 [SQL Database 自動化備份][sql-backup]。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-359">Instead, use [SQL Database automated backups][sql-backup].</span></span> <span data-ttu-id="fa7b3-360">App Service 備份會將資料庫匯出至 SQL .bacpac 檔案，這會使用 DTU。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-360">App Service backup exports the database to a SQL .bacpac file, which costs DTUs.</span></span>  
* <span data-ttu-id="fa7b3-361">**部署到預備位置。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-361">**Deploy to a staging slot.**</span></span> <span data-ttu-id="fa7b3-362">建立預備的部署位置。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-362">Create a deployment slot for staging.</span></span> <span data-ttu-id="fa7b3-363">將應用程式更新部署到預備位置，並先確認部署，再將它交換至生產環境。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-363">Deploy application updates to the staging slot, and verify the deployment before swapping it into production.</span></span> <span data-ttu-id="fa7b3-364">這可降低生產環境使用不正確更新的可能性。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-364">This reduces the chance of a bad update in production.</span></span> <span data-ttu-id="fa7b3-365">也可確保所有執行個體在交換至生產環境之前就已準備就緒。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-365">It also ensures that all instances are warmed up before being swapped into production.</span></span> <span data-ttu-id="fa7b3-366">許多應用程式都有重要的暖機和冷啟動時間。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-366">Many applications have a significant warmup and cold-start time.</span></span> <span data-ttu-id="fa7b3-367">如需詳細資訊，請參閱[針對 Azure App Service 中的 Web 應用程式設定預備環境](/azure/app-service-web/web-sites-staged-publishing/)。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-367">For more information, see [Set up staging environments for web apps in Azure App Service](/azure/app-service-web/web-sites-staged-publishing/).</span></span>
* <span data-ttu-id="fa7b3-368">**建立部署位置來保存上一個已知良好 (LKG) 的部署。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-368">**Create a deployment slot to hold the last-known-good (LKG) deployment.**</span></span> <span data-ttu-id="fa7b3-369">當您將更新部署到生產環境時，請將先前的生產部署移到 LKG 位置。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-369">When you deploy an update to production, move the previous production deployment into the LKG slot.</span></span> <span data-ttu-id="fa7b3-370">這可讓您更輕鬆地復原錯誤的部署。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-370">This makes it easier to roll back a bad deployment.</span></span> <span data-ttu-id="fa7b3-371">如果您之後發現問題，您可以快速地還原至 LKG 版本。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-371">If you discover a problem later, you can quickly revert to the LKG version.</span></span> <span data-ttu-id="fa7b3-372">如需詳細資訊，請參閱[基本 Web 應用程式](../reference-architectures/app-service-web-app/basic-web-app.md)。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-372">For more information, see [Basic web application](../reference-architectures/app-service-web-app/basic-web-app.md).</span></span>
* <span data-ttu-id="fa7b3-373">**啟用診斷記錄**，包括應用程式記錄和 Web 伺服器記錄。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-373">**Enable diagnostics logging**, including application logging and web server logging.</span></span> <span data-ttu-id="fa7b3-374">記錄作業對監視和診斷而言都很重要。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-374">Logging is important for monitoring and diagnostics.</span></span> <span data-ttu-id="fa7b3-375">請參閱[在 Azure App Service 中針對 Web 應用程式啟用診斷記錄功能](/azure/app-service-web/web-sites-enable-diagnostic-log/)</span><span class="sxs-lookup"><span data-stu-id="fa7b3-375">See [Enable diagnostics logging for web apps in Azure App Service](/azure/app-service-web/web-sites-enable-diagnostic-log/)</span></span>
* <span data-ttu-id="fa7b3-376">**記錄至 Blob 儲存體。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-376">**Log to blob storage.**</span></span> <span data-ttu-id="fa7b3-377">這可讓您更輕鬆地收集和分析資料。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-377">This makes it easier to collect and analyze the data.</span></span>
* <span data-ttu-id="fa7b3-378">**為記錄建立個別的儲存體帳戶。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-378">**Create a separate storage account for logs.**</span></span> <span data-ttu-id="fa7b3-379">記錄和應用程式資料不可使用相同儲存體帳戶。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-379">Don't use the same storage account for logs and application data.</span></span> <span data-ttu-id="fa7b3-380">這有助於防止記錄作業降低應用程式效能。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-380">This helps to prevent logging from reducing application performance.</span></span>
* <span data-ttu-id="fa7b3-381">**監視效能。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-381">**Monitor performance.**</span></span> <span data-ttu-id="fa7b3-382">使用 [New Relic](http://newrelic.com/) 或 [Application Insights](/azure/application-insights/app-insights-overview/) 等效能監視服務，來監視負載下的應用程式效能和行為。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-382">Use a performance monitoring service such as [New Relic](http://newrelic.com/) or [Application Insights](/azure/application-insights/app-insights-overview/) to monitor application performance and behavior under load.</span></span>  <span data-ttu-id="fa7b3-383">效能監視可讓您即時深入解析應用程式。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-383">Performance monitoring gives you real-time insight into the application.</span></span> <span data-ttu-id="fa7b3-384">它可讓您診斷問題並執行失敗的根本原因分析。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-384">It enables you to diagnose issues and perform root-cause analysis of failures.</span></span>

### <a name="application-gateway"></a><span data-ttu-id="fa7b3-385">應用程式閘道</span><span class="sxs-lookup"><span data-stu-id="fa7b3-385">Application Gateway</span></span>
* <span data-ttu-id="fa7b3-386">**佈建至少兩個執行個體。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-386">**Provision at least two instances.**</span></span> <span data-ttu-id="fa7b3-387">部署具有至少兩個執行個體的應用程式閘道。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-387">Deploy Application Gateway with at least two instances.</span></span> <span data-ttu-id="fa7b3-388">單一執行個體為單一失敗點。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-388">A single instance is a single point of failure.</span></span> <span data-ttu-id="fa7b3-389">使用兩個或多個執行個體，可提供備援和延展性。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-389">Use two or more instances for redundancy and scalability.</span></span> <span data-ttu-id="fa7b3-390">為了符合 [SLA](https://azure.microsoft.com/support/legal/sla/application-gateway/v1_0/) 的資格，您必須佈建兩個或更多中型或大型執行個體。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-390">In order to qualify for the [SLA](https://azure.microsoft.com/support/legal/sla/application-gateway/v1_0/), you must provision two or more medium or larger instances.</span></span>

### <a name="azure-search"></a><span data-ttu-id="fa7b3-391">Azure 搜尋服務</span><span class="sxs-lookup"><span data-stu-id="fa7b3-391">Azure Search</span></span>
* <span data-ttu-id="fa7b3-392">**佈建一個以上的複本。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-392">**Provision more than one replica.**</span></span> <span data-ttu-id="fa7b3-393">使用至少兩個複本可提供讀取高可用性，或者使用三個複本可提供讀寫高可用性。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-393">Use at least two replicas for read high-availability, or three for read-write high-availability.</span></span>
* <span data-ttu-id="fa7b3-394">**設定多區域部署的索引子。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-394">**Configure indexers for multi-region deployments.**</span></span> <span data-ttu-id="fa7b3-395">如果您有多區域部署，請考慮索引連續性的選項。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-395">If you have a multi-region deployment, consider your options for continuity in indexing.</span></span>

  * <span data-ttu-id="fa7b3-396">如果資料來源已在異地複寫，您通常應將每個區域性 Azure 搜尋服務的每個索引子指向其本機資料來源複本。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-396">If the data source is geo-replicated, you should generally point each indexer of each regional Azure Search service to its local data source replica.</span></span> <span data-ttu-id="fa7b3-397">不過，該方法不建議用於儲存在 Azure SQL Database 中的大型資料集。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-397">However, that approach is not recommended for large datasets stored in Azure SQL Database.</span></span> <span data-ttu-id="fa7b3-398">原因是 Azure 搜尋服務無法從次要 SQL Database 複本 (只能從主要複本) 執行增量編製索引。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-398">The reason is that Azure Search cannot perform incremental indexing from secondary SQL Database replicas, only from primary replicas.</span></span> <span data-ttu-id="fa7b3-399">請改為將所有索引子指向主要複本。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-399">Instead, point all indexers to the primary replica.</span></span> <span data-ttu-id="fa7b3-400">在容錯移轉之後，指著位於新主要複本的 Azure 搜尋服務索引子。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-400">After a failover, point the Azure Search indexers at the new primary replica.</span></span>  
  * <span data-ttu-id="fa7b3-401">如果資料來源並未異地複寫，請指著位於相同資料來源的多個索引子，如此一來，多個區域中的 Azure 搜尋服務就能持續且獨立地從資料來源編製索引。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-401">If the data source is not geo-replicated, point multiple indexers at the same data source, so that Azure Search services in multiple regions continuously and independently index from the data source.</span></span> <span data-ttu-id="fa7b3-402">如需詳細資訊，請參閱 [Azure 搜尋服務效能和最佳化考量][search-optimization]。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-402">For more information, see [Azure Search performance and optimization considerations][search-optimization].</span></span>

### <a name="azure-storage"></a><span data-ttu-id="fa7b3-403">Azure 儲存體</span><span class="sxs-lookup"><span data-stu-id="fa7b3-403">Azure Storage</span></span>
* <span data-ttu-id="fa7b3-404">**對於應用程式資料，請使用讀取權限異地備援儲存體 (RA-GRS)。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-404">**For application data, use read-access geo-redundant storage (RA-GRS).**</span></span> <span data-ttu-id="fa7b3-405">RA-GRS 儲存體會將資料複寫到次要區域，並提供從次要區域的唯讀存取權。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-405">RA-GRS storage replicates the data to a secondary region, and provides read-only access from the secondary region.</span></span> <span data-ttu-id="fa7b3-406">如果主要區域發生儲存體中斷，應用程式可以從次要區域讀取資料。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-406">If there is a storage outage in the primary region, the application can read the data from the secondary region.</span></span> <span data-ttu-id="fa7b3-407">如需詳細資訊，請參閱 [Azure 儲存體複寫](/azure/storage/storage-redundancy/)。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-407">For more information, see [Azure Storage replication](/azure/storage/storage-redundancy/).</span></span>
* <span data-ttu-id="fa7b3-408">**若為 VM 磁碟，請使用受控磁碟。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-408">**For VM disks, use Managed Disks.**</span></span> <span data-ttu-id="fa7b3-409">[受控磁碟][managed-disks]可為可用性設定組中的 VM 提供更高的可靠性，因為磁碟彼此充分隔離，以避免單一失敗點。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-409">[Managed Disks][managed-disks] provide better reliability for VMs in an availability set, because the disks are sufficiently isolated from each other to avoid single points of failure.</span></span> <span data-ttu-id="fa7b3-410">此外，受控磁碟不受儲存體帳戶中建立之 VHD 的 IOPS 限制所約束。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-410">Also, Managed Disks aren't subject to the IOPS limits of VHDs created in a storage account.</span></span> <span data-ttu-id="fa7b3-411">如需詳細資訊，請參閱[管理 Azure 中 Windows 虛擬機器的可用性][vm-manage-availability]。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-411">For more information, see [Manage the availability of Windows virtual machines in Azure][vm-manage-availability].</span></span>
* <span data-ttu-id="fa7b3-412">**若為佇列儲存體，請在另一個區域中建立備份佇列。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-412">**For Queue storage, create a backup queue in another region.**</span></span> <span data-ttu-id="fa7b3-413">對於佇列儲存體，唯讀複本的用途有限，因為您無法將項目排入佇列或從佇列中清除。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-413">For Queue storage, a read-only replica has limited use, because you can't queue or dequeue items.</span></span> <span data-ttu-id="fa7b3-414">請改為在其他區域的儲存體帳戶中建立備份佇列。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-414">Instead, create a backup queue in a storage account in another region.</span></span> <span data-ttu-id="fa7b3-415">如果發生儲存體中斷，應用程式可以使用備份佇列，直到主要區域再次變為可使用為止。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-415">If there is a storage outage, the application can use the backup queue, until the primary region becomes available again.</span></span> <span data-ttu-id="fa7b3-416">這樣一來，應用程式仍然可以處理新的要求。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-416">That way, the application can still process new requests.</span></span>  

### <a name="cosmos-db"></a><span data-ttu-id="fa7b3-417">Cosmos DB</span><span class="sxs-lookup"><span data-stu-id="fa7b3-417">Cosmos DB</span></span>
* <span data-ttu-id="fa7b3-418">**跨區域複寫資料庫。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-418">**Replicate the database across regions.**</span></span> <span data-ttu-id="fa7b3-419">Cosmos DB 可讓您將任意數目的 Azure 區域與 Cosmos DB 資料庫帳戶產生關聯。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-419">Cosmos DB allows you to associate any number of Azure regions with a Cosmos DB database account.</span></span> <span data-ttu-id="fa7b3-420">Cosmos DB 資料庫可以有一個寫入區域和多個唯讀區域。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-420">A Cosmos DB database can have one write region and multiple read regions.</span></span> <span data-ttu-id="fa7b3-421">如果寫入區域發生失敗，您可以從另一個複本進行讀取。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-421">If there is a failure in the write region, you can read from another replica.</span></span> <span data-ttu-id="fa7b3-422">用戶端 SDK 會自動處理此作業。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-422">The Client SDK handles this automatically.</span></span> <span data-ttu-id="fa7b3-423">您也可以將寫入區域容錯移轉到另一個區域。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-423">You can also fail over the write region to another region.</span></span> <span data-ttu-id="fa7b3-424">如需詳細資訊，請參閱[如何使用 Azure Cosmos DB 在全域散發資料？](/azure/documentdb/documentdb-distribute-data-globally)</span><span class="sxs-lookup"><span data-stu-id="fa7b3-424">For more information, see [How to distribute data globally with Azure Cosmos DB?](/azure/documentdb/documentdb-distribute-data-globally)</span></span>

### <a name="sql-database"></a><span data-ttu-id="fa7b3-425">SQL Database</span><span class="sxs-lookup"><span data-stu-id="fa7b3-425">SQL Database</span></span>
* <span data-ttu-id="fa7b3-426">**使用標準或進階層。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-426">**Use Standard or Premium tier.**</span></span> <span data-ttu-id="fa7b3-427">這些服務層提供較長的時間點還原週期 (35 天)。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-427">These tiers provide a longer point-in-time restore period (35 days).</span></span> <span data-ttu-id="fa7b3-428">如需詳細資訊，請參閱 [SQL Database 選項和效能](/azure/sql-database/sql-database-service-tiers/)。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-428">For more information, see [SQL Database options and performance](/azure/sql-database/sql-database-service-tiers/).</span></span>
* <span data-ttu-id="fa7b3-429">**啟用 SQL Database 稽核。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-429">**Enable SQL Database auditing.**</span></span> <span data-ttu-id="fa7b3-430">稽核可以用來診斷惡意攻擊或人為錯誤。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-430">Auditing can be used to diagnose malicious attacks or human error.</span></span> <span data-ttu-id="fa7b3-431">如需詳細資訊，請參閱 [開始使用 SQL 資料庫稽核](/azure/sql-database/sql-database-auditing-get-started/)。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-431">For more information, see [Get started with SQL database auditing](/azure/sql-database/sql-database-auditing-get-started/).</span></span>
* <span data-ttu-id="fa7b3-432">**使用作用中異地複寫** 使用作用中異地複寫在不同區域中建立可讀取的次要複本。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-432">**Use Active Geo-Replication** Use Active Geo-Replication to create a readable secondary in a different region.</span></span>  <span data-ttu-id="fa7b3-433">如果您的主要資料庫失敗，或只需要離線，請執行手動容錯移轉至次要資料庫。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-433">If your primary database fails, or simply needs to be taken offline, perform a manual failover to the secondary database.</span></span>  <span data-ttu-id="fa7b3-434">在您容錯移轉前，次要資料庫會維持唯讀狀態。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-434">Until you fail over, the secondary database remains read-only.</span></span>  <span data-ttu-id="fa7b3-435">如需詳細資訊，請參閱 [SQL Database 作用中異地複寫](/azure/sql-database/sql-database-geo-replication-overview/)。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-435">For more information, see [SQL Database Active Geo-Replication](/azure/sql-database/sql-database-geo-replication-overview/).</span></span>
* <span data-ttu-id="fa7b3-436">**使用分區化。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-436">**Use sharding.**</span></span> <span data-ttu-id="fa7b3-437">請考慮使用分區化來水平分割資料庫。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-437">Consider using sharding to partition the database horizontally.</span></span> <span data-ttu-id="fa7b3-438">分區化可提供容錯隔離。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-438">Sharding can provide fault isolation.</span></span> <span data-ttu-id="fa7b3-439">如需詳細資訊，請參閱[使用 Azure SQL Database 相應放大](/azure/sql-database/sql-database-elastic-scale-introduction/)。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-439">For more information, see [Scaling out with Azure SQL Database](/azure/sql-database/sql-database-elastic-scale-introduction/).</span></span>
* <span data-ttu-id="fa7b3-440">**使用時間點還原從人為錯誤中復原。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-440">**Use point-in-time restore to recover from human error.**</span></span>  <span data-ttu-id="fa7b3-441">時間點還原會使您的資料庫回到較早的時間點。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-441">Point-in-time restore returns your database to an earlier point in time.</span></span> <span data-ttu-id="fa7b3-442">如需詳細資訊，請參閱[使用自動化資料庫備份來復原 Azure SQL Database][sql-restore]。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-442">For more information, see [Recover an Azure SQL database using automated database backups][sql-restore].</span></span>
* <span data-ttu-id="fa7b3-443">**使用異地還原從服務中斷中復原。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-443">**Use geo-restore to recover from a service outage.**</span></span> <span data-ttu-id="fa7b3-444">異地還原可從異地備援備份還原資料庫。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-444">Geo-restore restores a database from a geo-redundant backup.</span></span>  <span data-ttu-id="fa7b3-445">如需詳細資訊，請參閱[使用自動化資料庫備份來復原 Azure SQL Database][sql-restore]。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-445">For more information, see [Recover an Azure SQL database using automated database backups][sql-restore].</span></span>

### <a name="sql-server-running-in-a-vm"></a><span data-ttu-id="fa7b3-446">SQL Server (在 VM 中執行)</span><span class="sxs-lookup"><span data-stu-id="fa7b3-446">SQL Server (running in a VM)</span></span>
* <span data-ttu-id="fa7b3-447">**複寫資料庫。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-447">**Replicate the database.**</span></span> <span data-ttu-id="fa7b3-448">使用 SQL Server Always On 可用性群組來複寫資料庫。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-448">Use SQL Server Always On Availability Groups to replicate the database.</span></span> <span data-ttu-id="fa7b3-449">如果有一個 SQL Server 執行個體失敗，可提供高可用性。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-449">Provides high availability if one SQL Server instance fails.</span></span> <span data-ttu-id="fa7b3-450">如需詳細資訊，請參閱[執行適用於多層式架構的 Windows VM](../reference-architectures/virtual-machines-windows/n-tier.md)</span><span class="sxs-lookup"><span data-stu-id="fa7b3-450">For more information, see [Run Windows VMs for an N-tier application](../reference-architectures/virtual-machines-windows/n-tier.md)</span></span>
* <span data-ttu-id="fa7b3-451">**備份資料庫**。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-451">**Back up the database**.</span></span> <span data-ttu-id="fa7b3-452">如果您已經使用 [Azure 備份](https://azure.microsoft.com/documentation/services/backup/)來備份您的 VM，請考慮使用 [Azure 備份來備份採用 DPM 的 SQL Server 工作負載](/azure/backup/backup-azure-backup-sql/)。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-452">If you are already using [Azure Backup](https://azure.microsoft.com/documentation/services/backup/) to back up your VMs, consider using [Azure Backup for SQL Server workloads using DPM](/azure/backup/backup-azure-backup-sql/).</span></span> <span data-ttu-id="fa7b3-453">使用此方法，組織有一個備份管理員角色以及 VM 和 SQL Server 的整合復原程序。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-453">With this approach, there is one backup administrator role for the organization and a unified recovery procedure for VMs and SQL Server.</span></span> <span data-ttu-id="fa7b3-454">否則，使用 [SQL Server Managed Backup to Microsoft Azure](https://msdn.microsoft.com/library/dn449496.aspx)。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-454">Otherwise, use [SQL Server Managed Backup to Microsoft Azure](https://msdn.microsoft.com/library/dn449496.aspx).</span></span>

### <a name="traffic-manager"></a><span data-ttu-id="fa7b3-455">流量管理員</span><span class="sxs-lookup"><span data-stu-id="fa7b3-455">Traffic Manager</span></span>
* <span data-ttu-id="fa7b3-456">**執行手動容錯回復。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-456">**Perform manual failback.**</span></span> <span data-ttu-id="fa7b3-457">在流量管理員容錯移轉之後，執行手動容錯回復，而非自動容錯回復。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-457">After a Traffic Manager failover, perform manual failback, rather than automatically failing back.</span></span> <span data-ttu-id="fa7b3-458">在容錯回復之前，確認所有應用程式子系統的狀況良好。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-458">Before failing back, verify that all application subsystems are healthy.</span></span>  <span data-ttu-id="fa7b3-459">或者，您可以建立應用程式會在資料中心之間來回翻轉的情況。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-459">Otherwise, you can create a situation where the application flips back and forth between data centers.</span></span> <span data-ttu-id="fa7b3-460">如需詳細資訊，請參閱[在多個區域中執行 VM 以獲得高可用性](../reference-architectures/virtual-machines-windows/multi-region-application.md)。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-460">For more information, see [Run VMs in multiple regions for high availability](../reference-architectures/virtual-machines-windows/multi-region-application.md).</span></span>
* <span data-ttu-id="fa7b3-461">**建立健康情況探查端點。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-461">**Create a health probe endpoint.**</span></span> <span data-ttu-id="fa7b3-462">建立可報告應用程式整體健康情況的自訂端點。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-462">Create a custom endpoint that reports on the overall health of the application.</span></span> <span data-ttu-id="fa7b3-463">如有任何重要的路徑失敗 (不只是前端)，這可讓流量管理員進行容錯移轉。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-463">This enables Traffic Manager to fail over if any critical path fails, not just the front end.</span></span> <span data-ttu-id="fa7b3-464">如有任何重要的相依性處於狀況不良或無法連線，則端點應傳回 HTTP 錯誤碼。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-464">The endpoint should return an HTTP error code if any critical dependency is unhealthy or unreachable.</span></span> <span data-ttu-id="fa7b3-465">然而，不會回報不重要服務的錯誤。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-465">Don't report errors for non-critical services, however.</span></span> <span data-ttu-id="fa7b3-466">否則，健康情況探查可能觸發容錯移轉，若不需要，則會建立誤判。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-466">Otherwise, the health probe might trigger failover when it's not needed, creating false positives.</span></span> <span data-ttu-id="fa7b3-467">如需詳細資訊，請參閱[流量管理員端點監視和容錯移轉](/azure/traffic-manager/traffic-manager-monitoring/)。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-467">For more information, see [Traffic Manager endpoint monitoring and failover](/azure/traffic-manager/traffic-manager-monitoring/).</span></span>

### <a name="virtual-machines"></a><span data-ttu-id="fa7b3-468">虛擬機器</span><span class="sxs-lookup"><span data-stu-id="fa7b3-468">Virtual Machines</span></span>
* <span data-ttu-id="fa7b3-469">**避免在單一 VM 上執行生產工作負載。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-469">**Avoid running a production workload on a single VM.**</span></span> <span data-ttu-id="fa7b3-470">單一 VM 部署不適合進行計劃性或非計劃性維護。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-470">A single VM deployment is not resilient to planned or unplanned maintenance.</span></span> <span data-ttu-id="fa7b3-471">請改為將多個 VM 放入一個可用性集合或 [VM 擴展集](/azure/virtual-machine-scale-sets/virtual-machine-scale-sets-overview/)中 (前面是負載平衡器)。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-471">Instead, put multiple VMs in an availability set or [VM scale set](/azure/virtual-machine-scale-sets/virtual-machine-scale-sets-overview/), with a load balancer in front.</span></span>
* <span data-ttu-id="fa7b3-472">**在佈建 VM 時指定可用性設定組。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-472">**Specify an availability set when you provision the VM.**</span></span> <span data-ttu-id="fa7b3-473">目前沒有任何方法可在佈建 VM 之後，將 VM 新增至可用性設定組。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-473">Currently, there is no way to add a VM to an availability set after the VM is provisioned.</span></span> <span data-ttu-id="fa7b3-474">當您將新的 VM 新增至現有的可用性設定時，務必為此 VM 建立 NIC，然後將此 NIC 新增至負載平衡器上的後端位址集區。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-474">When you add a new VM to an existing availability set, make sure to create a NIC for the VM, and add the NIC to the back-end address pool on the load balancer.</span></span> <span data-ttu-id="fa7b3-475">否則，負載平衡器不會將網路流量傳送到該 VM。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-475">Otherwise, the load balancer won't route network traffic to that VM.</span></span>
* <span data-ttu-id="fa7b3-476">**將每個應用程式層放在不同的可用性設定組中。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-476">**Put each application tier into a separate Availability Set.**</span></span> <span data-ttu-id="fa7b3-477">在多層式架構應用程式中，請勿將不同層的 VM 放在相同的可用性設定組中。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-477">In an N-tier application, don't put VMs from different tiers into the same availability set.</span></span> <span data-ttu-id="fa7b3-478">可用性設定組中的 VM 會置於各個容錯網域 (FD) 與更新網域 (UD) 中。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-478">VMs in an availability set are placed across fault domains (FDs) and update domains (UD).</span></span> <span data-ttu-id="fa7b3-479">不過，若要取得 FD 和 UD 的備援優勢，可用性設定組中的每個 VM 必須能夠處理相同的用戶端要求。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-479">However, to get the redundancy benefit of FDs and UDs, every VM in the availability set must be able to handle the same client requests.</span></span>
* <span data-ttu-id="fa7b3-480">**根據效能需求選擇正確的 VM 大小。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-480">**Choose the right VM size based on performance requirements.**</span></span> <span data-ttu-id="fa7b3-481">將現有的工作負載移至 Azure 時，從最符合您內部部署伺服器的 VM 大小開始。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-481">When moving an existing workload to Azure, start with the VM size that's the closest match to your on-premises servers.</span></span> <span data-ttu-id="fa7b3-482">然後根據 CPU、記憶體和 IOPS 測量您的實際工作負載效能，並視需要調整大小。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-482">Then measure the performance of your actual workload with respect to CPU, memory, and disk IOPS, and adjust the size if needed.</span></span> <span data-ttu-id="fa7b3-483">這有助於確保應用程式如預期般在雲端環境中運作。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-483">This helps to ensure the application behaves as expected in a cloud environment.</span></span> <span data-ttu-id="fa7b3-484">此外，如果您需要多個 NIC，請留意每個大小的 NIC 限制。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-484">Also, if you need multiple NICs, be aware of the NIC limit for each size.</span></span>
* <span data-ttu-id="fa7b3-485">**對 VHD 使用受控磁碟。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-485">**Use Managed Disks for VHDs.**</span></span> <span data-ttu-id="fa7b3-486">[受控磁碟][managed-disks]可為可用性設定組中的 VM 提供更高的可靠性，因為磁碟彼此充分隔離，以避免單一失敗點。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-486">[Managed Disks][managed-disks] provide better reliability for VMs in an availability set, because the disks are sufficiently isolated from each other to avoid single points of failure.</span></span> <span data-ttu-id="fa7b3-487">此外，受控磁碟不受儲存體帳戶中建立之 VHD 的 IOPS 限制所約束。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-487">Also, Managed Disks aren't subject to the IOPS limits of VHDs created in a storage account.</span></span> <span data-ttu-id="fa7b3-488">如需詳細資訊，請參閱[管理 Azure 中 Windows 虛擬機器的可用性][vm-manage-availability]。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-488">For more information, see [Manage the availability of Windows virtual machines in Azure][vm-manage-availability].</span></span>
* <span data-ttu-id="fa7b3-489">**將應用程式安裝在資料磁碟上，而非作業系統磁碟上。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-489">**Install applications on a data disk, not the OS disk.**</span></span> <span data-ttu-id="fa7b3-490">否則，您可能會達到磁碟大小限制。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-490">Otherwise, you may reach the disk size limit.</span></span>
* <span data-ttu-id="fa7b3-491">**使用 Azure 備份來備份 VM。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-491">**Use Azure Backup to back up VMs.**</span></span> <span data-ttu-id="fa7b3-492">備份可防止資料意外遺失。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-492">Backups protect against accidental data loss.</span></span> <span data-ttu-id="fa7b3-493">如需詳細資訊，請參閱[使用復原服務保存庫來保護 Azure VM](/azure/backup/backup-azure-vms-first-look-arm/)。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-493">For more information, see [Protect Azure VMs with a recovery services vault](/azure/backup/backup-azure-vms-first-look-arm/).</span></span>
* <span data-ttu-id="fa7b3-494">**啟用診斷記錄**，包括基本健康情況計量、基礎結構記錄及[開機診斷][boot-diagnostics]。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-494">**Enable diagnostic logs**, including basic health metrics, infrastructure logs, and [boot diagnostics][boot-diagnostics].</span></span> <span data-ttu-id="fa7b3-495">如果您的 VM 進入無法開機的狀態，開機診斷能協助您診斷開機失敗。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-495">Boot diagnostics can help you diagnose a boot failure if your VM gets into a non-bootable state.</span></span> <span data-ttu-id="fa7b3-496">如需詳細資訊，請參閱 [Azure Diagnostic Logs 概觀][diagnostics-logs]。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-496">For more information, see [Overview of Azure Diagnostic Logs][diagnostics-logs].</span></span>
* <span data-ttu-id="fa7b3-497">**使用 AzureLogCollector 擴充功能。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-497">**Use the AzureLogCollector extension.**</span></span> <span data-ttu-id="fa7b3-498">(僅限 Windows VM。)這項擴充功能可彙總 Azure 平台記錄，並將其上傳至 Azure 儲存體，而不需操作人員從遠端登入 VM。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-498">(Windows VMs only.) This extension aggregates Azure platform logs and uploads them to Azure storage, without the operator remotely logging into the VM.</span></span> <span data-ttu-id="fa7b3-499">如需詳細資訊，請參閱 [AzureLogCollector 擴充功能](/azure/virtual-machines/virtual-machines-windows-log-collector-extension/?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json)。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-499">For more information, see [AzureLogCollector Extension](/azure/virtual-machines/virtual-machines-windows-log-collector-extension/?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).</span></span>

### <a name="virtual-network"></a><span data-ttu-id="fa7b3-500">虛擬網路</span><span class="sxs-lookup"><span data-stu-id="fa7b3-500">Virtual Network</span></span>
* <span data-ttu-id="fa7b3-501">**若要允許或封鎖公用 IP 位址，請將 NSG 新增至子網路。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-501">**To whitelist or block public IP addresses, add an NSG to the subnet.**</span></span> <span data-ttu-id="fa7b3-502">封鎖來自惡意使用者的存取，或只允許有權存取應用程式的使用者存取。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-502">Block access from malicious users, or allow access only from users who have privilege to access the application.</span></span>  
* <span data-ttu-id="fa7b3-503">**建立自訂健康情況探查。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-503">**Create a custom health probe.**</span></span> <span data-ttu-id="fa7b3-504">Load Balancer 健康情況探查可以測試 HTTP 或 TCP。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-504">Load Balancer Health Probes can test either HTTP or TCP.</span></span> <span data-ttu-id="fa7b3-505">如果 VM 執行 HTTP 伺服器，則 HTTP 探查是比 TCP 探查更佳的健康狀態指標。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-505">If a VM runs an HTTP server, the HTTP probe is a better indicator of health status than a TCP probe.</span></span> <span data-ttu-id="fa7b3-506">對於 HTTP 探查，使用可報告應用程式整體健康情況 (包括所有重要相依性) 的自訂端點。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-506">For an HTTP probe, use a custom endpoint that reports the overall health of the application, including all critical dependencies.</span></span> <span data-ttu-id="fa7b3-507">如需詳細資訊，請參閱 [Azure Load Balancer 概觀](/azure/load-balancer/load-balancer-overview/)。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-507">For more information, see [Azure Load Balancer overview](/azure/load-balancer/load-balancer-overview/).</span></span>
* <span data-ttu-id="fa7b3-508">**封鎖健康情況探查。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-508">**Don't block the health probe.**</span></span> <span data-ttu-id="fa7b3-509">Load Balancer 健康情況探查會從已知的 IP 位址 168.63.129.16 傳送。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-509">The Load Balancer Health probe is sent from a known IP address, 168.63.129.16.</span></span> <span data-ttu-id="fa7b3-510">請勿在任何防火牆原則或網路安全性群組 (NSG) 規則中封鎖往返此 IP 的流量。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-510">Don't block traffic to or from this IP in any firewall policies or network security group (NSG) rules.</span></span> <span data-ttu-id="fa7b3-511">封鎖健康情況探查，可能會導致負載平衡器從循環中移除 VM。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-511">Blocking the health probe would cause the load balancer to remove the VM from rotation.</span></span>
* <span data-ttu-id="fa7b3-512">**啟用 Azure Load Balancer 記錄功能。**</span><span class="sxs-lookup"><span data-stu-id="fa7b3-512">**Enable Load Balancer logging.**</span></span> <span data-ttu-id="fa7b3-513">記錄會顯示後端有多少個 VM 因為探查回應失敗而不接收網路流量。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-513">The logs show how many VMs on the back-end are not receiving network traffic due to failed probe responses.</span></span> <span data-ttu-id="fa7b3-514">如需詳細資訊，請參閱 [Azure Load Balancer 的記錄分析](/azure/load-balancer/load-balancer-monitor-log/)。</span><span class="sxs-lookup"><span data-stu-id="fa7b3-514">For more information, see [Log analytics for Azure Load Balancer](/azure/load-balancer/load-balancer-monitor-log/).</span></span>

<!-- links -->
[app-service-autoscale]: /azure/monitoring-and-diagnostics/insights-how-to-scale/
[asynchronous-c-sharp]: /dotnet/articles/csharp/async
[availability-sets]:/azure/virtual-machines/virtual-machines-windows-manage-availability/
[azure-backup]: https://azure.microsoft.com/documentation/services/backup/
[boot-diagnostics]: https://azure.microsoft.com/blog/boot-diagnostics-for-virtual-machines-v2/
[circuit-breaker]: ../patterns/circuit-breaker.md
[cloud-service-autoscale]: /azure/cloud-services/cloud-services-how-to-scale/
[diagnostics-logs]: /azure/monitoring-and-diagnostics/monitoring-overview-of-diagnostic-logs/
[fma]: ../resiliency/failure-mode-analysis.md
[resilient-deployment]: ../resiliency/index.md#resilient-deployment
[load-balancer]: /azure/load-balancer/load-balancer-overview/
[managed-disks]: /azure/storage/storage-managed-disks-overview
[monitoring-and-diagnostics-guidance]: ../best-practices/monitoring.md
[resource-manager]: /azure/azure-resource-manager/resource-group-overview/
[retry-pattern]: ../patterns/retry.md
[retry-service-guidance]: ../best-practices/retry-service-specific.md
[search-optimization]: /azure/search/search-performance-optimization/
[sql-backup]: /azure/sql-database/sql-database-automated-backups/
[sql-restore]: /azure/sql-database/sql-database-recovery-using-backups/
[traffic-manager]: /azure/traffic-manager/traffic-manager-overview/
[traffic-manager-routing]: /azure/traffic-manager/traffic-manager-routing-methods/
[vm-manage-availability]: /azure/virtual-machines/windows/manage-availability#use-managed-disks-for-vms-in-an-availability-set
[vmss-autoscale]: /azure/virtual-machine-scale-sets/virtual-machine-scale-sets-autoscale-overview/
